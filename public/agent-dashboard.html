<!-- 
===============================================================================
CANONICAL FILE - MODIFY THIS VERSION ONLY
===============================================================================
File: agent-dashboard.html
Purpose: Multi-Agent Observability Dashboard for CoderOne AI Agents
Status: PRODUCTION - Last updated: January 27, 2025
Claude Agents: This is the OFFICIAL version - do not modify copies elsewhere
===============================================================================
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Dashboard - CoderOne Multi-Agent Observability</title>
    
    <!-- Core Styles -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            /* CoderOne Dark Theme - Matching Hooks Page */
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: rgba(255, 255, 255, 0.03);
            --bg-float: rgba(255, 255, 255, 0.05);
            
            /* Glass Morphism - Dark Mode */
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-backdrop: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.08);
            
            /* Cyan Accent Colors */
            --primary-cyan: #00D9FF;
            --secondary-cyan: #06b6d4;
            --light-cyan: #67e8f9;
            --accent-cyan: #0891b2;
            
            /* Purple Accent */
            --accent-primary: #8b5cf6;
            --accent-secondary: #06b6d4;
            
            /* Border Effects */
            --border: rgba(255, 255, 255, 0.08);
            --border-hover: rgba(0, 217, 255, 0.3);
            --border-active: rgba(0, 217, 255, 0.5);
            
            /* Text Colors */
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #6b7280;
            --text-accent: var(--primary-cyan);
            
            /* Status Colors */
            --success: #8b5cf6;  /* Changed from green to purple */
            --warning: #f59e0b;
            --error: #ef4444;
            --info: var(--primary-cyan);
            --purple: #8b5cf6;
            --gold: #fbbf24;
            
            /* Agent Status Colors */
            --agent-active: var(--primary-cyan);
            --agent-thinking: var(--warning);
            --agent-idle: var(--text-muted);
            --agent-error: var(--error);
            --agent-coordinating: var(--purple);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Header - Dark Glass Morphism */
        .dashboard-header {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .header-center {
            display: flex;
            align-items: center;
            gap: 1rem;
            justify-content: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 700;
            font-size: 1.65rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo i {
            font-size: 1.95rem;
            color: var(--accent-primary);
            -webkit-text-fill-color: var(--accent-primary);
            background: none;
        }

        .breadcrumb {
            color: var(--text-muted);
            font-size: 0.9rem;
        }


        .system-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            transition: all 0.3s ease;
        }

        .system-status:hover {
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .last-update {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Main Dashboard Grid */
        .dashboard-container {
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto auto auto;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Card Base Style - Dark Glass Morphism with Light Blue Border */
        .dashboard-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 0.5px solid var(--light-cyan);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .dashboard-card:hover {
            border-color: #9333ea;
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(147, 51, 234, 0.4),
                        0 0 60px rgba(147, 51, 234, 0.2);
            border-width: 0.5px;
        }

        .card-header {
            padding: 1.5rem 1.5rem 0 1.5rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1.5rem;
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text-primary);
        }

        .card-subtitle {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .card-content {
            padding: 0 1.5rem 1.5rem 1.5rem;
        }

        /* Active Agents Panel */
        .active-agents {
            grid-column: 1;
            grid-row: 1;
        }

        .agent-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .agent-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .agent-item:hover {
            border-color: var(--accent-primary);
            background: var(--glass-bg);
            transform: translateY(-1px);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
        }

        .agent-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .agent-avatar.architect { background: linear-gradient(135deg, #bb9af7, #9d7cd8); }
        .agent-avatar.frontend { background: linear-gradient(135deg, #2ac3de, #0db9d7); }
        .agent-avatar.backend { background: linear-gradient(135deg, #8b5cf6, #a78bfa); }
        .agent-avatar.optimizer { background: linear-gradient(135deg, #e0af68, #ff9e64); }
        .agent-avatar.debugger { background: linear-gradient(135deg, #f7768e, #ff757f); }

        .agent-info {
            flex: 1;
        }

        .agent-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .agent-task {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .agent-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .agent-status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-analyzing { background: var(--warning); color: var(--bg-primary); }
        .status-implementing { background: var(--info); color: var(--bg-primary); }
        .status-coordinating { background: var(--purple); color: var(--bg-primary); }
        .status-idle { background: var(--text-muted); color: var(--bg-primary); }

        .agent-metrics {
            text-align: right;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .response-time {
            color: var(--success);
            font-weight: 500;
        }

        /* System Health Panel */
        .system-health {
            grid-column: 2;
            grid-row: 1;
        }

        .health-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .health-metric {
            text-align: center;
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: 0.75rem;
            border: 1px solid var(--border);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .metric-value.healthy { color: var(--success); }
        .metric-value.warning { color: var(--warning); }
        .metric-value.error { color: var(--error); }

        .metric-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-trend {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        .trend-up { color: var(--success); }
        .trend-down { color: var(--error); }

        /* Coordination Graph Panel */
        .coordination-graph {
            grid-column: 1 / -1;
            grid-row: 2;
        }

        .graph-container {
            height: 400px;
            position: relative;
            background: var(--bg-tertiary);
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .graph-svg {
            width: 100%;
            height: 100%;
        }

        .graph-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        /* Task Queue Panel / Kanban Board */
        .task-queue {
            grid-column: 1;
            grid-row: 3;
        }

        /* Kanban Board Styles (Evolution Enhancement) */
        .kanban-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            height: 400px;
            overflow-x: auto;
        }

        .kanban-column {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            min-width: 250px;
        }

        .kanban-column-header {
            padding: 0.75rem;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-tertiary);
        }

        .column-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .column-count {
            background: var(--accent-primary);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .kanban-column-content {
            flex: 1;
            padding: 0.5rem;
            overflow-y: auto;
            min-height: 100px;
        }

        .kanban-column-content.drag-over {
            background: rgba(139, 92, 246, 0.1);
            border: 2px dashed var(--accent-primary);
        }

        .kanban-task {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: move;
            transition: all 0.3s ease;
            position: relative;
        }

        .kanban-task:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
            border-color: var(--accent-primary);
        }

        .kanban-task.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .kanban-task .task-content {
            margin-left: 0.5rem;
        }

        .kanban-task .task-title {
            color: var(--text-primary);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .kanban-task .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .kanban-task .task-agent {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .kanban-task .task-progress {
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .kanban-task .progress-bar {
            flex: 1;
            height: 4px;
            background: var(--bg-tertiary);
            border-radius: 2px;
            overflow: hidden;
        }

        .kanban-task .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transition: width 0.3s ease;
        }

        .kanban-task .progress-text {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-priority {
            width: 4px;
            height: 100%;
            border-radius: 2px;
            align-self: stretch;
        }

        .priority-high { background: var(--error); }
        .priority-medium { background: var(--warning); }
        .priority-low { background: var(--success); }

        .task-details {
            flex: 1;
        }

        .task-title {
            font-weight: 500;
            color: var(--text-primary);
        }

        .task-agent {
            font-size: 0.8rem;
            color: var(--text-accent);
        }

        .task-status {
            font-size: 0.75rem;
            padding: 0.2rem 0.5rem;
            border-radius: 0.25rem;
            background: var(--bg-tertiary);
            color: var(--text-muted);
        }

        /* Performance Metrics Panel */
        .performance-metrics {
            grid-column: 2;
            grid-row: 3;
        }

        .perf-chart {
            height: 200px;
            background: var(--bg-tertiary);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* CoderOne Dark Button System */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .btn-secondary {
            background: var(--glass-bg);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--accent-primary);
        }

        .btn-success {
            background: var(--purple);  /* Using purple instead of green */
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-error {
            background: var(--error);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-lg {
            padding: 1rem 2rem;
            font-size: 1.125rem;
        }

        /* Toggle Buttons */
        .toggle-btn {
            background: var(--glass-bg);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-family: inherit;
        }

        .toggle-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
            border-color: var(--accent-primary);
        }

        /* Dark Form Elements */
        .form-input, textarea, select {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .form-input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
            background: var(--glass-bg);
        }

        .form-input::placeholder, textarea::placeholder {
            color: var(--text-muted);
            opacity: 0.8;
        }

        /* Preset Button Styles */
        .preset-btn {
            padding: 0.75rem;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .preset-btn:hover {
            background: var(--glass-bg);
            border-color: var(--accent-primary);
            transform: translateY(-1px);
        }

        /* Input Group Labels */
        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.875rem;
        }

        /* Range Input Styling */
        input[type="range"] {
            width: 100%;
            background: transparent;
            cursor: pointer;
        }

        input[type="range"]::-webkit-slider-track {
            background: var(--bg-tertiary);
            border-radius: 6px;
            height: 8px;
            border: 1px solid var(--glass-border);
        }

        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            background: var(--accent-primary);
            border-radius: 50%;
            height: 20px;
            width: 20px;
            margin-top: -6px;
            box-shadow: 0 2px 8px rgba(139, 92, 246, 0.4);
            cursor: pointer;
        }

        input[type="checkbox"] {
            accent-color: var(--accent-primary);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .dashboard-container {
                grid-template-columns: 1fr;
                padding: 1rem;
            }

            .coordination-graph {
                grid-column: 1;
            }

            .dashboard-header {
                padding: 1rem;
            }

            .header-right .last-update {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .health-metrics {
                grid-template-columns: 1fr;
            }

            .agent-item {
                flex-direction: column;
                text-align: center;
            }

            .agent-metrics {
                text-align: center;
            }
        }

        /* Loading States */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(42, 195, 222, 0.1),
                transparent
            );
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Connection Status - Reduced to 50% size */
        .connection-status {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            padding: 0.375rem 0.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.65rem;
            z-index: 200;
            transition: all 0.3s ease;
        }

        .connection-status.connected {
            border-color: var(--success);
            color: var(--success);
        }

        .connection-status.disconnected {
            border-color: var(--error);
            color: var(--error);
        }

        .connection-status .status-indicator {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s infinite;
        }
    </style>
    <!-- Socket.io for real-time task events from terminal -->
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-center">
            <div class="logo">
                <i class="fas fa-network-wired"></i>
                <span>Agent Dashboard</span>
            </div>
        </div>
    </header>

    <!-- Main Dashboard -->
    <div class="dashboard-container">
        <!-- Task Execution Panel -->
        <div class="dashboard-card task-execution" style="grid-column: 1 / -1; margin-bottom: 2rem;">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-terminal"></i>
                    Agent Task Executor
                </div>
                <div class="card-subtitle">Execute custom tasks with AI agents directly from the dashboard</div>
                <button class="toggle-btn" onclick="toggleTaskPanel()" style="background: var(--info); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">
                    <i class="fas fa-expand"></i> Expand
                </button>
            </div>
            <div class="card-content" id="taskExecutionContent" style="display: none;">
                <div class="task-executor" style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
                    <!-- Task Input Section -->
                    <div class="task-input-section">
                        <div class="input-group" style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Task Description</label>
                            <textarea 
                                id="taskDescription" 
                                placeholder="Describe the task you want the AI agent to perform..."
                                style="width: 100%; height: 100px; padding: 1rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 0.5rem; color: var(--text-primary); font-family: 'Fira Code', monospace; resize: vertical;"
                            ></textarea>
                        </div>
                        
                        <div class="execution-options" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                            <div class="input-group">
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Agent Selection</label>
                                <select id="agentSelection" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 0.5rem; color: var(--text-primary);">
                                    <option value="auto">🤖 Auto-Select Best Agent</option>
                                    <option value="architect">🏗️ Architect - System Design</option>
                                    <option value="frontend-specialist">🎨 Frontend - UI/UX</option>
                                    <option value="backend-specialist">⚙️ Backend - API/Server</option>
                                    <option value="optimizer">⚡ Optimizer - Performance</option>
                                    <option value="debugger">🐛 Debugger - Bug Fixes</option>
                                    <option value="implementer">💻 Implementer - Code Writing</option>
                                </select>
                            </div>
                            
                            <div class="input-group">
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Execution Mode</label>
                                <select id="executionMode" style="width: 100%; padding: 0.75rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 0.5rem; color: var(--text-primary);">
                                    <option value="real">🚀 Real Claude Execution</option>
                                    <option value="simulation">🧪 Simulation Mode</option>
                                    <option value="analysis">📊 Analysis Only</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="advanced-options" style="margin-bottom: 1rem;">
                            <details style="margin-bottom: 1rem;">
                                <summary style="cursor: pointer; padding: 0.5rem; background: var(--bg-tertiary); border-radius: 0.5rem; margin-bottom: 0.5rem;">⚙️ Advanced Configuration</summary>
                                <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 0.5rem; border: 1px solid var(--border);">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                                        <div class="input-group">
                                            <label>Temperature</label>
                                            <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7" style="width: 100%;">
                                            <span id="temperatureValue">0.7</span>
                                        </div>
                                        <div class="input-group">
                                            <label>Max Tokens</label>
                                            <select id="maxTokens" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 0.25rem; color: var(--text-primary);">
                                                <option value="2048">2K tokens</option>
                                                <option value="4096" selected>4K tokens</option>
                                                <option value="8192">8K tokens</option>
                                                <option value="16384">16K tokens</option>
                                            </select>
                                        </div>
                                        <div class="input-group">
                                            <label>Priority</label>
                                            <select id="priority" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 0.25rem; color: var(--text-primary);">
                                                <option value="low">Low</option>
                                                <option value="normal" selected>Normal</option>
                                                <option value="high">High</option>
                                                <option value="urgent">Urgent</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </details>
                        </div>
                        
                        <div class="execution-controls" style="display: flex; gap: 1rem; align-items: center;">
                            <button 
                                id="executeTaskBtn" 
                                onclick="executeTask()" 
                                style="padding: 1rem 2rem; background: linear-gradient(135deg, var(--purple), var(--accent-primary)); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600; flex: 1; transition: all 0.3s ease;"
                            >
                                <i class="fas fa-play"></i> Execute Task
                            </button>
                            <button 
                                onclick="saveTaskPreset()" 
                                style="padding: 1rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem; cursor: pointer;"
                            >
                                <i class="fas fa-save"></i>
                            </button>
                            <button 
                                onclick="clearTask()" 
                                style="padding: 1rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem; cursor: pointer;"
                            >
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        
                        <!-- Execution Progress -->
                        <div id="executionProgress" style="margin-top: 1rem; display: none;">
                            <div class="progress-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                <span style="color: var(--text-secondary); font-weight: 600;">Execution Progress</span>
                                <button onclick="cancelExecution()" style="background: var(--error); color: white; border: none; padding: 0.25rem 0.5rem; border-radius: 0.25rem; cursor: pointer; font-size: 0.8rem;">
                                    <i class="fas fa-stop"></i> Cancel
                                </button>
                            </div>
                            <div class="progress-bar" style="width: 100%; height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden;">
                                <div id="progressFill" style="height: 100%; background: linear-gradient(90deg, var(--purple), var(--accent-primary)); width: 0%; transition: width 0.3s ease;"></div>
                            </div>
                            <div id="progressStatus" style="margin-top: 0.5rem; color: var(--text-muted); font-size: 0.9rem;">
                                Initializing...
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Actions & Presets -->
                    <div class="quick-actions-section">
                        <h3 style="margin: 0 0 1rem 0; color: var(--text-primary);">Quick Actions</h3>
                        
                        <div class="preset-buttons" style="display: grid; gap: 0.5rem; margin-bottom: 2rem;">
                            <button class="preset-btn" onclick="loadPreset('code-review')" style="padding: 0.75rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem; cursor: pointer; text-align: left;">
                                <i class="fas fa-code-branch"></i> Code Review
                            </button>
                            <button class="preset-btn" onclick="loadPreset('bug-fix')" style="padding: 0.75rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem; cursor: pointer; text-align: left;">
                                <i class="fas fa-bug"></i> Bug Analysis
                            </button>
                            <button class="preset-btn" onclick="loadPreset('optimize')" style="padding: 0.75rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem; cursor: pointer; text-align: left;">
                                <i class="fas fa-tachometer-alt"></i> Performance Optimization
                            </button>
                            <button class="preset-btn" onclick="loadPreset('document')" style="padding: 0.75rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem; cursor: pointer; text-align: left;">
                                <i class="fas fa-file-alt"></i> Documentation
                            </button>
                        </div>
                        
                        <h4 style="margin: 0 0 1rem 0; color: var(--text-secondary);">Agent Presets</h4>
                        <div class="agent-presets" style="display: grid; gap: 0.5rem;">
                            <button onclick="loadAgentPreset('frontend-focused')" style="padding: 0.5rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.25rem; cursor: pointer; font-size: 0.9rem;">
                                🎨 Frontend Team
                            </button>
                            <button onclick="loadAgentPreset('backend-focused')" style="padding: 0.5rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.25rem; cursor: pointer; font-size: 0.9rem;">
                                ⚙️ Backend Team
                            </button>
                            <button onclick="loadAgentPreset('full-stack')" style="padding: 0.5rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.25rem; cursor: pointer; font-size: 0.9rem;">
                                🚀 Full Stack Team
                            </button>
                            <button onclick="loadAgentPreset('debug-mode')" style="padding: 0.5rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.25rem; cursor: pointer; font-size: 0.9rem;">
                                🐛 Debug Squad
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Active Agents -->
        <div class="dashboard-card active-agents">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-robot"></i>
                    Active Agents
                </div>
                <div class="card-subtitle">Currently running AI agents and their status</div>
            </div>
            <div class="card-content">
                <div class="agent-list" id="agentList">
                    <!-- Agents will be populated dynamically -->
                    <div class="agent-item">
                        <div class="agent-avatar architect">AR</div>
                        <div class="agent-info">
                            <div class="agent-name">Architect</div>
                            <div class="agent-task">Analyzing system architecture for auth feature</div>
                        </div>
                        <div class="agent-status">
                            <div class="agent-status-badge status-analyzing">Analyzing</div>
                        </div>
                        <div class="agent-metrics">
                            <div class="response-time">2.3s</div>
                            <div>87% confidence</div>
                        </div>
                    </div>

                    <div class="agent-item">
                        <div class="agent-avatar frontend">FE</div>
                        <div class="agent-info">
                            <div class="agent-name">Frontend Specialist</div>
                            <div class="agent-task">Implementing React components</div>
                        </div>
                        <div class="agent-status">
                            <div class="agent-status-badge status-implementing">Implementing</div>
                        </div>
                        <div class="agent-metrics">
                            <div class="response-time">1.8s</div>
                            <div>92% confidence</div>
                        </div>
                    </div>

                    <div class="agent-item">
                        <div class="agent-avatar backend">BE</div>
                        <div class="agent-info">
                            <div class="agent-name">Backend Specialist</div>
                            <div class="agent-task">Coordinating with database specialist</div>
                        </div>
                        <div class="agent-status">
                            <div class="agent-status-badge status-coordinating">Coordinating</div>
                        </div>
                        <div class="agent-metrics">
                            <div class="response-time">3.1s</div>
                            <div>78% confidence</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Health -->
        <div class="dashboard-card system-health">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-heartbeat"></i>
                    System Health
                </div>
                <div class="card-subtitle">Real-time system performance metrics</div>
            </div>
            <div class="card-content">
                <div class="health-metrics">
                    <div class="health-metric">
                        <div class="metric-value healthy" id="activeAgentsCount">5</div>
                        <div class="metric-label">Active Agents</div>
                        <div class="metric-trend trend-up">↑ 12%</div>
                    </div>
                    <div class="health-metric">
                        <div class="metric-value healthy" id="avgResponseTime">2.1s</div>
                        <div class="metric-label">Avg Response</div>
                        <div class="metric-trend trend-down">↓ 8%</div>
                    </div>
                    <div class="health-metric">
                        <div class="metric-value healthy" id="successRate">94%</div>
                        <div class="metric-label">Success Rate</div>
                        <div class="metric-trend trend-up">↑ 3%</div>
                    </div>
                    <div class="health-metric">
                        <div class="metric-value warning" id="queueLength">7</div>
                        <div class="metric-label">Queue Length</div>
                        <div class="metric-trend trend-up">↑ 2</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Coordination Graph -->
        <div class="dashboard-card coordination-graph">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-project-diagram"></i>
                    Agent Coordination Graph
                </div>
                <div class="card-subtitle">Visual representation of agent collaboration and task flow</div>
            </div>
            <div class="card-content">
                <div class="graph-container">
                    <div class="graph-placeholder" id="coordinationGraph">
                        <i class="fas fa-spinner fa-spin"></i>
                        &nbsp;&nbsp;Loading coordination graph...
                    </div>
                </div>
            </div>
        </div>

        <!-- Kanban Task Board (Evolution Enhancement) -->
        <div class="dashboard-card task-queue kanban-board">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-columns"></i>
                    Kanban Task Board
                </div>
                <div class="card-subtitle">Drag tasks between columns to update status</div>
                <button onclick="addNewTask()" style="background: var(--accent-primary); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">
                    <i class="fas fa-plus"></i> New Task
                </button>
            </div>
            <div class="card-content">
                <div class="kanban-container" id="kanbanBoard">
                    <!-- Backlog Column -->
                    <div class="kanban-column" data-column="backlog">
                        <div class="kanban-column-header">
                            <span class="column-title">📋 Backlog</span>
                            <span class="column-count">2</span>
                        </div>
                        <div class="kanban-column-content" ondrop="handleDrop(event, 'backlog')" ondragover="handleDragOver(event)">
                            <div class="kanban-task" draggable="true" ondragstart="handleDragStart(event)" data-task-id="task-3">
                                <div class="task-priority priority-low"></div>
                                <div class="task-content">
                                    <div class="task-title">Optimize database queries</div>
                                    <div class="task-meta">
                                        <span class="task-agent">🤖 Performance Optimizer</span>
                                        <span class="task-time">2h est</span>
                                    </div>
                                </div>
                            </div>
                            <div class="kanban-task" draggable="true" ondragstart="handleDragStart(event)" data-task-id="task-4">
                                <div class="task-priority priority-medium"></div>
                                <div class="task-content">
                                    <div class="task-title">Write unit tests for auth module</div>
                                    <div class="task-meta">
                                        <span class="task-agent">🧪 Test Engineer</span>
                                        <span class="task-time">3h est</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- In Progress Column -->
                    <div class="kanban-column" data-column="in-progress">
                        <div class="kanban-column-header">
                            <span class="column-title">🚀 In Progress</span>
                            <span class="column-count">1</span>
                        </div>
                        <div class="kanban-column-content" ondrop="handleDrop(event, 'in-progress')" ondragover="handleDragOver(event)">
                            <div class="kanban-task" draggable="true" ondragstart="handleDragStart(event)" data-task-id="task-1">
                                <div class="task-priority priority-high"></div>
                                <div class="task-content">
                                    <div class="task-title">Implement JWT authentication</div>
                                    <div class="task-meta">
                                        <span class="task-agent">⚙️ Backend Specialist</span>
                                        <span class="task-time">4h est</span>
                                    </div>
                                    <div class="task-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 60%;"></div>
                                        </div>
                                        <span class="progress-text">60%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Review Column -->
                    <div class="kanban-column" data-column="review">
                        <div class="kanban-column-header">
                            <span class="column-title">👀 Review</span>
                            <span class="column-count">1</span>
                        </div>
                        <div class="kanban-column-content" ondrop="handleDrop(event, 'review')" ondragover="handleDragOver(event)">
                            <div class="kanban-task" draggable="true" ondragstart="handleDragStart(event)" data-task-id="task-2">
                                <div class="task-priority priority-medium"></div>
                                <div class="task-content">
                                    <div class="task-title">Create user registration form</div>
                                    <div class="task-meta">
                                        <span class="task-agent">🎨 Frontend Specialist</span>
                                        <span class="task-time">2h est</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Complete Column -->
                    <div class="kanban-column" data-column="complete">
                        <div class="kanban-column-header">
                            <span class="column-title">✅ Complete</span>
                            <span class="column-count">0</span>
                        </div>
                        <div class="kanban-column-content" ondrop="handleDrop(event, 'complete')" ondragover="handleDragOver(event)">
                            <!-- Completed tasks will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comprehensive Analytics Dashboard -->
        <div class="dashboard-card analytics-dashboard" style="grid-column: span 2;">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-chart-bar"></i>
                    Agent Performance Analytics
                </div>
                <div class="card-subtitle">Comprehensive metrics, trends, and insights</div>
                <button class="toggle-btn" onclick="toggleAnalyticsPanel()" style="background: var(--success); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">
                    Show Analytics
                </button>
            </div>
            <div class="card-content">
                <!-- Analytics Panel (Initially Hidden) -->
                <div id="analyticsPanel" style="display: none;">
                    <!-- Overview Stats -->
                    <div class="analytics-overview" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2rem;">
                        <div class="stat-card" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Total Executions</div>
                            <div style="font-size: 1.5rem; color: var(--info); font-weight: 700;" id="totalExecutions">0</div>
                        </div>
                        <div class="stat-card" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Success Rate</div>
                            <div style="font-size: 1.5rem; color: var(--success); font-weight: 700;" id="successRate">0%</div>
                        </div>
                        <div class="stat-card" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Avg Duration</div>
                            <div style="font-size: 1.5rem; color: var(--warning); font-weight: 700;" id="avgDuration">0s</div>
                        </div>
                        <div class="stat-card" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Total Cost</div>
                            <div style="font-size: 1.5rem; color: var(--danger); font-weight: 700;" id="totalCost">$0.00</div>
                        </div>
                    </div>
                    
                    <!-- Charts Section -->
                    <div class="analytics-charts" style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                        <!-- Performance Trend Chart -->
                        <div class="chart-container">
                            <h4 style="color: var(--text-primary); margin-bottom: 1rem;">
                                <i class="fas fa-trending-up"></i> 7-Day Performance Trend
                            </h4>
                            <div class="chart-wrapper" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem; height: 200px;">
                                <div id="performanceTrendChart">
                                    <!-- D3.js chart will be rendered here -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Agent Usage Chart -->
                        <div class="chart-container">
                            <h4 style="color: var(--text-primary); margin-bottom: 1rem;">
                                <i class="fas fa-robot"></i> Top Agents by Usage
                            </h4>
                            <div class="chart-wrapper" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem; height: 200px;">
                                <div id="agentUsageChart">
                                    <!-- D3.js chart will be rendered here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Cost Analysis -->
                    <div class="cost-analysis" style="margin-bottom: 2rem;">
                        <h4 style="color: var(--text-primary); margin-bottom: 1rem;">
                            <i class="fas fa-dollar-sign"></i> Cost Analysis
                        </h4>
                        <div class="cost-grid" style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
                            <div class="cost-breakdown" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem;">
                                <h5 style="color: var(--text-secondary); margin-bottom: 0.5rem;">Cost by Agent</h5>
                                <div id="costByAgent" class="cost-list">
                                    <!-- Cost breakdown will be populated here -->
                                </div>
                            </div>
                            <div class="cost-stats" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem;">
                                <div class="cost-stat" style="margin-bottom: 1rem;">
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Avg Per Execution</div>
                                    <div style="font-size: 1.3rem; color: var(--warning); font-weight: 600;" id="avgCostPerExecution">$0.00</div>
                                </div>
                                <div class="cost-stat" style="margin-bottom: 1rem;">
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Today's Spending</div>
                                    <div style="font-size: 1.3rem; color: var(--info); font-weight: 600;" id="todaySpending">$0.00</div>
                                </div>
                                <div class="cost-stat">
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">This Week</div>
                                    <div style="font-size: 1.3rem; color: var(--success); font-weight: 600;" id="weekSpending">$0.00</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="recent-activity">
                        <h4 style="color: var(--text-primary); margin-bottom: 1rem;">
                            <i class="fas fa-clock"></i> Recent Activity (Last 24 Hours)
                        </h4>
                        <div class="activity-summary" style="background: var(--bg-tertiary); padding: 1rem; border-radius: 0.5rem;">
                            <div class="activity-stats" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 1rem;">
                                <div class="activity-stat">
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Executions</div>
                                    <div style="font-size: 1.2rem; color: var(--info); font-weight: 600;" id="recentExecutions">0</div>
                                </div>
                                <div class="activity-stat">
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Success Rate</div>
                                    <div style="font-size: 1.2rem; color: var(--success); font-weight: 600;" id="recentSuccessRate">0%</div>
                                </div>
                                <div class="activity-stat">
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Active Agents</div>
                                    <div style="font-size: 1.2rem; color: var(--warning); font-weight: 600;" id="recentAgentTypes">0</div>
                                </div>
                            </div>
                            <div class="active-agent-list" id="activeAgentList">
                                <!-- Active agent badges will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Simple Performance Overview (Always Visible) -->
                <div class="simple-perf-overview" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                    <div class="perf-stat">
                        <div style="font-size: 0.8rem; color: var(--text-muted);">Current Success Rate</div>
                        <div style="font-size: 1.2rem; color: var(--success); font-weight: 600;" id="currentSuccessRate">100%</div>
                    </div>
                    <div class="perf-stat">
                        <div style="font-size: 0.8rem; color: var(--text-muted);">Average Response</div>
                        <div style="font-size: 1.2rem; color: var(--info); font-weight: 600;" id="currentAvgResponse">0s</div>
                    </div>
                    <div class="perf-stat">
                        <div style="font-size: 0.8rem; color: var(--text-muted);">Active Agents</div>
                        <div style="font-size: 1.2rem; color: var(--warning); font-weight: 600;" id="currentActiveCount">0</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Agent Configuration Panel -->
        <div class="dashboard-card agent-config-panel" style="grid-column: span 2; margin-top: 2rem;">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-cogs"></i>
                    Agent Configuration & Presets
                </div>
                <div class="card-subtitle">Customize agent behavior, create presets, and manage configurations</div>
                <button class="toggle-btn" onclick="toggleConfigPanel()" style="background: var(--warning); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">
                    Show Config
                </button>
            </div>
            <div class="card-content">
                <!-- Configuration Panel (Initially Hidden) -->
                <div id="configPanel" style="display: none;">
                    
                    <!-- Agent Configuration Section -->
                    <div class="config-section" style="margin-bottom: 2rem;">
                        <h4 style="color: var(--text-primary); margin-bottom: 1rem;">
                            <i class="fas fa-robot"></i> Individual Agent Settings
                        </h4>
                        
                        <div class="agent-config-grid" style="display: grid; grid-template-columns: 300px 1fr; gap: 2rem;">
                            <!-- Agent Selection -->
                            <div class="agent-selector">
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Select Agent to Configure</label>
                                <select id="configAgentSelect" onchange="loadAgentConfiguration()" style="width: 100%; padding: 0.5rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem;">
                                    <option value="">Choose an agent...</option>
                                    <option value="architect">🏗️ Architect</option>
                                    <option value="frontend-specialist">🎨 Frontend Specialist</option>
                                    <option value="backend-specialist">⚙️ Backend Specialist</option>
                                    <option value="optimizer">⚡ Optimizer</option>
                                    <option value="debugger">🐛 Debugger</option>
                                    <option value="code-reviewer">📋 Code Reviewer</option>
                                    <option value="documentation-writer">📝 Documentation Writer</option>
                                    <option value="implementer">🔨 Implementer</option>
                                </select>
                                
                                <!-- Quick Actions -->
                                <div class="quick-actions" style="margin-top: 1rem;">
                                    <button onclick="resetAgentToDefaults()" style="width: 100%; padding: 0.5rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.25rem; cursor: pointer; margin-bottom: 0.5rem;">
                                        <i class="fas fa-undo"></i> Reset to Defaults
                                    </button>
                                    <button onclick="duplicateAgentConfig()" style="width: 100%; padding: 0.5rem; background: var(--info); color: white; border: none; border-radius: 0.25rem; cursor: pointer;">
                                        <i class="fas fa-copy"></i> Duplicate Config
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Agent Configuration Form -->
                            <div class="agent-config-form" id="agentConfigForm" style="display: none;">
                                <div class="config-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                    
                                    <!-- Basic Settings -->
                                    <div class="config-group">
                                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Enabled</label>
                                        <label style="display: flex; align-items: center; cursor: pointer;">
                                            <input type="checkbox" id="agentEnabled" style="margin-right: 0.5rem;">
                                            <span style="color: var(--text-primary);">Agent is active</span>
                                        </label>
                                    </div>
                                    
                                    <div class="config-group">
                                        <label for="agentPriority" style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Priority</label>
                                        <select id="agentPriority" style="width: 100%; padding: 0.5rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem;">
                                            <option value="1">High Priority (1)</option>
                                            <option value="2">Medium Priority (2)</option>
                                            <option value="3">Low Priority (3)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="config-group">
                                        <label for="agentMaxTokens" style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Max Tokens</label>
                                        <input type="number" id="agentMaxTokens" min="1024" max="16384" step="512" value="4096" style="width: 100%; padding: 0.5rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem;">
                                    </div>
                                    
                                    <div class="config-group">
                                        <label for="agentTemperature" style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Temperature</label>
                                        <input type="range" id="agentTemperature" min="0" max="1" step="0.1" value="0.7" style="width: 100%;" oninput="updateTemperatureDisplay()">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-muted);">
                                            <span>Conservative</span>
                                            <span id="temperatureValue">0.7</span>
                                            <span>Creative</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Custom System Prompt -->
                                <div class="config-group" style="margin-top: 1rem;">
                                    <label for="agentSystemPrompt" style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Custom System Prompt (Optional)</label>
                                    <textarea id="agentSystemPrompt" rows="4" placeholder="Override the default system prompt for this agent..." style="width: 100%; padding: 0.5rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem; resize: vertical;"></textarea>
                                </div>
                                
                                <!-- Save Configuration -->
                                <div class="config-actions" style="margin-top: 1rem; display: flex; gap: 1rem;">
                                    <button onclick="saveAgentConfiguration()" style="flex: 1; padding: 0.75rem; background: var(--success); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600;">
                                        <i class="fas fa-save"></i> Save Configuration
                                    </button>
                                    <button onclick="testAgentConfiguration()" style="flex: 1; padding: 0.75rem; background: var(--info); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600;">
                                        <i class="fas fa-flask"></i> Test Configuration
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preset Management Section -->
                    <div class="preset-section" style="border-top: 1px solid var(--border); padding-top: 2rem;">
                        <h4 style="color: var(--text-primary); margin-bottom: 1rem;">
                            <i class="fas fa-bookmark"></i> Preset Management
                        </h4>
                        
                        <div class="preset-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <!-- Built-in Presets -->
                            <div class="builtin-presets">
                                <h5 style="color: var(--text-secondary); margin-bottom: 1rem;">Built-in Presets</h5>
                                <div class="preset-list">
                                    <div class="preset-item" style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: var(--bg-tertiary); border-radius: 0.5rem; margin-bottom: 0.5rem;">
                                        <div>
                                            <div style="font-weight: 600; color: var(--text-primary);">Frontend Focus</div>
                                            <div style="font-size: 0.8rem; color: var(--text-muted);">UI/UX, React, TypeScript</div>
                                        </div>
                                        <div class="preset-actions">
                                            <button onclick="loadPresetConfiguration('frontend-focused')" style="padding: 0.25rem 0.5rem; background: var(--info); color: white; border: none; border-radius: 0.25rem; cursor: pointer; margin-right: 0.25rem;">
                                                <i class="fas fa-download"></i>
                                            </button>
                                            <button onclick="editPreset('frontend-focused')" style="padding: 0.25rem 0.5rem; background: var(--warning); color: white; border: none; border-radius: 0.25rem; cursor: pointer;">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="preset-item" style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: var(--bg-tertiary); border-radius: 0.5rem; margin-bottom: 0.5rem;">
                                        <div>
                                            <div style="font-weight: 600; color: var(--text-primary);">Backend Focus</div>
                                            <div style="font-size: 0.8rem; color: var(--text-muted);">APIs, Databases, Architecture</div>
                                        </div>
                                        <div class="preset-actions">
                                            <button onclick="loadPresetConfiguration('backend-focused')" style="padding: 0.25rem 0.5rem; background: var(--info); color: white; border: none; border-radius: 0.25rem; cursor: pointer; margin-right: 0.25rem;">
                                                <i class="fas fa-download"></i>
                                            </button>
                                            <button onclick="editPreset('backend-focused')" style="padding: 0.25rem 0.5rem; background: var(--warning); color: white; border: none; border-radius: 0.25rem; cursor: pointer;">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="preset-item" style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: var(--bg-tertiary); border-radius: 0.5rem; margin-bottom: 0.5rem;">
                                        <div>
                                            <div style="font-weight: 600; color: var(--text-primary);">Debug Mode</div>
                                            <div style="font-size: 0.8rem; color: var(--text-muted);">Error Analysis, Testing</div>
                                        </div>
                                        <div class="preset-actions">
                                            <button onclick="loadPresetConfiguration('debug-mode')" style="padding: 0.25rem 0.5rem; background: var(--info); color: white; border: none; border-radius: 0.25rem; cursor: pointer; margin-right: 0.25rem;">
                                                <i class="fas fa-download"></i>
                                            </button>
                                            <button onclick="editPreset('debug-mode')" style="padding: 0.25rem 0.5rem; background: var(--warning); color: white; border: none; border-radius: 0.25rem; cursor: pointer;">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Custom Presets -->
                            <div class="custom-presets">
                                <h5 style="color: var(--text-secondary); margin-bottom: 1rem;">Custom Presets</h5>
                                <div class="custom-preset-actions" style="margin-bottom: 1rem;">
                                    <button onclick="createNewPreset()" style="width: 100%; padding: 0.75rem; background: var(--success); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600;">
                                        <i class="fas fa-plus"></i> Create New Preset
                                    </button>
                                </div>
                                <div id="customPresetList" class="preset-list">
                                    <!-- Custom presets will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Global Settings -->
                    <div class="global-settings-section" style="border-top: 1px solid var(--border); padding-top: 2rem;">
                        <h4 style="color: var(--text-primary); margin-bottom: 1rem;">
                            <i class="fas fa-globe"></i> Global Configuration
                        </h4>
                        
                        <div class="global-settings-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem;">
                            <div class="global-setting">
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Default Execution Timeout</label>
                                <select id="globalTimeout" style="width: 100%; padding: 0.5rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem;">
                                    <option value="300000">5 minutes</option>
                                    <option value="600000">10 minutes</option>
                                    <option value="900000">15 minutes</option>
                                </select>
                            </div>
                            <div class="global-setting">
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 600;">Max Concurrent Agents</label>
                                <input type="number" id="maxConcurrent" min="1" max="10" value="3" style="width: 100%; padding: 0.5rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 0.5rem;">
                            </div>
                            <div class="global-setting">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" id="autoRetry" style="margin-right: 0.5rem;">
                                    <span style="color: var(--text-primary);">Auto-retry failed executions</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="global-actions" style="margin-top: 2rem; display: flex; gap: 1rem;">
                            <button onclick="saveGlobalConfiguration()" style="flex: 1; padding: 0.75rem; background: var(--success); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-save"></i> Save Global Settings
                            </button>
                            <button onclick="exportConfiguration()" style="flex: 1; padding: 0.75rem; background: var(--info); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-download"></i> Export Configuration
                            </button>
                            <button onclick="importConfiguration()" style="flex: 1; padding: 0.75rem; background: var(--warning); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-upload"></i> Import Configuration
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Connection Status -->
    <div class="connection-status connected" id="connectionStatus">
        <div class="status-indicator"></div>
        <span>Real-time updates connected</span>
    </div>

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
        // ==========================================
        // KANBAN BOARD FUNCTIONALITY (Evolution Enhancement)
        // ==========================================
        
        let draggedTask = null;
        let taskIdCounter = 5; // Starting from 5 since we have 4 demo tasks
        
        // Drag and Drop Handlers
        function handleDragStart(e) {
            draggedTask = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.innerHTML);
        }
        
        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            
            const column = e.currentTarget;
            if (column.classList.contains('kanban-column-content')) {
                column.classList.add('drag-over');
            }
            return false;
        }
        
        function handleDrop(e, columnName) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            const column = e.currentTarget;
            column.classList.remove('drag-over');
            
            if (draggedTask && draggedTask !== e.target) {
                // Move task to new column
                column.appendChild(draggedTask);
                draggedTask.classList.remove('dragging');
                
                // Update task counts
                updateColumnCounts();
                
                // Broadcast task movement via WebSocket
                broadcastTaskMovement(draggedTask.dataset.taskId, columnName);
                
                // If moved to complete, add completion animation
                if (columnName === 'complete') {
                    celebrateCompletion(draggedTask);
                }
            }
            
            draggedTask = null;
            return false;
        }
        
        // Update column counts
        function updateColumnCounts() {
            document.querySelectorAll('.kanban-column').forEach(column => {
                const count = column.querySelector('.kanban-column-content').children.length;
                column.querySelector('.column-count').textContent = count;
            });
        }
        
        // Add new task
        function addNewTask() {
            const taskTitle = prompt('Enter task title:');
            if (!taskTitle) return;
            
            const taskAgent = prompt('Assign to agent (e.g., Backend Specialist):') || 'Auto-assign';
            const taskPriority = prompt('Priority (low/medium/high):') || 'medium';
            
            const taskId = `task-${taskIdCounter++}`;
            const taskHtml = `
                <div class="kanban-task" draggable="true" ondragstart="handleDragStart(event)" data-task-id="${taskId}">
                    <div class="task-priority priority-${taskPriority}"></div>
                    <div class="task-content">
                        <div class="task-title">${taskTitle}</div>
                        <div class="task-meta">
                            <span class="task-agent">🤖 ${taskAgent}</span>
                            <span class="task-time">Est. TBD</span>
                        </div>
                    </div>
                </div>
            `;
            
            // Add to backlog
            const backlogColumn = document.querySelector('[data-column="backlog"] .kanban-column-content');
            backlogColumn.insertAdjacentHTML('beforeend', taskHtml);
            
            // Add drag end listener
            const newTask = backlogColumn.lastElementChild;
            newTask.addEventListener('dragend', function(e) {
                e.target.classList.remove('dragging');
                document.querySelectorAll('.kanban-column-content').forEach(col => {
                    col.classList.remove('drag-over');
                });
            });
            
            updateColumnCounts();
            broadcastTaskCreation(taskId, taskTitle, taskAgent, taskPriority);
        }
        
        // Celebrate task completion
        function celebrateCompletion(taskElement) {
            taskElement.style.animation = 'pulse 0.5s ease';
            setTimeout(() => {
                taskElement.style.animation = '';
            }, 500);
        }
        
        // WebSocket broadcasting
        function broadcastTaskMovement(taskId, newColumn) {
            if (typeof ws !== 'undefined' && ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({
                    type: 'task-moved',
                    taskId: taskId,
                    column: newColumn,
                    timestamp: new Date().toISOString()
                }));
            }
        }
        
        function broadcastTaskCreation(taskId, title, agent, priority) {
            if (typeof ws !== 'undefined' && ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({
                    type: 'task-created',
                    taskId: taskId,
                    title: title,
                    agent: agent,
                    priority: priority,
                    timestamp: new Date().toISOString()
                }));
            }
        }
        
        // Add pulse animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); background: rgba(139, 92, 246, 0.2); }
                100% { transform: scale(1); }
            }
        `;
        document.head.appendChild(style);
        
        // Initialize drag end listeners on page load
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.kanban-task').forEach(task => {
                task.addEventListener('dragend', function(e) {
                    e.target.classList.remove('dragging');
                    document.querySelectorAll('.kanban-column-content').forEach(col => {
                        col.classList.remove('drag-over');
                    });
                });
            });
        });
        
        // ==========================================
        // END KANBAN BOARD FUNCTIONALITY
        // ==========================================
        
        // ==========================================
        // TERMINAL-TASK BRIDGE INTEGRATION
        // ==========================================
        
        // Initialize Socket.io connection for task events
        let taskSocket = null;
        
        function initializeTaskBridge() {
            console.log('🌉 Initializing Terminal-Task Bridge connection...');
            
            // Connect to Socket.io server
            taskSocket = io('/', {
                transports: ['websocket'],
                reconnection: true,
                reconnectionDelay: 1000,
                reconnectionAttempts: 5
            });
            
            // Connection events
            taskSocket.on('connect', () => {
                console.log('✅ Connected to Task Bridge');
                showNotification('Terminal-Task Bridge connected', 'success');
            });
            
            taskSocket.on('disconnect', () => {
                console.log('❌ Disconnected from Task Bridge');
            });
            
            // Listen for task creation events from terminal errors
            taskSocket.on('task:created', (event) => {
                console.log('📋 New task from terminal:', event);
                handleTerminalTask(event.task);
            });
            
            // Listen for task updates
            taskSocket.on('task:updated', (event) => {
                console.log('✏️ Task updated:', event);
                updateExistingTask(event.taskId, event.status, event.resolution);
            });
        }
        
        // Handle new tasks from terminal errors
        function handleTerminalTask(task) {
            // Create task element
            const taskElement = document.createElement('div');
            taskElement.className = 'kanban-task';
            taskElement.draggable = true;
            taskElement.dataset.taskId = task.id;
            taskElement.dataset.priority = task.priority;
            taskElement.dataset.source = 'terminal';
            
            // Add priority indicator
            const priorityClass = task.priority === 'high' ? 'priority-high' : 
                                 task.priority === 'low' ? 'priority-low' : 'priority-medium';
            
            taskElement.innerHTML = `
                <div class="task-header">
                    <span class="task-priority ${priorityClass}">●</span>
                    <span class="task-title">${task.title}</span>
                    <span class="task-source" title="Generated from terminal">🖥️</span>
                </div>
                <div class="task-meta">
                    <span class="task-type">${task.type || 'error'}</span>
                    ${task.autoFixAvailable ? '<span class="task-autofix" title="Auto-fix available">⚡</span>' : ''}
                </div>
                ${task.suggestedFix ? `
                    <div class="task-fix">
                        <strong>Fix:</strong> ${task.suggestedFix.primary.title}
                        ${task.suggestedFix.primary.command ? 
                            `<button onclick="applyTerminalFix('${task.id}', '${encodeURIComponent(task.suggestedFix.primary.command)}')" 
                                    class="apply-fix-btn" title="Apply fix in terminal">
                                Apply Fix ⚡
                            </button>` : ''}
                    </div>
                ` : ''}
                <div class="task-tags">
                    ${task.tags ? task.tags.map(tag => `<span class="task-tag">${tag}</span>`).join('') : ''}
                </div>
            `;
            
            // Add drag event listeners
            taskElement.addEventListener('dragstart', handleDragStart);
            taskElement.addEventListener('dragend', function(e) {
                e.target.classList.remove('dragging');
                document.querySelectorAll('.kanban-column-content').forEach(col => {
                    col.classList.remove('drag-over');
                });
            });
            
            // Add to backlog column
            const backlogColumn = document.querySelector('.kanban-column[data-column="backlog"] .kanban-column-content');
            if (backlogColumn) {
                backlogColumn.appendChild(taskElement);
                updateColumnCounts();
                
                // Show notification
                showNotification(`New task from terminal: ${task.title}`, 'info');
                
                // Highlight the new task
                taskElement.classList.add('task-new');
                setTimeout(() => taskElement.classList.remove('task-new'), 3000);
            }
        }
        
        // Apply terminal fix
        function applyTerminalFix(taskId, encodedCommand) {
            const command = decodeURIComponent(encodedCommand);
            
            if (confirm(`Apply this fix in terminal?\n\n${command}`)) {
                taskSocket.emit('task:apply-fix', {
                    taskId: taskId,
                    command: command
                });
                
                showNotification('Fix command sent to terminal', 'success');
                
                // Move task to in-progress
                const taskElement = document.querySelector(`[data-task-id="${taskId}"]`);
                if (taskElement) {
                    const inProgressColumn = document.querySelector('.kanban-column[data-column="in-progress"] .kanban-column-content');
                    if (inProgressColumn) {
                        inProgressColumn.appendChild(taskElement);
                        updateColumnCounts();
                    }
                }
            }
        }
        
        // Update existing task status
        function updateExistingTask(taskId, status, resolution) {
            const taskElement = document.querySelector(`[data-task-id="${taskId}"]`);
            if (!taskElement) return;
            
            // Determine target column based on status
            let targetColumn;
            switch(status) {
                case 'resolved':
                case 'completed':
                    targetColumn = 'complete';
                    break;
                case 'in-progress':
                    targetColumn = 'in-progress';
                    break;
                case 'review':
                    targetColumn = 'review';
                    break;
                default:
                    return;
            }
            
            // Move to target column
            const column = document.querySelector(`.kanban-column[data-column="${targetColumn}"] .kanban-column-content`);
            if (column) {
                column.appendChild(taskElement);
                updateColumnCounts();
                
                // Add resolution note if provided
                if (resolution) {
                    const resolutionDiv = document.createElement('div');
                    resolutionDiv.className = 'task-resolution';
                    resolutionDiv.innerHTML = `✅ ${resolution}`;
                    taskElement.appendChild(resolutionDiv);
                }
                
                // Highlight the update
                taskElement.classList.add('task-updated');
                setTimeout(() => taskElement.classList.remove('task-updated'), 3000);
            }
        }
        
        // Initialize Task Bridge on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeTaskBridge();
            }, 1000); // Slight delay to ensure Socket.io is loaded
        });
        
        // Add styles for terminal tasks
        const terminalTaskStyles = document.createElement('style');
        terminalTaskStyles.textContent = `
            .task-source {
                float: right;
                font-size: 1rem;
            }
            .task-type {
                background: var(--secondary);
                color: var(--text);
                padding: 0.125rem 0.5rem;
                border-radius: 0.25rem;
                font-size: 0.75rem;
            }
            .task-autofix {
                background: var(--warning);
                color: var(--bg);
                padding: 0.125rem 0.5rem;
                border-radius: 0.25rem;
                font-size: 0.75rem;
                margin-left: 0.5rem;
            }
            .task-fix {
                margin-top: 0.5rem;
                padding: 0.5rem;
                background: rgba(46, 213, 115, 0.1);
                border-radius: 0.25rem;
                font-size: 0.875rem;
            }
            .apply-fix-btn {
                margin-left: 0.5rem;
                padding: 0.25rem 0.5rem;
                background: var(--success);
                color: white;
                border: none;
                border-radius: 0.25rem;
                cursor: pointer;
                font-size: 0.75rem;
            }
            .apply-fix-btn:hover {
                opacity: 0.8;
            }
            .task-tags {
                margin-top: 0.5rem;
                display: flex;
                flex-wrap: wrap;
                gap: 0.25rem;
            }
            .task-tag {
                background: var(--secondary);
                color: var(--text);
                padding: 0.125rem 0.375rem;
                border-radius: 0.25rem;
                font-size: 0.7rem;
            }
            .task-new {
                animation: highlight-new 3s ease;
            }
            .task-updated {
                animation: highlight-update 3s ease;
            }
            .task-resolution {
                margin-top: 0.5rem;
                padding: 0.5rem;
                background: rgba(46, 213, 115, 0.2);
                border-radius: 0.25rem;
                font-size: 0.875rem;
                color: var(--success);
            }
            @keyframes highlight-new {
                0%, 100% { background: var(--surface); }
                50% { background: rgba(52, 211, 153, 0.2); }
            }
            @keyframes highlight-update {
                0%, 100% { background: var(--surface); }
                50% { background: rgba(96, 165, 250, 0.2); }
            }
        `;
        document.head.appendChild(terminalTaskStyles);
        
        // ==========================================
        // END TERMINAL-TASK BRIDGE INTEGRATION
        // ==========================================
        
        // Dashboard JavaScript
        class AgentDashboard {
            constructor() {
                this.wsConnection = null;
                this.agents = new Map();
                this.metrics = {};
                this.tasks = [];
                
                this.init();
            }

            init() {
                this.updateLastUpdateTime();
                
                // Hide connection status initially
                const statusEl = document.getElementById('connectionStatus');
                if (statusEl) {
                    statusEl.style.display = 'none';
                }
                
                // Skip WebSocket for now - use polling instead
                // this.connectWebSocket();
                
                this.setupEventListeners();
                this.loadInitialData();
                
                // Update time every second
                setInterval(() => this.updateLastUpdateTime(), 1000);
                
                // Poll for updates every 3 seconds
                setInterval(() => this.loadInitialData(), 3000);
            }

            updateLastUpdateTime() {
                const now = new Date();
                document.getElementById('lastUpdateTime').textContent = 
                    now.toLocaleTimeString();
            }

            connectWebSocket() {
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                const wsUrl = `${protocol}//${window.location.host}/agent-dashboard`;
                
                try {
                    this.wsConnection = new WebSocket(wsUrl);
                    
                    this.wsConnection.onopen = () => {
                        console.log('WebSocket connected');
                        this.updateConnectionStatus(true);
                    };
                    
                    this.wsConnection.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.handleWebSocketMessage(data);
                    };
                    
                    this.wsConnection.onerror = (error) => {
                        console.error('WebSocket error:', error);
                        this.updateConnectionStatus(false);
                    };
                    
                    this.wsConnection.onclose = () => {
                        console.log('WebSocket disconnected');
                        this.updateConnectionStatus(false);
                        
                        // Attempt to reconnect after 5 seconds
                        setTimeout(() => this.connectWebSocket(), 5000);
                    };
                } catch (error) {
                    console.error('Failed to connect WebSocket:', error);
                    this.updateConnectionStatus(false);
                }
            }

            updateConnectionStatus(connected) {
                const statusEl = document.getElementById('connectionStatus');
                const statusText = statusEl.querySelector('span');
                
                if (connected) {
                    statusEl.className = 'connection-status connected';
                    statusText.textContent = 'Real-time updates connected';
                } else {
                    statusEl.className = 'connection-status disconnected';
                    statusText.textContent = 'Connection lost - attempting reconnect...';
                }
            }

            handleWebSocketMessage(data) {
                switch (data.type) {
                    case 'agent-update':
                        this.updateAgent(data.agent);
                        break;
                    case 'metrics-update':
                        this.updateMetrics(data.metrics);
                        break;
                    case 'task-update':
                        this.updateTasks(data.tasks);
                        break;
                    case 'coordination-update':
                        this.updateCoordinationGraph(data.coordination);
                        break;
                }
            }

            async loadInitialData() {
                try {
                    // Load agents
                    const agentsResponse = await fetch('/api/agents/status');
                    if (agentsResponse.ok) {
                        const agentsData = await agentsResponse.json();
                        this.renderAgents(agentsData.agents || []);
                    }

                    // Load metrics
                    const metricsResponse = await fetch('/api/agents/metrics');
                    if (metricsResponse.ok) {
                        const metricsData = await metricsResponse.json();
                        this.updateMetrics(metricsData);
                    }

                    // Load tasks
                    const tasksResponse = await fetch('/api/agents/tasks');
                    if (tasksResponse.ok) {
                        const tasksData = await tasksResponse.json();
                        this.updateTasks(tasksData.tasks || []);
                    }

                    // Load coordination graph
                    const coordResponse = await fetch('/api/agents/coordination');
                    if (coordResponse.ok) {
                        const coordData = await coordResponse.json();
                        this.updateCoordinationGraph(coordData);
                    }
                } catch (error) {
                    console.error('Failed to load initial data:', error);
                    this.showDemoData();
                }
            }

            showDemoData() {
                // Show demo data when API is not available
                console.log('Showing demo data - API endpoints not yet available');
                
                // Update graph placeholder
                setTimeout(() => {
                    document.getElementById('coordinationGraph').innerHTML = `
                        <div style="text-align: center; color: var(--text-muted);">
                            <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 1rem; color: var(--info);"></i>
                            <div style="font-size: 1.1rem; margin-bottom: 0.5rem;">Demo Mode Active</div>
                            <div style="font-size: 0.9rem;">Agent coordination graph will appear here when agents are active</div>
                        </div>
                    `;
                }, 2000);
            }

            renderAgents(agents) {
                const agentList = document.getElementById('agentList');
                if (!agentList || !agents.length) return;

                agentList.innerHTML = agents.map(agent => `
                    <div class="agent-item">
                        <div class="agent-avatar ${agent.role}">${this.getAgentInitials(agent.role)}</div>
                        <div class="agent-info">
                            <div class="agent-name">${this.getAgentDisplayName(agent.role)}</div>
                            <div class="agent-task">${agent.currentTask || 'Idle'}</div>
                        </div>
                        <div class="agent-status">
                            <div class="agent-status-badge status-${agent.status}">${agent.status}</div>
                        </div>
                        <div class="agent-metrics">
                            <div class="response-time">${agent.responseTime || '--'}</div>
                            <div>${agent.confidence ? agent.confidence + '% confidence' : '--'}</div>
                        </div>
                    </div>
                `).join('');
            }

            getAgentInitials(role) {
                const initials = {
                    'architect': 'AR',
                    'frontend-specialist': 'FE',
                    'backend-specialist': 'BE',
                    'optimizer': 'OP',
                    'debugger': 'DB',
                    'implementer': 'IM'
                };
                return initials[role] || role.substring(0, 2).toUpperCase();
            }

            getAgentDisplayName(role) {
                const names = {
                    'architect': 'Architect',
                    'frontend-specialist': 'Frontend Specialist',
                    'backend-specialist': 'Backend Specialist',
                    'optimizer': 'Optimizer',
                    'debugger': 'Debugger',
                    'implementer': 'Implementer'
                };
                return names[role] || role.charAt(0).toUpperCase() + role.slice(1);
            }

            updateMetrics(metrics) {
                if (metrics.activeAgents !== undefined) {
                    document.getElementById('activeAgentsCount').textContent = metrics.activeAgents;
                }
                if (metrics.avgResponseTime !== undefined) {
                    document.getElementById('avgResponseTime').textContent = metrics.avgResponseTime + 's';
                }
                if (metrics.successRate !== undefined) {
                    document.getElementById('successRate').textContent = metrics.successRate + '%';
                }
                if (metrics.queueLength !== undefined) {
                    document.getElementById('queueLength').textContent = metrics.queueLength;
                }
            }

            updateTasks(tasks) {
                const taskList = document.getElementById('taskList');
                if (!taskList || !tasks.length) return;

                taskList.innerHTML = tasks.map(task => `
                    <div class="task-item">
                        <div class="task-priority priority-${task.priority}"></div>
                        <div class="task-details">
                            <div class="task-title">${task.title}</div>
                            <div class="task-agent">Assigned to: ${task.assignedAgent}</div>
                        </div>
                        <div class="task-status">${task.status}</div>
                    </div>
                `).join('');
            }

            updateCoordinationGraph(data) {
                console.log('Coordination graph data:', data);
                
                if (!data || (!data.nodes && !data.edges)) {
                    this.renderDemoCoordinationGraph();
                    return;
                }
                
                this.renderD3CoordinationGraph(data);
            }

            renderDemoCoordinationGraph() {
                // Create demo data for visualization
                const demoData = {
                    nodes: [
                        { id: 'architect', name: 'Architect', status: 'analyzing', x: 300, y: 150 },
                        { id: 'frontend', name: 'Frontend Specialist', status: 'implementing', x: 150, y: 250 },
                        { id: 'backend', name: 'Backend Specialist', status: 'coordinating', x: 450, y: 250 },
                        { id: 'database', name: 'Database Specialist', status: 'idle', x: 600, y: 150 },
                        { id: 'optimizer', name: 'Performance Optimizer', status: 'analyzing', x: 300, y: 350 }
                    ],
                    edges: [
                        { source: 'architect', target: 'frontend', type: 'coordination' },
                        { source: 'architect', target: 'backend', type: 'delegation' },
                        { source: 'backend', target: 'database', type: 'data_flow' },
                        { source: 'frontend', target: 'optimizer', type: 'performance_request' },
                        { source: 'backend', target: 'optimizer', type: 'optimization_task' }
                    ]
                };
                
                this.renderD3CoordinationGraph(demoData);
            }

            renderD3CoordinationGraph(data) {
                const container = document.getElementById('coordinationGraph');
                container.innerHTML = '';
                
                const width = container.clientWidth || 800;
                const height = container.clientHeight || 400;
                
                // Create SVG
                const svg = d3.select('#coordinationGraph')
                    .append('svg')
                    .attr('width', width)
                    .attr('height', height)
                    .attr('class', 'graph-svg');
                
                // Define arrow markers for edges
                svg.append('defs').selectAll('marker')
                    .data(['coordination', 'delegation', 'data_flow', 'performance_request', 'optimization_task'])
                    .enter().append('marker')
                    .attr('id', d => `arrow-${d}`)
                    .attr('viewBox', '0 -5 10 10')
                    .attr('refX', 25)
                    .attr('refY', 0)
                    .attr('markerWidth', 6)
                    .attr('markerHeight', 6)
                    .attr('orient', 'auto')
                    .append('path')
                    .attr('d', 'M0,-5L10,0L0,5')
                    .style('fill', d => this.getEdgeColor(d))
                    .style('opacity', 0.7);
                
                // Create force simulation
                const simulation = d3.forceSimulation(data.nodes)
                    .force('link', d3.forceLink(data.edges).id(d => d.id).distance(120))
                    .force('charge', d3.forceManyBody().strength(-300))
                    .force('center', d3.forceCenter(width / 2, height / 2))
                    .force('collision', d3.forceCollide().radius(40));
                
                // Create edges
                const edges = svg.append('g')
                    .attr('class', 'edges')
                    .selectAll('line')
                    .data(data.edges)
                    .enter().append('line')
                    .style('stroke', d => this.getEdgeColor(d.type))
                    .style('stroke-width', 2)
                    .style('stroke-opacity', 0.6)
                    .attr('marker-end', d => `url(#arrow-${d.type})`);
                
                // Create nodes
                const nodes = svg.append('g')
                    .attr('class', 'nodes')
                    .selectAll('g')
                    .data(data.nodes)
                    .enter().append('g')
                    .attr('class', 'node')
                    .call(d3.drag()
                        .on('start', (event, d) => {
                            if (!event.active) simulation.alphaTarget(0.3).restart();
                            d.fx = d.x;
                            d.fy = d.y;
                        })
                        .on('drag', (event, d) => {
                            d.fx = event.x;
                            d.fy = event.y;
                        })
                        .on('end', (event, d) => {
                            if (!event.active) simulation.alphaTarget(0);
                            d.fx = null;
                            d.fy = null;
                        }));
                
                // Add circles to nodes
                nodes.append('circle')
                    .attr('r', 30)
                    .style('fill', d => this.getAgentColor(d.id))
                    .style('stroke', '#2ac3de')
                    .style('stroke-width', 2)
                    .style('opacity', d => d.status === 'idle' ? 0.5 : 1);
                
                // Add status rings
                nodes.append('circle')
                    .attr('r', 35)
                    .style('fill', 'none')
                    .style('stroke', d => this.getStatusColor(d.status))
                    .style('stroke-width', 3)
                    .style('stroke-dasharray', d => d.status === 'analyzing' ? '5,5' : 'none')
                    .style('opacity', 0.8);
                
                // Add agent initials
                nodes.append('text')
                    .text(d => this.getAgentInitials(d.id))
                    .style('text-anchor', 'middle')
                    .style('dominant-baseline', 'middle')
                    .style('fill', 'white')
                    .style('font-size', '12px')
                    .style('font-weight', 'bold')
                    .style('pointer-events', 'none');
                
                // Add labels
                nodes.append('text')
                    .text(d => d.name || d.id)
                    .attr('y', 50)
                    .style('text-anchor', 'middle')
                    .style('fill', 'var(--text-primary)')
                    .style('font-size', '11px')
                    .style('pointer-events', 'none');
                
                // Add status labels
                nodes.append('text')
                    .text(d => d.status || 'idle')
                    .attr('y', 65)
                    .style('text-anchor', 'middle')
                    .style('fill', d => this.getStatusColor(d.status))
                    .style('font-size', '9px')
                    .style('text-transform', 'uppercase')
                    .style('letter-spacing', '0.5px')
                    .style('pointer-events', 'none');
                
                // Update positions on tick
                simulation.on('tick', () => {
                    edges
                        .attr('x1', d => d.source.x)
                        .attr('y1', d => d.source.y)
                        .attr('x2', d => d.target.x)
                        .attr('y2', d => d.target.y);
                    
                    nodes.attr('transform', d => `translate(${d.x},${d.y})`);
                });
                
                // Add interaction tooltips
                nodes.on('mouseover', (event, d) => {
                    const tooltip = d3.select('body').append('div')
                        .attr('class', 'graph-tooltip')
                        .style('opacity', 0)
                        .style('position', 'absolute')
                        .style('background', 'var(--bg-secondary)')
                        .style('color', 'var(--text-primary)')
                        .style('padding', '8px 12px')
                        .style('border-radius', '4px')
                        .style('border', '1px solid var(--border)')
                        .style('font-size', '12px')
                        .style('pointer-events', 'none')
                        .style('z-index', '1000');
                    
                    tooltip.html(`
                        <div><strong>${d.name || d.id}</strong></div>
                        <div>Status: ${d.status}</div>
                        <div>ID: ${d.id}</div>
                    `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px')
                        .transition()
                        .duration(200)
                        .style('opacity', 1);
                })
                .on('mouseout', () => {
                    d3.selectAll('.graph-tooltip').remove();
                });
            }

            getAgentColor(agentId) {
                const colors = {
                    'architect': '#bb9af7',
                    'frontend-specialist': '#2ac3de',
                    'frontend': '#2ac3de',
                    'backend-specialist': '#8b5cf6',
                    'backend': '#8b5cf6',
                    'optimizer': '#e0af68',
                    'debugger': '#f7768e',
                    'database': '#a78bfa',
                    'implementer': '#ff9e64'
                };
                return colors[agentId] || '#565f89';
            }

            getStatusColor(status) {
                const colors = {
                    'analyzing': '#e0af68',
                    'implementing': '#2ac3de',
                    'coordinating': '#bb9af7',
                    'idle': '#565f89',
                    'error': '#f7768e',
                    'completed': '#8b5cf6'
                };
                return colors[status] || '#565f89';
            }

            getEdgeColor(type) {
                const colors = {
                    'coordination': '#bb9af7',
                    'delegation': '#2ac3de',
                    'data_flow': '#8b5cf6',
                    'performance_request': '#e0af68',
                    'optimization_task': '#ff9e64'
                };
                return colors[type] || '#565f89';
            }

            renderPerformanceChart() {
                const container = document.getElementById('performanceChart');
                container.innerHTML = '';
                
                const width = container.clientWidth || 300;
                const height = 150;
                
                // Generate sample performance data
                const data = this.generatePerformanceData();
                
                const svg = d3.select('#performanceChart')
                    .append('svg')
                    .attr('width', width)
                    .attr('height', height);
                
                const margin = { top: 20, right: 20, bottom: 30, left: 40 };
                const chartWidth = width - margin.left - margin.right;
                const chartHeight = height - margin.top - margin.bottom;
                
                const xScale = d3.scaleTime()
                    .domain(d3.extent(data, d => d.time))
                    .range([0, chartWidth]);
                
                const yScale = d3.scaleLinear()
                    .domain([0, d3.max(data, d => d.responseTime)])
                    .range([chartHeight, 0]);
                
                const line = d3.line()
                    .x(d => xScale(d.time))
                    .y(d => yScale(d.responseTime))
                    .curve(d3.curveMonotoneX);
                
                const g = svg.append('g')
                    .attr('transform', `translate(${margin.left},${margin.top})`);
                
                // Add gradient
                const gradient = svg.append('defs')
                    .append('linearGradient')
                    .attr('id', 'area-gradient')
                    .attr('gradientUnits', 'userSpaceOnUse')
                    .attr('x1', 0).attr('y1', 0)
                    .attr('x2', 0).attr('y2', chartHeight);
                
                gradient.append('stop')
                    .attr('offset', '0%')
                    .attr('stop-color', '#2ac3de')
                    .attr('stop-opacity', 0.3);
                
                gradient.append('stop')
                    .attr('offset', '100%')
                    .attr('stop-color', '#2ac3de')
                    .attr('stop-opacity', 0);
                
                // Add area
                const area = d3.area()
                    .x(d => xScale(d.time))
                    .y0(chartHeight)
                    .y1(d => yScale(d.responseTime))
                    .curve(d3.curveMonotoneX);
                
                g.append('path')
                    .datum(data)
                    .attr('fill', 'url(#area-gradient)')
                    .attr('d', area);
                
                // Add line
                g.append('path')
                    .datum(data)
                    .attr('fill', 'none')
                    .attr('stroke', '#2ac3de')
                    .attr('stroke-width', 2)
                    .attr('d', line);
                
                // Add dots
                g.selectAll('.dot')
                    .data(data)
                    .enter().append('circle')
                    .attr('class', 'dot')
                    .attr('cx', d => xScale(d.time))
                    .attr('cy', d => yScale(d.responseTime))
                    .attr('r', 3)
                    .attr('fill', '#2ac3de');
                
                // Add axes
                g.append('g')
                    .attr('transform', `translate(0,${chartHeight})`)
                    .call(d3.axisBottom(xScale)
                        .ticks(5)
                        .tickFormat(d3.timeFormat('%H:%M')))
                    .selectAll('text')
                    .style('fill', 'var(--text-muted)')
                    .style('font-size', '10px');
                
                g.append('g')
                    .call(d3.axisLeft(yScale)
                        .ticks(4)
                        .tickFormat(d => d + 's'))
                    .selectAll('text')
                    .style('fill', 'var(--text-muted)')
                    .style('font-size', '10px');
                
                // Style axes
                g.selectAll('.domain, .tick line')
                    .style('stroke', 'var(--border)')
                    .style('stroke-width', 1);
            }

            generatePerformanceData() {
                const data = [];
                const now = new Date();
                
                for (let i = 0; i < 12; i++) {
                    data.push({
                        time: new Date(now.getTime() - (11 - i) * 5 * 60 * 1000),
                        responseTime: 1 + Math.random() * 4 + Math.sin(i * 0.5) * 0.5
                    });
                }
                
                return data;
            }

            setupEventListeners() {
                // Render initial performance chart
                setTimeout(() => {
                    this.renderPerformanceChart();
                }, 1000);
                
                // Update chart periodically
                setInterval(() => {
                    this.renderPerformanceChart();
                }, 30000);
            }
            
            async triggerAgent(agentName) {
                console.log('Triggering agent:', agentName);
                
                // Show loading state on button
                const buttons = document.querySelectorAll('.agent-trigger-btn');
                buttons.forEach(btn => {
                    if (btn.innerHTML.includes(agentName) || 
                        btn.getAttribute('onclick').includes(agentName)) {
                        btn.disabled = true;
                        btn.style.opacity = '0.5';
                    }
                });
                
                try {
                    const response = await fetch('/api/agents/trigger', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            agent: agentName,
                            context: {
                                task: 'Demo task from dashboard',
                                timestamp: new Date()
                            }
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        console.log('Agent triggered successfully:', result);
                    } else {
                        console.error('Failed to trigger agent:', result.error);
                        alert('Failed to trigger agent: ' + (result.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('Error triggering agent:', error);
                    alert('Error triggering agent: ' + error.message);
                } finally {
                    // Re-enable button
                    buttons.forEach(btn => {
                        btn.disabled = false;
                        btn.style.opacity = '1';
                    });
                }
            }
        }

        // Analytics Functions
        function toggleAnalyticsPanel() {
            const panel = document.getElementById('analyticsPanel');
            const isHidden = panel.style.display === 'none';
            panel.style.display = isHidden ? 'block' : 'none';
            
            // Update button text
            const btn = event.target;
            btn.textContent = isHidden ? 'Hide Analytics' : 'Show Analytics';
            
            // Load analytics data when showing
            if (isHidden) {
                loadAnalyticsData();
            }
        }

        async function loadAnalyticsData() {
            try {
                // Load comprehensive analytics
                const analyticsResponse = await fetch('/api/agents/analytics');
                if (analyticsResponse.ok) {
                    const analytics = await analyticsResponse.json();
                    updateAnalyticsDisplay(analytics);
                }
                
                // Load performance data
                const performanceResponse = await fetch('/api/agents/performance');
                if (performanceResponse.ok) {
                    const performance = await performanceResponse.json();
                    updatePerformanceCharts(performance);
                }
                
                // Load cost data
                const costsResponse = await fetch('/api/agents/costs');
                if (costsResponse.ok) {
                    const costs = await costsResponse.json();
                    updateCostAnalysis(costs);
                }
                
            } catch (error) {
                console.error('Error loading analytics data:', error);
            }
        }

        function updateAnalyticsDisplay(analytics) {
            const metrics = analytics.metrics;
            
            // Update overview stats
            document.getElementById('totalExecutions').textContent = metrics.overall.totalExecutions;
            document.getElementById('successRate').textContent = metrics.overall.successRate.toFixed(1) + '%';
            document.getElementById('avgDuration').textContent = (metrics.overall.avgDuration / 1000).toFixed(1) + 's';
            document.getElementById('totalCost').textContent = '$' + metrics.overall.totalCost.toFixed(2);
            
            // Update recent activity
            const recentActivity = analytics.recentActivity;
            document.getElementById('recentExecutions').textContent = recentActivity.count;
            document.getElementById('recentSuccessRate').textContent = recentActivity.successRate.toFixed(1) + '%';
            document.getElementById('recentAgentTypes').textContent = recentActivity.agents.length;
            
            // Update active agent list
            const agentListEl = document.getElementById('activeAgentList');
            agentListEl.innerHTML = recentActivity.agents.map(agent => 
                `<span style="display: inline-block; background: var(--info); color: white; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem; margin-right: 0.5rem;">${agent}</span>`
            ).join('');
        }

        function updatePerformanceCharts(performance) {
            // Render performance trend chart
            renderPerformanceTrendChart(performance.trend);
            
            // Render agent usage chart
            renderAgentUsageChart(performance.topAgents);
            
            // Update simple performance overview
            document.getElementById('currentSuccessRate').textContent = performance.overall.successRate.toFixed(1) + '%';
            document.getElementById('currentAvgResponse').textContent = (performance.overall.avgDuration / 1000).toFixed(1) + 's';
            document.getElementById('currentActiveCount').textContent = Object.keys(performance.byAgent).length;
        }

        function renderPerformanceTrendChart(trendData) {
            const container = document.getElementById('performanceTrendChart');
            container.innerHTML = ''; // Clear previous chart
            
            if (!trendData || trendData.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-muted); padding: 2rem;">No trend data available</div>';
                return;
            }
            
            const width = 300, height = 150;
            const margin = { top: 20, right: 20, bottom: 30, left: 40 };
            
            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);
                
            const xScale = d3.scaleTime()
                .domain(d3.extent(trendData, d => new Date(d.date)))
                .range([margin.left, width - margin.right]);
                
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(trendData, d => d.executions)])
                .range([height - margin.bottom, margin.top]);
                
            const line = d3.line()
                .x(d => xScale(new Date(d.date)))
                .y(d => yScale(d.executions))
                .curve(d3.curveMonotoneX);
                
            svg.append('path')
                .datum(trendData)
                .attr('fill', 'none')
                .attr('stroke', 'var(--info)')
                .attr('stroke-width', 2)
                .attr('d', line);
                
            // Add dots
            svg.selectAll('.dot')
                .data(trendData)
                .enter().append('circle')
                .attr('class', 'dot')
                .attr('cx', d => xScale(new Date(d.date)))
                .attr('cy', d => yScale(d.executions))
                .attr('r', 3)
                .attr('fill', 'var(--success)');
        }

        function renderAgentUsageChart(topAgents) {
            const container = document.getElementById('agentUsageChart');
            container.innerHTML = ''; // Clear previous chart
            
            if (!topAgents || topAgents.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-muted); padding: 2rem;">No usage data available</div>';
                return;
            }
            
            const maxExecutions = Math.max(...topAgents.map(a => a.executions));
            
            topAgents.forEach((agent, i) => {
                const barContainer = document.createElement('div');
                barContainer.style.cssText = `
                    display: flex;
                    align-items: center;
                    margin-bottom: 0.5rem;
                    font-size: 0.8rem;
                `;
                
                const label = document.createElement('div');
                label.style.cssText = `
                    min-width: 80px;
                    color: var(--text-primary);
                    font-weight: 500;
                `;
                label.textContent = agent.agent;
                
                const bar = document.createElement('div');
                const percentage = (agent.executions / maxExecutions) * 100;
                bar.style.cssText = `
                    flex: 1;
                    height: 20px;
                    background: linear-gradient(to right, var(--success) ${percentage}%, var(--bg-secondary) ${percentage}%);
                    margin: 0 0.5rem;
                    border-radius: 0.25rem;
                    position: relative;
                `;
                
                const count = document.createElement('div');
                count.style.cssText = `
                    position: absolute;
                    right: 0.5rem;
                    top: 50%;
                    transform: translateY(-50%);
                    color: var(--text-primary);
                    font-weight: 600;
                `;
                count.textContent = agent.executions;
                
                bar.appendChild(count);
                barContainer.appendChild(label);
                barContainer.appendChild(bar);
                container.appendChild(barContainer);
            });
        }

        function updateCostAnalysis(costs) {
            // Update cost stats
            document.getElementById('avgCostPerExecution').textContent = '$' + costs.avgCostPerExecution.toFixed(3);
            
            // Calculate today's and week's spending
            const today = new Date().toISOString().split('T')[0];
            const todaySpending = costs.costByDay[today] || 0;
            document.getElementById('todaySpending').textContent = '$' + todaySpending.toFixed(2);
            
            // Calculate week spending (last 7 days)
            let weekSpending = 0;
            const now = new Date();
            for (let i = 0; i < 7; i++) {
                const date = new Date(now - i * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
                weekSpending += costs.costByDay[date] || 0;
            }
            document.getElementById('weekSpending').textContent = '$' + weekSpending.toFixed(2);
            
            // Update cost by agent breakdown
            const costByAgentEl = document.getElementById('costByAgent');
            const sortedAgentCosts = Object.entries(costs.costByAgent)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5); // Top 5 agents by cost
            
            costByAgentEl.innerHTML = sortedAgentCosts.map(([agent, cost]) => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; margin-bottom: 0.25rem; background: var(--bg-secondary); border-radius: 0.25rem;">
                    <span style="color: var(--text-primary); font-weight: 500;">${agent}</span>
                    <span style="color: var(--warning); font-weight: 600;">$${cost.toFixed(2)}</span>
                </div>
            `).join('');
        }

        // Agent Configuration Functions
        function toggleConfigPanel() {
            const panel = document.getElementById('configPanel');
            const isHidden = panel.style.display === 'none';
            panel.style.display = isHidden ? 'block' : 'none';
            
            // Update button text
            const btn = event.target;
            btn.textContent = isHidden ? 'Hide Config' : 'Show Config';
            
            // Load custom presets when showing
            if (isHidden) {
                loadCustomPresets();
            }
        }

        function loadAgentConfiguration() {
            const agentType = document.getElementById('configAgentSelect').value;
            const form = document.getElementById('agentConfigForm');
            
            if (!agentType) {
                form.style.display = 'none';
                return;
            }
            
            form.style.display = 'block';
            
            // Load configuration from AgentExecutionStore
            loadAgentConfigFromServer(agentType);
        }

        async function loadAgentConfigFromServer(agentType) {
            try {
                // For now, load default configurations
                const defaultConfigs = {
                    'architect': { enabled: true, priority: 1, maxTokens: 4096, temperature: 0.7 },
                    'frontend-specialist': { enabled: true, priority: 2, maxTokens: 4096, temperature: 0.7 },
                    'backend-specialist': { enabled: true, priority: 2, maxTokens: 4096, temperature: 0.7 },
                    'optimizer': { enabled: true, priority: 3, maxTokens: 2048, temperature: 0.5 },
                    'debugger': { enabled: true, priority: 1, maxTokens: 4096, temperature: 0.3 },
                    'code-reviewer': { enabled: true, priority: 2, maxTokens: 6144, temperature: 0.4 },
                    'documentation-writer': { enabled: true, priority: 3, maxTokens: 8192, temperature: 0.6 },
                    'implementer': { enabled: true, priority: 2, maxTokens: 8192, temperature: 0.6 }
                };
                
                const config = defaultConfigs[agentType] || defaultConfigs['implementer'];
                
                // Populate form with configuration
                document.getElementById('agentEnabled').checked = config.enabled;
                document.getElementById('agentPriority').value = config.priority;
                document.getElementById('agentMaxTokens').value = config.maxTokens;
                document.getElementById('agentTemperature').value = config.temperature;
                document.getElementById('temperatureValue').textContent = config.temperature;
                document.getElementById('agentSystemPrompt').value = config.systemPrompt || '';
                
            } catch (error) {
                console.error('Error loading agent configuration:', error);
            }
        }

        function updateTemperatureDisplay() {
            const temperature = document.getElementById('agentTemperature').value;
            document.getElementById('temperatureValue').textContent = temperature;
        }

        function resetAgentToDefaults() {
            const agentType = document.getElementById('configAgentSelect').value;
            if (!agentType) {
                alert('Please select an agent first');
                return;
            }
            
            if (confirm(`Reset ${agentType} to default configuration?`)) {
                loadAgentConfigFromServer(agentType);
            }
        }

        function duplicateAgentConfig() {
            const agentType = document.getElementById('configAgentSelect').value;
            if (!agentType) {
                alert('Please select an agent first');
                return;
            }
            
            const newName = prompt('Enter name for the new agent configuration:');
            if (!newName) return;
            
            // Get current configuration
            const config = {
                name: newName,
                enabled: document.getElementById('agentEnabled').checked,
                priority: parseInt(document.getElementById('agentPriority').value),
                maxTokens: parseInt(document.getElementById('agentMaxTokens').value),
                temperature: parseFloat(document.getElementById('agentTemperature').value),
                systemPrompt: document.getElementById('agentSystemPrompt').value
            };
            
            // Save as custom preset
            const customPresets = JSON.parse(localStorage.getItem('customAgentPresets') || '[]');
            customPresets.push(config);
            localStorage.setItem('customAgentPresets', JSON.stringify(customPresets));
            
            alert(`Configuration duplicated as "${newName}"`);
            loadCustomPresets();
        }

        async function saveAgentConfiguration() {
            const agentType = document.getElementById('configAgentSelect').value;
            if (!agentType) {
                alert('Please select an agent first');
                return;
            }
            
            const config = {
                enabled: document.getElementById('agentEnabled').checked,
                priority: parseInt(document.getElementById('agentPriority').value),
                maxTokens: parseInt(document.getElementById('agentMaxTokens').value),
                temperature: parseFloat(document.getElementById('agentTemperature').value),
                systemPrompt: document.getElementById('agentSystemPrompt').value
            };
            
            try {
                // Save configuration (for now, use localStorage - in production would use API)
                const agentConfigs = JSON.parse(localStorage.getItem('agentConfigurations') || '{}');
                agentConfigs[agentType] = config;
                localStorage.setItem('agentConfigurations', JSON.stringify(agentConfigs));
                
                // Show success notification
                showNotification('Configuration saved successfully!', 'success');
                
            } catch (error) {
                console.error('Error saving agent configuration:', error);
                showNotification('Error saving configuration: ' + error.message, 'error');
            }
        }

        async function testAgentConfiguration() {
            const agentType = document.getElementById('configAgentSelect').value;
            if (!agentType) {
                alert('Please select an agent first');
                return;
            }
            
            // Create a test task with current configuration
            const testTask = `Test task for ${agentType} agent configuration. Please respond with a brief confirmation that you received this test.`;
            
            const context = {
                executionMode: 'test',
                maxTokens: parseInt(document.getElementById('agentMaxTokens').value),
                temperature: parseFloat(document.getElementById('agentTemperature').value),
                priority: 'low',
                sessionContext: false
            };
            
            try {
                const response = await fetch('/api/agents/trigger', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        agent: agentType,
                        task: testTask,
                        context: context
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    showNotification(`Test task sent to ${agentType}! Check the agent activity for results.`, 'success');
                } else {
                    showNotification('Test failed: ' + result.error, 'error');
                }
            } catch (error) {
                console.error('Error testing configuration:', error);
                showNotification('Test error: ' + error.message, 'error');
            }
        }

        // Preset Management Functions
        function loadPresetConfiguration(presetType) {
            const presets = {
                'frontend-focused': {
                    agents: ['frontend-specialist', 'architect', 'optimizer'],
                    description: 'Optimized for frontend development with React, TypeScript, and UI/UX focus'
                },
                'backend-focused': {
                    agents: ['backend-specialist', 'architect', 'optimizer'],
                    description: 'Optimized for backend development with APIs, databases, and server architecture'
                },
                'debug-mode': {
                    agents: ['debugger', 'implementer', 'optimizer'],
                    description: 'Optimized for debugging, error analysis, and code quality improvement'
                }
            };
            
            const preset = presets[presetType];
            if (preset) {
                // Apply preset configuration
                showNotification(`Applied ${presetType.replace('-', ' ')} preset configuration`, 'success');
                
                // Could implement logic to configure multiple agents according to preset
                console.log('Applied preset:', preset);
            }
        }

        function editPreset(presetType) {
            showNotification(`Editing ${presetType} preset (feature coming soon)`, 'info');
        }

        function createNewPreset() {
            const presetName = prompt('Enter a name for your custom preset:');
            if (!presetName) return;
            
            const presetDescription = prompt('Enter a description for this preset:');
            if (!presetDescription) return;
            
            // Get current configuration as template
            const agentType = document.getElementById('configAgentSelect').value;
            if (!agentType) {
                alert('Please configure an agent first to use as a template');
                return;
            }
            
            const preset = {
                name: presetName,
                description: presetDescription,
                agentType: agentType,
                configuration: {
                    enabled: document.getElementById('agentEnabled').checked,
                    priority: parseInt(document.getElementById('agentPriority').value),
                    maxTokens: parseInt(document.getElementById('agentMaxTokens').value),
                    temperature: parseFloat(document.getElementById('agentTemperature').value),
                    systemPrompt: document.getElementById('agentSystemPrompt').value
                },
                createdAt: new Date().toISOString()
            };
            
            // Save custom preset
            const customPresets = JSON.parse(localStorage.getItem('customAgentPresets') || '[]');
            customPresets.push(preset);
            localStorage.setItem('customAgentPresets', JSON.stringify(customPresets));
            
            showNotification(`Custom preset "${presetName}" created successfully!`, 'success');
            loadCustomPresets();
        }

        function loadCustomPresets() {
            const customPresets = JSON.parse(localStorage.getItem('customAgentPresets') || '[]');
            const container = document.getElementById('customPresetList');
            
            if (customPresets.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-muted); padding: 2rem;">No custom presets yet</div>';
                return;
            }
            
            container.innerHTML = customPresets.map(preset => `
                <div class="preset-item" style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: var(--bg-tertiary); border-radius: 0.5rem; margin-bottom: 0.5rem;">
                    <div>
                        <div style="font-weight: 600; color: var(--text-primary);">${preset.name}</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted);">${preset.description}</div>
                        <div style="font-size: 0.7rem; color: var(--text-muted);">Agent: ${preset.agentType}</div>
                    </div>
                    <div class="preset-actions">
                        <button onclick="applyCustomPreset('${preset.name}')" style="padding: 0.25rem 0.5rem; background: var(--info); color: white; border: none; border-radius: 0.25rem; cursor: pointer; margin-right: 0.25rem;">
                            <i class="fas fa-download"></i>
                        </button>
                        <button onclick="editCustomPreset('${preset.name}')" style="padding: 0.25rem 0.5rem; background: var(--warning); color: white; border: none; border-radius: 0.25rem; cursor: pointer; margin-right: 0.25rem;">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteCustomPreset('${preset.name}')" style="padding: 0.25rem 0.5rem; background: var(--danger); color: white; border: none; border-radius: 0.25rem; cursor: pointer;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function applyCustomPreset(presetName) {
            const customPresets = JSON.parse(localStorage.getItem('customAgentPresets') || '[]');
            const preset = customPresets.find(p => p.name === presetName);
            
            if (!preset) {
                showNotification('Preset not found', 'error');
                return;
            }
            
            // Apply preset configuration
            const config = preset.configuration;
            document.getElementById('configAgentSelect').value = preset.agentType;
            document.getElementById('agentEnabled').checked = config.enabled;
            document.getElementById('agentPriority').value = config.priority;
            document.getElementById('agentMaxTokens').value = config.maxTokens;
            document.getElementById('agentTemperature').value = config.temperature;
            document.getElementById('temperatureValue').textContent = config.temperature;
            document.getElementById('agentSystemPrompt').value = config.systemPrompt || '';
            
            // Show the form
            document.getElementById('agentConfigForm').style.display = 'block';
            
            showNotification(`Applied custom preset "${presetName}"`, 'success');
        }

        function editCustomPreset(presetName) {
            showNotification(`Editing custom preset "${presetName}" (feature coming soon)`, 'info');
        }

        function deleteCustomPreset(presetName) {
            if (!confirm(`Delete custom preset "${presetName}"?`)) return;
            
            const customPresets = JSON.parse(localStorage.getItem('customAgentPresets') || '[]');
            const filtered = customPresets.filter(p => p.name !== presetName);
            localStorage.setItem('customAgentPresets', JSON.stringify(filtered));
            
            showNotification(`Deleted custom preset "${presetName}"`, 'success');
            loadCustomPresets();
        }

        // Global Configuration Functions
        function saveGlobalConfiguration() {
            const globalConfig = {
                timeout: parseInt(document.getElementById('globalTimeout').value),
                maxConcurrent: parseInt(document.getElementById('maxConcurrent').value),
                autoRetry: document.getElementById('autoRetry').checked,
                savedAt: new Date().toISOString()
            };
            
            localStorage.setItem('globalAgentConfiguration', JSON.stringify(globalConfig));
            showNotification('Global configuration saved successfully!', 'success');
        }

        function exportConfiguration() {
            const agentConfigs = JSON.parse(localStorage.getItem('agentConfigurations') || '{}');
            const customPresets = JSON.parse(localStorage.getItem('customAgentPresets') || '[]');
            const globalConfig = JSON.parse(localStorage.getItem('globalAgentConfiguration') || '{}');
            
            const exportData = {
                agentConfigurations: agentConfigs,
                customPresets: customPresets,
                globalConfiguration: globalConfig,
                exportedAt: new Date().toISOString(),
                version: '1.0'
            };
            
            // Download as JSON file
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `agent-config-export-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('Configuration exported successfully!', 'success');
        }

        function importConfiguration() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importData = JSON.parse(e.target.result);
                        
                        // Validate import data
                        if (!importData.version) {
                            throw new Error('Invalid configuration file format');
                        }
                        
                        // Import configurations
                        if (importData.agentConfigurations) {
                            localStorage.setItem('agentConfigurations', JSON.stringify(importData.agentConfigurations));
                        }
                        if (importData.customPresets) {
                            localStorage.setItem('customAgentPresets', JSON.stringify(importData.customPresets));
                        }
                        if (importData.globalConfiguration) {
                            localStorage.setItem('globalAgentConfiguration', JSON.stringify(importData.globalConfiguration));
                            
                            // Update global settings UI
                            const globalConfig = importData.globalConfiguration;
                            document.getElementById('globalTimeout').value = globalConfig.timeout || 300000;
                            document.getElementById('maxConcurrent').value = globalConfig.maxConcurrent || 3;
                            document.getElementById('autoRetry').checked = globalConfig.autoRetry || false;
                        }
                        
                        showNotification('Configuration imported successfully!', 'success');
                        loadCustomPresets(); // Refresh custom presets display
                        
                    } catch (error) {
                        console.error('Import error:', error);
                        showNotification('Error importing configuration: ' + error.message, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'var(--success)',
                error: 'var(--danger)',
                warning: 'var(--warning)',
                info: 'var(--info)'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type] || colors.info};
                color: white;
                padding: 1rem;
                border-radius: 0.5rem;
                z-index: 1000;
                animation: slideIn 0.3s ease-out;
                max-width: 300px;
                font-weight: 500;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remove after 4 seconds
            setTimeout(() => notification.remove(), 4000);
        }

        // Task Execution Functions
        function toggleTaskPanel() {
            const panel = document.getElementById('taskExecutionContent');
            const btn = event.target || window.event.srcElement;
            const isHidden = panel.style.display === 'none';
            panel.style.display = isHidden ? 'block' : 'none';
            
            // Update button icon and text
            if (btn) {
                btn.innerHTML = isHidden ? 
                    '<i class="fas fa-compress"></i> Collapse' : 
                    '<i class="fas fa-expand"></i> Expand';
            }
        }

        async function executeTask() {
            const taskDescription = document.getElementById('taskDescription').value.trim();
            const agentSelection = document.getElementById('agentSelection').value;
            const executionMode = document.getElementById('executionMode').value;
            const maxTokens = document.getElementById('maxTokens').value;
            const temperature = document.getElementById('temperature').value;
            const priority = document.getElementById('priority').value;
            const sessionContext = document.getElementById('sessionContext').checked;
            
            if (!taskDescription) {
                alert('Please enter a task description');
                return;
            }
            
            const executeBtn = document.getElementById('executeTaskBtn');
            const originalText = executeBtn.textContent;
            executeBtn.textContent = 'Executing...';
            executeBtn.disabled = true;
            
            try {
                const response = await fetch('/api/agents/trigger', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        agent: agentSelection === 'auto' ? 'auto-select' : agentSelection,
                        task: taskDescription,
                        context: {
                            executionMode,
                            maxTokens: parseInt(maxTokens),
                            temperature: parseFloat(temperature),
                            priority,
                            sessionContext,
                            timestamp: new Date().toISOString()
                        }
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Show success message
                    const statusDiv = document.createElement('div');
                    statusDiv.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: var(--success);
                        color: white;
                        padding: 1rem;
                        border-radius: 0.5rem;
                        z-index: 1000;
                        animation: slideIn 0.3s ease-out;
                    `;
                    statusDiv.textContent = `Task started successfully! Agent ID: ${result.agentId}`;
                    document.body.appendChild(statusDiv);
                    
                    // Remove after 5 seconds
                    setTimeout(() => statusDiv.remove(), 5000);
                    
                    // Clear form if specified
                    if (document.getElementById('clearAfterExecution').checked) {
                        clearTask();
                    }
                } else {
                    throw new Error(result.error || 'Failed to execute task');
                }
            } catch (error) {
                console.error('Task execution error:', error);
                alert(`Error executing task: ${error.message}`);
            } finally {
                executeBtn.textContent = originalText;
                executeBtn.disabled = false;
            }
        }

        function saveTaskPreset() {
            const taskDescription = document.getElementById('taskDescription').value.trim();
            const agentSelection = document.getElementById('agentSelection').value;
            const executionMode = document.getElementById('executionMode').value;
            const maxTokens = document.getElementById('maxTokens').value;
            const temperature = document.getElementById('temperature').value;
            const priority = document.getElementById('priority').value;
            
            if (!taskDescription) {
                alert('Please enter a task description to save');
                return;
            }
            
            const presetName = prompt('Enter a name for this preset:');
            if (!presetName) return;
            
            const preset = {
                name: presetName,
                taskDescription,
                agentSelection,
                executionMode,
                maxTokens: parseInt(maxTokens),
                temperature: parseFloat(temperature),
                priority,
                createdAt: new Date().toISOString()
            };
            
            // Save to localStorage for now (could be enhanced to save server-side)
            const presets = JSON.parse(localStorage.getItem('taskPresets') || '[]');
            presets.push(preset);
            localStorage.setItem('taskPresets', JSON.stringify(presets));
            
            alert(`Preset "${presetName}" saved successfully!`);
        }

        function clearTask() {
            document.getElementById('taskDescription').value = '';
            document.getElementById('agentSelection').value = 'auto';
            document.getElementById('executionMode').value = 'standard';
            document.getElementById('maxTokens').value = '4096';
            document.getElementById('temperature').value = '0.7';
            document.getElementById('priority').value = 'medium';
            document.getElementById('sessionContext').checked = true;
            document.getElementById('clearAfterExecution').checked = false;
        }

        function loadPreset(presetType) {
            const presets = {
                'code-review': {
                    task: 'Review the codebase for best practices, potential bugs, security issues, and performance optimizations. Provide detailed feedback with specific recommendations.',
                    agent: 'code-reviewer',
                    mode: 'thorough',
                    tokens: 8192,
                    temp: 0.3,
                    priority: 'high'
                },
                'bug-fix': {
                    task: 'Analyze the current codebase to identify and fix bugs. Focus on runtime errors, logic errors, and edge cases. Provide detailed explanations of fixes.',
                    agent: 'debugger',
                    mode: 'debug',
                    tokens: 6144,
                    temp: 0.2,
                    priority: 'urgent'
                },
                'optimize': {
                    task: 'Optimize the codebase for performance, readability, and maintainability. Focus on algorithmic improvements, code structure, and resource usage.',
                    agent: 'optimizer',
                    mode: 'performance',
                    tokens: 6144,
                    temp: 0.5,
                    priority: 'medium'
                },
                'document': {
                    task: 'Generate comprehensive documentation for the codebase including API docs, README files, inline comments, and usage examples.',
                    agent: 'documentation-writer',
                    mode: 'documentation',
                    tokens: 8192,
                    temp: 0.4,
                    priority: 'low'
                }
            };
            
            const preset = presets[presetType];
            if (preset) {
                document.getElementById('taskDescription').value = preset.task;
                document.getElementById('agentSelection').value = preset.agent;
                document.getElementById('executionMode').value = preset.mode;
                document.getElementById('maxTokens').value = preset.tokens;
                document.getElementById('temperature').value = preset.temp;
                document.getElementById('priority').value = preset.priority;
            }
        }

        function loadAgentPreset(presetType) {
            const presets = {
                'frontend-focused': {
                    agents: ['frontend-specialist', 'architect', 'optimizer'],
                    task: 'Focus on frontend development with React, TypeScript, and modern UI/UX patterns. Emphasize component architecture and user experience.',
                    mode: 'frontend',
                    tokens: 6144,
                    temp: 0.6
                },
                'backend-focused': {
                    agents: ['backend-specialist', 'architect', 'optimizer'],
                    task: 'Focus on backend development with APIs, databases, and server-side architecture. Emphasize scalability and security.',
                    mode: 'backend',
                    tokens: 6144,
                    temp: 0.5
                },
                'full-stack': {
                    agents: ['architect', 'frontend-specialist', 'backend-specialist'],
                    task: 'Full-stack development approach covering both frontend and backend. Balance client and server-side considerations.',
                    mode: 'full-stack',
                    tokens: 8192,
                    temp: 0.7
                },
                'debug-mode': {
                    agents: ['debugger', 'implementer', 'optimizer'],
                    task: 'Debug and fix issues in the codebase. Focus on error resolution, testing, and code quality improvements.',
                    mode: 'debug',
                    tokens: 6144,
                    temp: 0.2
                }
            };
            
            const preset = presets[presetType];
            if (preset) {
                // Set primary agent (first in the list)
                document.getElementById('agentSelection').value = preset.agents[0];
                document.getElementById('taskDescription').value = preset.task;
                document.getElementById('executionMode').value = preset.mode;
                document.getElementById('maxTokens').value = preset.tokens;
                document.getElementById('temperature').value = preset.temp;
                document.getElementById('priority').value = 'medium';
                
                // Show which agents are involved
                const statusDiv = document.createElement('div');
                statusDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--info);
                    color: white;
                    padding: 1rem;
                    border-radius: 0.5rem;
                    z-index: 1000;
                    animation: slideIn 0.3s ease-out;
                    max-width: 300px;
                `;
                statusDiv.innerHTML = `
                    <strong>${presetType.replace('-', ' ').toUpperCase()} Preset Loaded</strong><br>
                    Agents: ${preset.agents.join(', ')}<br>
                    Mode: ${preset.mode}
                `;
                document.body.appendChild(statusDiv);
                
                // Remove after 4 seconds
                setTimeout(() => statusDiv.remove(), 4000);
            }
        }

        // Initialize dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.agentDashboard = new AgentDashboard();
            // Make triggerAgent globally accessible
            window.triggerAgent = (agentName) => window.agentDashboard.triggerAgent(agentName);
            
            // Add CSS animation for notifications
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>