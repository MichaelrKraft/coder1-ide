# ============================================
# CODER1 IDE - ALPHA DEPLOYMENT (RENDER STARTER)
# ============================================
# Optimized for 512MB RAM limit on $7/month plan
# Target: 5-10 alpha users with memory persistence
# ============================================

# Core Configuration
NODE_ENV=production
PORT=3001
DEPLOYMENT_MODE=alpha-limited

# Memory Optimization for 512MB Starter Plan
NODE_OPTIONS=--max-old-space-size=400
MEMORY_OPTIMIZATION=aggressive

# ============================================
# Claude CLI Configuration (Strict Limits)
# ============================================
ENABLE_CLI_PUPPETEER=true
CLAUDE_CLI_PATH=/opt/homebrew/bin/claude
MAX_CONCURRENT_TEAMS=1        # Only 1 team at a time
MAX_AGENTS_PER_TEAM=2         # Max 2 agents (sequential)
PROCESS_POOL_SIZE=1           # Single Claude process
PROCESS_TIMEOUT_MS=300000     # 5 minutes max
IDLE_TIMEOUT_MS=60000         # 1 minute idle = cleanup

# ============================================
# Session & Memory Management
# ============================================
SESSION_PERSISTENCE=true
SESSION_CLEANUP_INTERVAL=60000
MAX_SESSION_MEMORY_MB=50
TERMINAL_BUFFER_SIZE=10000
MAX_CONTEXT_SIZE_MB=100
MEMORY_PANIC_THRESHOLD_MB=380  # Emergency cleanup at 380MB

# Queue Management (Essential for Alpha)
SESSION_QUEUE_ENABLED=true
MAX_QUEUE_SIZE=5
QUEUE_TIMEOUT_MS=120000

# ============================================
# Alpha User Management
# ============================================
MAX_ALPHA_USERS=10
REQUIRE_INVITE_CODE=true
ALPHA_INVITE_CODE=CODER1ALPHA2025
ALPHA_MODE_ENABLED=false

# Allowed alpha testers (comma-separated emails)
ALPHA_ALLOWED_EMAILS=friend1@email.com,friend2@email.com,friend3@email.com

# ============================================
# Database Configuration (Session Storage)
# ============================================
DATABASE_URL=sqlite://./data/coder1-sessions.db
ENABLE_SESSION_MEMORY=true
ENABLE_PROJECT_CONTEXT=true
ENABLE_DECISION_HISTORY=true

# ============================================
# Monitoring & Health
# ============================================
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_INTERVAL=30000
ENABLE_MEMORY_MONITORING=true
ALERT_WEBHOOK_URL=              # Optional: Discord/Slack webhook

# ============================================
# Feature Flags (Disabled for Alpha)
# ============================================
ENABLE_AI_CONSULTATION=false    # Memory heavy
ENABLE_AGENT_DASHBOARD=false    # Memory heavy
ENABLE_TWEAKCC=false
ENABLE_CONTAINERS=false
ENABLE_ENHANCED_TMUX=false      # Not needed for alpha

# ============================================
# Performance Optimizations
# ============================================
DISABLE_SOURCE_MAPS=true        # Smaller builds
ENABLE_COMPRESSION=true         # Gzip responses
CACHE_STATIC_ASSETS=true        # Browser caching
LAZY_LOAD_FEATURES=true         # Load on demand

# ============================================
# Logging (Minimal for Production)
# ============================================
LOG_LEVEL=warn
CLI_PUPPETEER_DEBUG=false
CLI_PUPPETEER_LOG_LEVEL=error

# ============================================
# Next.js Optimizations
# ============================================
NEXT_TELEMETRY_DISABLED=1
ANALYZE=false