# ============================================
# CODER1 IDE - PRODUCTION DEPLOYMENT (RENDER)
# ============================================
# Single unified server architecture for production
# Optimized for Claude Code PRO/MAX users with OAuth
# ============================================

# ============================================
# CORE SERVER CONFIGURATION
# ============================================
NODE_ENV=production
PORT=3001
HOSTNAME=0.0.0.0

# Memory Management (Critical for Render 2GB limit)
NODE_OPTIONS=--max-old-space-size=1800 --expose-gc
MEMORY_PANIC_THRESHOLD_MB=1600

# Production URLs (replace with your domain)
NEXT_PUBLIC_API_URL=https://your-app.onrender.com
NEXT_PUBLIC_UNIFIED_SERVER_URL=https://your-app.onrender.com
NEXT_PUBLIC_WEBSOCKET_URL=wss://your-app.onrender.com

# ============================================
# CLAUDE CODE OAUTH INTEGRATION (NO API KEYS!)
# ============================================
# Claude Code OAuth Configuration
CLAUDE_CODE_OAUTH_ENABLED=true
CLAUDE_CODE_CLIENT_ID=your-claude-oauth-client-id
CLAUDE_CODE_CLIENT_SECRET=your-claude-oauth-client-secret
CLAUDE_CODE_REDIRECT_URI=https://your-app.onrender.com/auth/claude/callback

# Bridge Service Configuration
ENABLE_BRIDGE_SERVICE=true
BRIDGE_AUTH_SECRET=your-secure-bridge-auth-secret
BRIDGE_CONNECTION_TIMEOUT=30000

# ============================================
# ALPHA DEPLOYMENT SETTINGS
# ============================================
ALPHA_MODE_ENABLED=true
ALPHA_INVITE_CODE=CODER1ALPHA2025
MAX_ALPHA_USERS=50

# ============================================
# DATABASE & PERSISTENCE
# ============================================
# PostgreSQL for production (Render free tier)
DATABASE_URL=postgresql://user:password@host:port/database
# SQLite fallback for development
# DATABASE_URL=sqlite://./data/coder1-memory.db

# Session Management
SESSION_SECRET=your-session-secret-key
SESSION_MAX_AGE=604800000

# ============================================
# WEBSOCKET & SECURITY CONFIGURATION
# ============================================
# WebSocket Security
ENABLE_WS_AUTHENTICATION=true
WS_AUTH_TIMEOUT=30000
WS_HEARTBEAT_INTERVAL=30000

# CORS Security
CORS_ORIGINS=https://your-app.onrender.com,https://coder1.app
ENABLE_ORIGIN_VALIDATION=true

# Rate Limiting
ENABLE_RATE_LIMITING=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=900000

# ============================================
# FEATURE FLAGS (PRODUCTION)
# ============================================
NEXT_PUBLIC_ENABLE_AI_CONSULTATION=true
NEXT_PUBLIC_ENABLE_AGENT_DASHBOARD=false
NEXT_PUBLIC_ENABLE_TWEAKCC=false
NEXT_PUBLIC_ENABLE_CONTAINERS=false

# Bridge-specific features
NEXT_PUBLIC_ENABLE_BRIDGE_DOWNLOAD=true
NEXT_PUBLIC_ENABLE_LOCAL_SYNC=true

# ============================================
# MONITORING & LOGGING
# ============================================
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_INTERVAL=30000
LOG_LEVEL=info
ENABLE_REQUEST_LOGGING=true

# Performance Monitoring
ENABLE_PERFORMANCE_MONITORING=true
MEMORY_CHECK_INTERVAL=60000

# ============================================
# SECURITY HEADERS & COMPLIANCE
# ============================================
ENABLE_SECURITY_HEADERS=true
ENABLE_CSP=true
ENABLE_HSTS=true

# JWT Configuration
JWT_SECRET=your-jwt-secret-for-production
JWT_EXPIRES_IN=7d

# ============================================
# RENDER-SPECIFIC OPTIMIZATIONS
# ============================================
# Prevent Render sleep (optional)
RENDER_EXTERNAL_URL=https://your-app.onrender.com
KEEP_ALIVE_ENABLED=false

# Build optimization
NEXT_TELEMETRY_DISABLED=1
ANALYZE=false

# ============================================
# DEPLOYMENT NOTES
# ============================================
# 1. Replace all "your-app.onrender.com" with actual domain
# 2. Generate secure secrets for all *_SECRET variables
# 3. Set up PostgreSQL database on Render
# 4. Configure Cloudflare DNS to point to Render service
# 5. Enable WebSocket support in Cloudflare proxy settings
# ============================================