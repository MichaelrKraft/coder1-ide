<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart PRD Generator - Coder1 IDE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: #0a0a0a;
        }
        .gradient-text {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .pattern-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .pattern-card:hover {
            border-color: #8b5cf6;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
            transform: translateY(-4px);
        }
        .btn-gradient {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
        }
        .btn-gradient:hover {
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
            transform: translateY(-2px);
        }
        
        /* Fix text visibility and colors for dark theme */
        textarea, input[type="text"] {
            color: #f1f5f9 !important;
            background: rgba(0, 0, 0, 0.6) !important;
            border: 2px solid rgba(139, 92, 246, 0.3) !important;
            border-radius: 12px !important;
            -webkit-text-fill-color: #f1f5f9 !important;
        }
        
        textarea:focus, input[type="text"]:focus {
            background: rgba(0, 0, 0, 0.8) !important;
            border-color: #8b5cf6 !important;
            outline: none !important;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2) !important;
        }
        
        ::placeholder {
            color: #94a3b8 !important;
            opacity: 0.8 !important;
        }
        
        /* Question card styling */
        .bg-white {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
        }
        
        /* Text colors for dark theme */
        .text-gray-900 {
            color: #f1f5f9 !important;
        }
        
        .text-gray-600 {
            color: #cbd5e1 !important;
        }
        
        .text-gray-500 {
            color: #94a3b8 !important;
        }
    </style>
</head>
<body class="text-white">
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-black/50 backdrop-blur-lg border-b border-gray-800">
        <div class="container mx-auto px-6">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-cyan-500 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold">S</span>
                    </div>
                    <span class="text-xl font-bold gradient-text">Smart Patterns</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showPatternsSection()" class="text-gray-400 hover:text-white transition-colors">
                        Browse Patterns
                    </button>
                    <button onclick="window.location.href='/ide'" class="btn-gradient text-white px-4 py-2 rounded-lg hover:shadow-lg transition-all">
                        Launch Coder1 ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="pt-20 pb-16">
        <!-- Hero Section -->
        <section id="hero-section" class="container mx-auto px-6 py-16 text-center">
            <div class="inline-flex items-center space-x-2 bg-gradient-to-r from-purple-500/10 to-cyan-500/10 border border-purple-500/30 px-4 py-2 rounded-full mb-6">
                <span class="w-2 h-2 bg-gradient-to-r from-purple-500 to-cyan-500 rounded-full animate-pulse"></span>
                <span class="text-sm font-medium bg-gradient-to-r from-purple-400 to-cyan-400 bg-clip-text text-transparent">Free Professional PRD Generator</span>
            </div>
            
            <h1 class="text-5xl md:text-6xl font-bold mb-6 text-center">
                Build Like the
                <br>
                <span class="gradient-text">Best Startups</span>
            </h1>
            
            <p class="text-xl text-gray-400 mb-8 max-w-3xl mx-auto">
                Generate professional PRDs using proven patterns from Notion, Stripe, GitHub, and other successful companies. 
                Get real architectural guidance and seamless handoff to Coder1 for implementation.
            </p>
            
            <div class="flex flex-col sm:flex-row gap-4 justify-center mb-12">
                <button onclick="showDescriptionSection()" class="btn-gradient text-white px-8 py-4 rounded-lg text-lg font-semibold hover:shadow-xl transition-all">
                    üöÄ Generate My PRD (Free)
                </button>
                <button onclick="showPatternsSection()" class="border-2 border-purple-500 text-purple-400 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-purple-500/20 hover:text-white transition-all">
                    üìã Browse Patterns
                </button>
            </div>
            
            <!-- Trust Indicators -->
            <div class="flex justify-center items-center space-x-8 text-sm text-gray-500">
                <div class="flex items-center space-x-2">
                    <span class="w-3 h-3 bg-cyan-500 rounded-full"></span>
                    <span>16 Proven Patterns</span>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="w-3 h-3 bg-cyan-500 rounded-full"></span>
                    <span>70%+ Success Rate</span>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="w-3 h-3 bg-cyan-500 rounded-full"></span>
                    <span>5-Page Professional PRDs</span>
                </div>
            </div>
        </section>

        <!-- Description Section (Hidden by default) -->
        <section id="description-section" class="py-16 hidden">
            <div class="card max-w-4xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold mb-4 gradient-text">Describe Your Application</h2>
                    <p class="text-lg text-gray-300 mb-6">Start by telling us about the application you'd like to build</p>
                    <div class="inline-block px-4 py-3 rounded-lg bg-gradient-to-r from-purple-500/10 to-cyan-500/10 border border-purple-500/30">
                        <span class="text-sm font-medium bg-gradient-to-r from-purple-400 to-cyan-400 bg-clip-text text-transparent">
                            üí° Step 1 of 3: Provide a detailed description to get the best PRD recommendations
                        </span>
                    </div>
                </div>
                
                <div class="bg-white/5 rounded-2xl shadow-xl p-8 border border-white/10">
                    <div class="space-y-6">
                        <div class="space-y-3">
                            <h3 class="text-xl font-semibold text-white">Describe the application you'd like to build</h3>
                            <textarea 
                                id="app-description-input" 
                                class="w-full p-4 rounded-lg text-white bg-black/60 border-2 border-purple-500/30 focus:border-purple-500 focus:outline-none transition-all" 
                                rows="6" 
                                placeholder="Describe your application idea in detail... For example: 'I want to build a task management app for remote teams that includes real-time collaboration, file sharing, and progress tracking features.'"
                            ></textarea>
                        </div>
                        
                        <!-- Progress indicator -->
                        <div class="flex items-center justify-between text-sm text-gray-400">
                            <span>Step 1 of 3</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                                <div class="w-3 h-3 bg-gray-600 rounded-full"></div>
                                <div class="w-3 h-3 bg-gray-600 rounded-full"></div>
                            </div>
                        </div>
                        
                        <!-- Navigation Buttons -->
                        <div class="flex justify-between">
                            <button onclick="showHeroSection()" class="px-6 py-3 text-purple-400 border border-purple-500/50 rounded-lg hover:bg-purple-500/20 hover:text-white transition-all">
                                ‚Üê Back to Home
                            </button>
                            <button onclick="proceedToPatterns()" class="px-8 py-3 btn-gradient text-white rounded-lg hover:shadow-xl transition-all">
                                Next: Choose Patterns ‚Üí
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pattern Selection (Hidden by default) -->
        <section id="pattern-section" class="py-16 hidden">
            <div class="card max-w-6xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold mb-4 gradient-text">Choose Your Success Patterns</h2>
                    <p class="text-lg text-gray-300 mb-6">Select all boxes that have components or features that will apply to your application</p>
                    <div class="inline-block px-4 py-3 rounded-lg bg-gradient-to-r from-purple-500/10 to-cyan-500/10 border border-purple-500/30 mb-4">
                        <span class="text-sm font-medium bg-gradient-to-r from-purple-400 to-cyan-400 bg-clip-text text-transparent">
                            üí° Step 2 of 3: Most successful apps combine 2-4 patterns. Select all that apply to get the most relevant PRD.
                        </span>
                    </div>
                    
                    <!-- Progress indicator -->
                    <div class="flex items-center justify-center space-x-2 mb-6">
                        <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                        <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                        <div class="w-3 h-3 bg-gray-600 rounded-full"></div>
                    </div>
                </div>
                
                <div class="pattern-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <!-- Row 1 -->
                <div class="pattern-card" onclick="togglePattern('stripe')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-2">
                            <input type="checkbox" id="pattern-stripe" class="checkbox">
                            <h3 class="text-lg font-bold" style="color: var(--text-primary);">Stripe SaaS</h3>
                        </div>
                        <span class="px-2 py-1 text-xs rounded-full" style="background: rgba(16, 185, 129, 0.2); color: var(--success);">68%</span>
                    </div>
                    <p class="text-sm mb-2" style="color: var(--text-secondary);">Payment processing & developer APIs</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="component-tag blue">Payment processing</span>
                        <span class="component-tag green">User authentication</span>
                        <span class="component-tag blue">Subscription billing</span>
                        <span class="component-tag purple">API webhooks</span>
                    </div>
                    <div class="text-xs" style="color: var(--text-secondary);">Developer-first ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('notion')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-notion" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Notion Workspace</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">73%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">All-in-one workspace & content creation</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Rich text editor</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Real-time collaboration</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Database views</span>
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Block system</span>
                    </div>
                    <div class="text-xs text-gray-500">Productivity ‚Ä¢ Medium complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('github')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-github" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">GitHub DevTools</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">75%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Version control & developer collaboration</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Version control</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Issue tracking</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Pull requests</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">CI/CD automation</span>
                    </div>
                    <div class="text-xs text-gray-500">Developer tools ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('slack')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-slack" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Slack Messaging</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">71%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Team communication & channels</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Real-time messaging</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">File sharing</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Thread conversations</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Bot integrations</span>
                    </div>
                    <div class="text-xs text-gray-500">Communication ‚Ä¢ Medium complexity</div>
                </div>

                <!-- Row 2 -->
                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('figma')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-figma" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Figma Creative</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">69%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Collaborative design & creative tools</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Canvas editor</span>
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Vector graphics</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Component libraries</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Real-time collaboration</span>
                    </div>
                    <div class="text-xs text-gray-500">Creative tools ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('asana')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-asana" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Asana Projects</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">67%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Project management & task coordination</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Task management</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Project timelines</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Team collaboration</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Progress tracking</span>
                    </div>
                    <div class="text-xs text-gray-500">Project mgmt ‚Ä¢ Medium complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('zoom')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-zoom" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Zoom Video</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">74%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Video conferencing & virtual meetings</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Video conferencing</span>
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Screen sharing</span>
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Recording</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Mobile/desktop apps</span>
                    </div>
                    <div class="text-xs text-gray-500">Video platform ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('shopify')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-shopify" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Shopify Store</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">72%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">E-commerce platform & online stores</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Shopping cart</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Payment gateway</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Inventory management</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Order processing</span>
                    </div>
                    <div class="text-xs text-gray-500">E-commerce ‚Ä¢ Medium complexity</div>
                </div>

                <!-- Row 3 -->
                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('spotify')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-spotify" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Spotify Media</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">76%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Content streaming & media platforms</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Audio streaming</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Playlist management</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Recommendation engine</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Offline sync</span>
                    </div>
                    <div class="text-xs text-gray-500">Media platform ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('linkedin')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-linkedin" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">LinkedIn Social</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">70%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Professional networking & social feeds</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Professional profiles</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Social feeds</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Connection network</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Messaging system</span>
                    </div>
                    <div class="text-xs text-gray-500">Social network ‚Ä¢ Medium complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('airbnb')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-airbnb" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Airbnb Marketplace</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">68%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Peer-to-peer marketplace & bookings</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Listing management</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Booking system</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Review system</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Search filters</span>
                    </div>
                    <div class="text-xs text-gray-500">Marketplace ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('netflix')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-netflix" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Netflix Content</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">77%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Subscription content & recommendations</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Video streaming</span>
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Content delivery</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Recommendation engine</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">User profiles</span>
                    </div>
                    <div class="text-xs text-gray-500">Content platform ‚Ä¢ High complexity</div>
                </div>

                <!-- Row 4 -->
                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('uber')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-uber" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Uber On-demand</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">73%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">On-demand services & real-time matching</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Location services</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Real-time tracking</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Driver matching</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Payment processing</span>
                    </div>
                    <div class="text-xs text-gray-500">Service platform ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('salesforce')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-salesforce" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Salesforce CRM</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">75%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Customer relationship management</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Lead management</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Contact database</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Sales pipeline</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Email automation</span>
                    </div>
                    <div class="text-xs text-gray-500">Enterprise CRM ‚Ä¢ High complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('dropbox')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-dropbox" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Dropbox Storage</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">71%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Cloud file storage & synchronization</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">File storage</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Device sync</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">File sharing</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Version history</span>
                    </div>
                    <div class="text-xs text-gray-500">File storage ‚Ä¢ Medium complexity</div>
                </div>

                <div class="pattern-card bg-white rounded-xl shadow-lg p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-105" onclick="togglePattern('discord')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="pattern-discord" class="pattern-checkbox w-4 h-4 text-indigo-600 rounded">
                            <h3 class="text-lg font-bold text-gray-900">Discord Community</h3>
                        </div>
                        <span class="text-xs bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 text-cyan-400 px-2 py-1 rounded-full">69%</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Community platforms & voice chat</p>
                    <div class="flex flex-wrap gap-1 mb-2">
                        <span class="px-2 py-1 text-xs bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 text-pink-400 rounded-full">Voice/text chat</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Server management</span>
                        <span class="px-2 py-1 text-xs bg-cyan-500/20 border border-cyan-500/30 text-cyan-400 rounded-full">Role permissions</span>
                        <span class="px-2 py-1 text-xs bg-purple-500/20 border border-purple-500/30 text-purple-400 rounded-full">Bot ecosystem</span>
                    </div>
                    <div class="text-xs text-gray-500">Community ‚Ä¢ Medium complexity</div>
                </div>
            </div>
            
            <div class="mt-8 text-center">
                <div id="selected-patterns-count" class="text-sm text-gray-600 mb-4">0 patterns selected</div>
                <div class="space-y-4">
                    <button onclick="proceedToQuestionnaire()" id="continue-button" class="px-8 py-4 bg-gradient-to-r from-indigo-500 to-pink-500 text-white rounded-lg text-lg font-semibold hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        Continue to Questions ‚Üí
                    </button>
                    <div>
                        <button onclick="showDescriptionSection()" class="text-purple-400 hover:text-white transition-all">
                            ‚Üê Back to Description
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Questionnaire Interface (Hidden by default) -->
        <section id="questionnaire-section" class="container mx-auto px-6 py-16 max-w-3xl hidden">
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4 gradient-text">Smart Questionnaire</h2>
                    <div class="inline-block px-4 py-3 rounded-lg bg-gradient-to-r from-purple-500/10 to-cyan-500/10 border border-purple-500/30 mb-4">
                        <span class="text-sm font-medium bg-gradient-to-r from-purple-400 to-cyan-400 bg-clip-text text-transparent">
                            üí° Step 3 of 3: Answer these questions to complete your professional PRD
                        </span>
                    </div>
                    
                    <!-- Progress indicator -->
                    <div class="flex items-center justify-center space-x-2 mb-6">
                        <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                        <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                        <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                    </div>
                    
                    <span class="text-sm text-gray-400">
                        Question <span id="current-question">1</span> of <span id="total-questions">5</span>
                    </span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progress-bar" class="bg-gradient-to-r from-indigo-500 to-pink-500 h-2 rounded-full transition-all duration-500" style="width: 20%"></div>
                </div>
            </div>

            <!-- Question Card -->
            <div class="bg-white/5 rounded-2xl shadow-xl p-8 mb-6 border border-white/10">
                <h3 class="text-xl font-semibold mb-4 text-white">What type of application are you building?</h3>
                <div class="space-y-3">
                    <button class="w-full text-left p-4 border-2 border-purple-500/30 rounded-lg hover:border-purple-500 hover:bg-purple-500/20 transition-all text-white">
                        SaaS Platform
                    </button>
                    <button class="w-full text-left p-4 border-2 border-purple-500/30 rounded-lg hover:border-purple-500 hover:bg-purple-500/20 transition-all text-white">
                        E-commerce Platform
                    </button>
                    <button class="w-full text-left p-4 border-2 border-purple-500/30 rounded-lg hover:border-purple-500 hover:bg-purple-500/20 transition-all text-white">
                        Developer Tools
                    </button>
                    <button class="w-full text-left p-4 border-2 border-purple-500/30 rounded-lg hover:border-purple-500 hover:bg-purple-500/20 transition-all text-white">
                        Social Platform
                    </button>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between">
                <button onclick="previousQuestion()" class="px-6 py-3 text-purple-400 border border-purple-500/50 rounded-lg hover:bg-purple-500/20 hover:text-white transition-all">
                    ‚Üê Previous
                </button>
                <button onclick="nextQuestion()" class="ml-auto px-8 py-3 btn-gradient text-white rounded-lg hover:shadow-lg transition-all">
                    Next Question ‚Üí
                </button>
            </div>
            
            <div class="mt-8 text-center">
                <button onclick="showPatternsSection()" class="text-gray-600 hover:text-gray-900">
                    ‚Üê Back to Patterns
                </button>
            </div>
        </section>
    </div>

    <!-- Load comprehensive PRD generator -->
    <script src="/js/prd-generator.js?v=1726592427"></script>
    
    <script>
        // Comprehensive Smart PRD Generator with restructured flow
        let currentQuestion = 1; // Start at 1 for questionnaire (description handled separately)
        let totalQuestions = 5; // Questions 1-5 in questionnaire section
        let selectedPattern = null;
        let selectedPatterns = []; // New: Track multiple selected patterns
        let selectedAnswers = {};
        
        // Complete question set including initial text input
        const questions = [
            {
                id: 0,
                type: 'text',
                question: 'Describe the application you\'d like to build',
                placeholder: 'Describe your application idea in detail...'
            },
            {
                id: 1,
                type: 'choice',
                question: 'What type of application are you building?',
                options: ['SaaS Platform', 'E-commerce Platform', 'Developer Tools', 'Social Platform']
            },
            {
                id: 2,
                type: 'choice',
                question: 'Who is your primary target audience?',
                options: ['Developers', 'Business Users', 'Consumers', 'Enterprise Teams'],
                allowCustom: true,
                customPlaceholder: 'Describe your target audience...'
            },
            {
                id: 3,
                type: 'choice',
                question: 'What\'s your preferred business model?',
                options: ['Subscription (Monthly/Annual)', 'One-time Purchase', 'Freemium', 'Usage-based']
            },
            {
                id: 4,
                type: 'choice',
                question: 'What\'s your target timeline?',
                options: ['1-3 months', '3-6 months', '6-12 months', '12+ months']
            },
            {
                id: 5,
                type: 'choice',
                question: 'What\'s your team size?',
                options: ['Solo Founder', '2-3 people', '4-10 people', '10+ people']
            }
        ];

        // Show patterns section
        function showPatternsSection() {
            console.log('Showing patterns section');
            document.getElementById('hero-section').classList.add('hidden');
            document.getElementById('description-section').classList.add('hidden');
            document.getElementById('pattern-section').classList.remove('hidden');
            document.getElementById('questionnaire-section').classList.add('hidden');
        }

        // Show hero section
        function showHeroSection() {
            console.log('Showing hero section');
            document.getElementById('hero-section').classList.remove('hidden');
            document.getElementById('description-section').classList.add('hidden');
            document.getElementById('pattern-section').classList.add('hidden');
            document.getElementById('questionnaire-section').classList.add('hidden');
        }

        // Show description section
        function showDescriptionSection() {
            console.log('Showing description section');
            document.getElementById('hero-section').classList.add('hidden');
            document.getElementById('description-section').classList.remove('hidden');
            document.getElementById('pattern-section').classList.add('hidden');
            document.getElementById('questionnaire-section').classList.add('hidden');
        }

        // Save description and proceed to patterns
        function proceedToPatterns() {
            console.log('Proceeding to patterns');
            
            // Save the description
            const descriptionInput = document.getElementById('app-description-input');
            if (descriptionInput && descriptionInput.value.trim()) {
                selectedAnswers[0] = descriptionInput.value.trim();
                console.log('Saved description:', selectedAnswers[0]);
            } else {
                alert('Please provide a description of your application before continuing.');
                return;
            }
            
            // Show patterns section
            document.getElementById('description-section').classList.add('hidden');
            document.getElementById('pattern-section').classList.remove('hidden');
            document.getElementById('questionnaire-section').classList.add('hidden');
        }

        // Select a pattern (legacy single-select function)
        function selectPattern(pattern) {
            console.log('Selected pattern:', pattern);
            selectedPattern = pattern;
            document.getElementById('pattern-section').classList.add('hidden');
            document.getElementById('questionnaire-section').classList.remove('hidden');
            currentQuestion = 0; // Start with initial text question
            updateProgress();
            showCurrentQuestion();
            updateNavigationButtons();
        }

        // New multi-pattern selection functionality
        function togglePattern(patternId) {
            console.log('Toggling pattern:', patternId);
            
            const checkbox = document.getElementById(`pattern-${patternId}`);
            const isSelected = selectedPatterns.includes(patternId);
            
            if (isSelected) {
                // Remove pattern from selection
                selectedPatterns = selectedPatterns.filter(p => p !== patternId);
                checkbox.checked = false;
            } else {
                // Add pattern to selection
                selectedPatterns.push(patternId);
                checkbox.checked = true;
            }
            
            // Update continue button state
            updateContinueButton();
            
            console.log('Selected patterns:', selectedPatterns);
        }
        
        function updateContinueButton() {
            const continueButton = document.getElementById('continue-button');
            const selectedCount = selectedPatterns.length;
            
            if (selectedCount === 0) {
                continueButton.disabled = true;
                continueButton.innerHTML = 'üîí Select at least 1 pattern to continue';
            } else {
                continueButton.disabled = false;
                continueButton.innerHTML = `‚ú® Continue with ${selectedCount} pattern${selectedCount > 1 ? 's' : ''} ‚Üí`;
            }
        }
        
        function proceedToQuestionnaire() {
            console.log('Proceeding to questionnaire with patterns:', selectedPatterns);
            
            if (selectedPatterns.length === 0) {
                alert('Please select at least one pattern to continue.');
                return;
            }
            
            // For compatibility with existing system, set the first pattern as primary
            selectedPattern = selectedPatterns[0];
            
            // Hide all other sections and show questionnaire
            document.getElementById('description-section').classList.add('hidden');
            document.getElementById('pattern-section').classList.add('hidden');
            document.getElementById('questionnaire-section').classList.remove('hidden');
            currentQuestion = 1; // Start with question 1 (description already captured)
            updateProgress();
            showCurrentQuestion();
            updateNavigationButtons();
        }

        // Show current question
        function showCurrentQuestion() {
            // Fix: currentQuestion is 1-indexed but questions array is 0-indexed
            // When currentQuestion = 1, we want questions[1] (second item)
            // When currentQuestion = 2, we want questions[2] (third item), etc.
            const questionData = questions[currentQuestion];
            const questionContainer = document.querySelector('.bg-white\\/5.rounded-2xl.shadow-xl .space-y-3').parentElement;
            
            // Update question title
            questionContainer.querySelector('h3').textContent = questionData.question;
            
            // Update question content
            const questionContent = questionContainer.querySelector('.space-y-3');
            
            if (questionData.type === 'text') {
                questionContent.innerHTML = `
                    <textarea id="text-input" class="w-full p-4 border-2 border-purple-500/30 rounded-lg focus:border-purple-500 focus:outline-none transition-all text-white bg-black/60" 
                        rows="4" placeholder="${questionData.placeholder}">${selectedAnswers[currentQuestion] || ''}</textarea>
                `;
                
                // Add event listener for text input
                document.getElementById('text-input').addEventListener('input', (e) => {
                    selectedAnswers[currentQuestion] = e.target.value;
                });
            } else {
                const optionButtons = questionData.options.map(option => `
                    <button class="w-full text-left p-4 border-2 border-purple-500/30 rounded-lg hover:border-purple-500 hover:bg-purple-500/20 transition-all text-white
                        ${selectedAnswers[currentQuestion] === option ? 'border-purple-500 bg-purple-500/20' : ''}" 
                        onclick="selectAnswer('${option}')">
                        ${option}
                    </button>
                `);
                
                // Add custom input option if allowed
                if (questionData.allowCustom) {
                    const isCustomSelected = selectedAnswers[currentQuestion] && !questionData.options.includes(selectedAnswers[currentQuestion]);
                    optionButtons.push(`
                        <div class="space-y-2">
                            <button class="w-full text-left p-4 border-2 border-purple-500/30 rounded-lg hover:border-purple-500 hover:bg-purple-500/20 transition-all text-white
                                ${isCustomSelected ? 'border-purple-500 bg-purple-500/20' : ''}" 
                                onclick="selectCustomOption()">
                                Other (specify)
                            </button>
                            <div id="custom-input-container" class="${isCustomSelected ? '' : 'hidden'}">
                                <textarea id="custom-input" class="w-full p-3 border-2 border-purple-500 rounded-lg focus:border-purple-500 focus:outline-none transition-all text-white bg-black/60" 
                                    rows="2" placeholder="${questionData.customPlaceholder}">${isCustomSelected ? selectedAnswers[currentQuestion] : ''}</textarea>
                            </div>
                        </div>
                    `);
                }
                
                questionContent.innerHTML = optionButtons.join('');
            }
        }

        // Select an answer for choice questions
        function selectAnswer(answer) {
            selectedAnswers[currentQuestion] = answer;
            // Hide custom input if it exists
            const customContainer = document.getElementById('custom-input-container');
            if (customContainer) {
                customContainer.classList.add('hidden');
            }
            // Update button states
            const buttons = document.querySelectorAll('.space-y-3 button');
            buttons.forEach(btn => {
                btn.classList.remove('border-purple-500', 'bg-purple-500/20');
                btn.classList.add('border-purple-500/30');
                if (btn.textContent.trim() === answer) {
                    btn.classList.add('border-purple-500', 'bg-purple-500/20');
                    btn.classList.remove('border-purple-500/30');
                }
            });
        }

        // Select custom option for target audience
        function selectCustomOption() {
            // Show custom input container
            const customContainer = document.getElementById('custom-input-container');
            if (customContainer) {
                customContainer.classList.remove('hidden');
                const customInput = document.getElementById('custom-input');
                customInput.focus();
                
                // Add event listener for custom input
                customInput.addEventListener('input', (e) => {
                    selectedAnswers[currentQuestion] = e.target.value;
                });
            }
            
            // Update button states - highlight "Other (specify)" button
            const buttons = document.querySelectorAll('.space-y-3 button');
            buttons.forEach(btn => {
                btn.classList.remove('border-purple-500', 'bg-purple-500/20');
                btn.classList.add('border-purple-500/30');
                if (btn.textContent.trim() === 'Other (specify)') {
                    btn.classList.add('border-purple-500', 'bg-purple-500/20');
                    btn.classList.remove('border-purple-500/30');
                }
            });
        }

        // Navigate questions
        function nextQuestion() {
            // Save current answer if text input
            if (questions[currentQuestion].type === 'text') {
                const textInput = document.getElementById('text-input');
                if (textInput) {
                    selectedAnswers[currentQuestion] = textInput.value;
                }
            }
            
            // Save custom input if it exists and is visible
            const customInput = document.getElementById('custom-input');
            const customContainer = document.getElementById('custom-input-container');
            if (customInput && customContainer && !customContainer.classList.contains('hidden')) {
                selectedAnswers[currentQuestion] = customInput.value;
            }
            
            if (currentQuestion < totalQuestions) {
                currentQuestion++;
                updateProgress();
                showCurrentQuestion();
                updateNavigationButtons();
            } else {
                // Generate comprehensive PRD
                generateComprehensivePRD();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 1) {
                currentQuestion--;
                updateProgress();
                showCurrentQuestion();
                updateNavigationButtons();
            } else if (currentQuestion === 1) {
                // Go back to pattern selection
                showPatternsSection();
            }
        }

        // Update progress bar
        function updateProgress() {
            // For questionnaire section: Questions 1-5 (5 questions total)
            // currentQuestion ranges from 1 to 5
            const questionnaireQuestions = 5; // Questions 1-5
            const questionNumber = currentQuestion; // 1-5
            const progress = (questionNumber / questionnaireQuestions) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';
            document.getElementById('current-question').textContent = questionNumber;
            document.getElementById('total-questions').textContent = questionnaireQuestions;
        }

        // Update navigation button states
        function updateNavigationButtons() {
            // Find the previous button in the questionnaire section
            const questionnaireSection = document.getElementById('questionnaire-section');
            if (questionnaireSection && !questionnaireSection.classList.contains('hidden')) {
                const prevButton = questionnaireSection.querySelector('button[onclick="previousQuestion()"]');
                if (prevButton) {
                    // Previous button is always enabled - either goes to previous question or back to patterns
                    prevButton.disabled = false;
                    prevButton.classList.remove('opacity-50', 'cursor-not-allowed');
                    prevButton.classList.add('hover:bg-purple-500/20', 'hover:text-white');
                    
                    // Update button text based on current question
                    if (currentQuestion === 1) {
                        prevButton.textContent = '‚Üê Back to Patterns';
                    } else {
                        prevButton.textContent = '‚Üê Previous';
                    }
                }
            }
        }

        // Generate comprehensive PRD using the loaded system with multi-pattern support
        function generateComprehensivePRD() {
            console.log('Generating comprehensive PRD with patterns:', selectedPatterns, 'and answers:', selectedAnswers);
            
            // Check if comprehensive PRD generator is available
            if (typeof generateMultiPatternPRD !== 'undefined' && typeof patternConfigs !== 'undefined') {
                // Try multi-pattern generation first
                try {
                    const comprehensivePRD = generateMultiPatternPRD(selectedPatterns, selectedAnswers, patternConfigs);
                    showPRDResults(comprehensivePRD);
                    return;
                } catch (error) {
                    console.log('Multi-pattern generator not available, falling back to single pattern');
                }
            }
            
            // Fallback to single pattern generation for compatibility
            if (typeof generateComprehensivePRD !== 'undefined' && typeof patternConfigs !== 'undefined') {
                // Use the primary pattern (first selected)
                const primaryPattern = selectedPatterns.length > 0 ? selectedPatterns[0] : selectedPattern;
                const patternConfig = patternConfigs[primaryPattern];
                
                if (patternConfig) {
                    // Generate PRD with pattern mixing information
                    let prdContent = generateSinglePatternPRD(primaryPattern, selectedAnswers, patternConfig);
                    
                    // Add multi-pattern context if multiple patterns selected
                    if (selectedPatterns.length > 1) {
                        const additionalPatterns = selectedPatterns.slice(1);
                        prdContent = addMultiPatternContext(prdContent, primaryPattern, additionalPatterns, patternConfigs);
                    }
                    
                    showPRDResults(prdContent);
                } else {
                    console.error('Pattern configuration not found for:', primaryPattern);
                    showBasicPRD();
                }
            } else {
                console.error('Comprehensive PRD generator not loaded, falling back to basic PRD');
                showBasicPRD();
            }
        }

        // Helper function to generate single pattern PRD (compatibility)
        function generateSinglePatternPRD(pattern, answers, config) {
            // This will call the external generateComprehensivePRD function
            if (typeof window.generateComprehensivePRD === 'function') {
                return window.generateComprehensivePRD(pattern, answers, config);
            }
            return `<h3>PRD for ${pattern}</h3><p>Basic PRD generation - external system not loaded.</p>`;
        }

        // Helper function to add multi-pattern context
        function addMultiPatternContext(basePRD, primaryPattern, additionalPatterns, configs) {
            const additionalFeatures = additionalPatterns.map(pattern => {
                const config = configs[pattern];
                return config ? `
                    <div class="mt-4 p-4 bg-gradient-to-r from-purple-500/10 to-cyan-500/10 rounded-lg border-l-4 border-cyan-500">
                        <h5 class="text-lg font-semibold text-cyan-400">Integrated Features from ${config.name || pattern}</h5>
                        <p class="text-purple-300">${config.description || 'Additional functionality'}</p>
                        <div class="mt-2 text-sm text-blue-600">
                            <strong>Key Components:</strong> ${config.keyFeatures ? config.keyFeatures.slice(0, 3).join(', ') : 'Core features'}
                        </div>
                    </div>
                ` : '';
            }).join('');

            // Insert additional features after the executive summary
            const updatedPRD = basePRD.replace(
                /(<\/div>\s*<div[^>]*>\s*<h4[^>]*>(?:Business Model|Key Features|Technical Architecture))/i, 
                `${additionalFeatures}$1`
            );

            return updatedPRD;
        }

        // Show PRD results
        function showPRDResults(prdContent) {
            document.getElementById('questionnaire-section').classList.add('hidden');
            
            // Create PRD results section
            const resultsSection = document.createElement('section');
            resultsSection.id = 'prd-results-section';
            resultsSection.className = 'container mx-auto px-6 py-16';
            resultsSection.innerHTML = `
                <div class="max-w-4xl mx-auto">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-4">Your Professional PRD</h2>
                        <p class="text-lg text-gray-600">Ready to handoff to Claude Code for implementation</p>
                    </div>
                    
                    <div class="bg-white/5 rounded-2xl shadow-xl p-8 mb-6 border border-white/10">
                        ${prdContent}
                    </div>
                    
                    <div class="flex justify-center space-x-4">
                        <button onclick="exportPRD('markdown')" class="px-6 py-3 bg-gradient-to-r from-indigo-500 to-pink-500 text-white rounded-lg hover:shadow-lg transition-all">
                            üì• Download Markdown
                        </button>
                        <button onclick="exportPRD('copy')" class="px-6 py-3 border-2 border-purple-500 text-purple-400 rounded-lg hover:bg-purple-500/20 hover:text-white transition-all">
                            üìã Copy to Clipboard
                        </button>
                        <button onclick="window.location.href='/ide'" class="px-6 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-lg hover:shadow-lg transition-all">
                            üöÄ Launch Coder1 IDE
                        </button>
                    </div>
                    
                    <div class="mt-8 text-center">
                        <button onclick="showHeroSection(); document.getElementById('prd-results-section').remove();" class="text-gray-600 hover:text-gray-900">
                            ‚Üê Start Over
                        </button>
                    </div>
                </div>
            `;
            
            document.querySelector('.pt-20').appendChild(resultsSection);
        }

        // Fallback basic PRD with multi-pattern support
        function showBasicPRD() {
            const patternsText = selectedPatterns.length > 0 
                ? selectedPatterns.map(p => p.charAt(0).toUpperCase() + p.slice(1)).join(', ')
                : 'No patterns selected';
                
            const basicPRD = `
                <h3 class="text-2xl font-bold mb-4">Project Requirements Document</h3>
                <div class="space-y-6">
                    <div>
                        <h4 class="text-lg font-semibold mb-2">Executive Summary</h4>
                        <p class="text-gray-700">Application Description: ${selectedAnswers[0] || 'Not provided'}</p>
                        <p class="text-gray-700">Type: ${selectedAnswers[1] || 'Not specified'}</p>
                        <p class="text-gray-700">Target Audience: ${selectedAnswers[2] || 'Not specified'}</p>
                        <p class="text-gray-700">Selected Patterns: ${patternsText}</p>
                    </div>
                    
                    ${selectedPatterns.length > 1 ? `
                    <div>
                        <h4 class="text-lg font-semibold mb-2">Multi-Pattern Architecture</h4>
                        <p class="text-gray-700">This application combines features from ${selectedPatterns.length} proven patterns:</p>
                        <ul class="list-disc list-inside mt-2 text-gray-700">
                            ${selectedPatterns.map(pattern => `<li>${pattern.charAt(0).toUpperCase() + pattern.slice(1)} - Industry-tested approach</li>`).join('')}
                        </ul>
                    </div>
                    ` : ''}
                    
                    <div>
                        <h4 class="text-lg font-semibold mb-2">Business Model</h4>
                        <p class="text-gray-700">${selectedAnswers[3] || 'Not specified'}</p>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold mb-2">Timeline & Team</h4>
                        <p class="text-gray-700">Timeline: ${selectedAnswers[4] || 'Not specified'}</p>
                        <p class="text-gray-700">Team Size: ${selectedAnswers[5] || 'Not specified'}</p>
                    </div>
                </div>
            `;
            showPRDResults(basicPRD);
        }

        // Export functionality
        function exportPRD(format) {
            const prdContent = document.querySelector('#prd-results-section .bg-white').innerHTML;
            
            if (format === 'markdown') {
                // Convert HTML to Markdown (basic conversion)
                const markdownContent = prdContent
                    .replace(/<h([1-6])[^>]*>(.*?)<\/h[1-6]>/g, (match, level, text) => '#'.repeat(parseInt(level)) + ' ' + text + '\n\n')
                    .replace(/<p[^>]*>(.*?)<\/p>/g, '$1\n\n')
                    .replace(/<div[^>]*>(.*?)<\/div>/gs, '$1\n')
                    .replace(/<[^>]*>/g, '')
                    .replace(/\n\s*\n\s*\n/g, '\n\n')
                    .trim();
                
                const blob = new Blob([markdownContent], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `prd-${selectedPattern}-${Date.now()}.md`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
            } else if (format === 'copy') {
                navigator.clipboard.writeText(prdContent.replace(/<[^>]*>/g, '')).then(() => {
                    alert('PRD copied to clipboard!');
                }).catch(err => {
                    console.error('Could not copy text: ', err);
                });
            }
        }

        // Initialize
        console.log('Smart PRD Generator ready!');
        
        // Initialize continue button state
        updateContinueButton();
        
        // Load patterns from API
        fetch('/api/smart-prd/patterns')
            .then(res => res.json())
            .then(data => {
                console.log('Patterns loaded:', data);
            })
            .catch(err => console.error('Error loading patterns:', err));
    </script>
        </div> <!-- End fade-in -->
    </div> <!-- End container -->
</body>
</html>