"use strict";(self.webpackChunkcoder1_ide_source=self.webpackChunkcoder1_ide_source||[]).push([[526],{5526:(e,n,t)=>{t.r(n),t.d(n,{default:()=>w});var r=t(5043),s=t(9688),i=t(4069),o=t(1077),a=t(6269),c=(t(2179),t(579));const l=e=>{let{onVoiceCommand:n,disabled:t=!1}=e;const[s,i]=(0,r.useState)(!1),[o,a]=(0,r.useState)(!1),[l,d]=(0,r.useState)(""),[m,u]=(0,r.useState)("idle"),[p,g]=(0,r.useState)(0),h=(0,r.useRef)(null),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){a(!0);const n=new e;n.continuous=!1,n.interimResults=!1,n.lang="en-US",n.maxAlternatives=1,n.onstart=()=>{console.log("\ud83c\udfa4 Voice recognition started"),u("listening"),i(!0),d(""),f.current=setTimeout(()=>{n&&s&&n.stop()},5e3)},n.onresult=e=>{const n=e.results[0][0],t=n.transcript.toLowerCase().trim(),r=n.confidence;console.log("\ud83c\udfa4 Voice recognition result:",t,"confidence:",r),d(n.transcript),g(r),u("processing"),v(t)},n.onerror=e=>{console.error("\ud83c\udfa4 Voice recognition error:",e.error),u("error"),i(!1),f.current&&(clearTimeout(f.current),f.current=null),setTimeout(()=>{u("idle"),d("")},2e3)},n.onend=()=>{console.log("\ud83c\udfa4 Voice recognition ended"),i(!1),f.current&&(clearTimeout(f.current),f.current=null),setTimeout(()=>{u("idle"),"error"!==m&&d("")},2e3)},h.current=n}else console.warn("\ud83c\udfa4 Speech recognition not supported"),a(!1);return()=>{f.current&&clearTimeout(f.current)}},[]);const v=(0,r.useCallback)(e=>{console.log("\ud83d\udd04 Processing voice command:",e);let t="unknown",r=e;if(e.includes("claude")||e.includes("start claude")||e.includes("run claude")||e.includes("open claude"))t="run-claude",r="claude";else if(e.startsWith("type ")||e.startsWith("enter ")||e.startsWith("run "))t="terminal-input",r=e.replace(/^(type|enter|run)\s+/i,"").trim();else if(e.includes("clear terminal")||"clear"===e)t="clear-terminal",r="clear";else if(e.includes("help"))t="help",r="help";else if(e.includes("sleep mode"))t="toggle-sleep";else if(e.includes("supervision"))t="toggle-supervision";else if(e.includes("infinite loop")||e.includes("parallel agents"))t="toggle-infinite";else if(e.includes("hivemind"))t="open-hivemind";else{const n=["ls","cd","pwd","git","npm","yarn","python","node","cat","mkdir","rm"],s=e.split(" ")[0].toLowerCase();n.includes(s)&&(t="terminal-input",r=e)}console.log("\ud83c\udfaf Command mapped:",{original:e,action:t,clean:r}),n&&n(r,t)},[n]),w=(0,r.useCallback)(()=>{if(o&&!t&&!s&&h.current)try{h.current.start()}catch(e){console.error("\ud83c\udfa4 Failed to start recognition:",e),u("error"),setTimeout(()=>u("idle"),2e3)}},[o,t,s]),b=(0,r.useCallback)(()=>{h.current&&s&&h.current.stop()},[s]),x=(0,r.useCallback)(()=>{w()},[w]),y=(0,r.useCallback)(()=>{b()},[b]),k=(0,r.useCallback)(()=>{b()},[b]);return o?(0,c.jsx)("div",{className:"voice-interface",children:(0,c.jsx)("button",{className:`voice-button ${m} ${t?"disabled":""}`,onMouseDown:x,onMouseUp:y,onMouseLeave:k,onTouchStart:x,onTouchEnd:y,disabled:t||!o,title:(()=>{switch(m){case"listening":return"Listening...";case"processing":return"Processing...";case"error":return"Error occurred";default:return"Click to speak"}})(),children:"\ud83c\udfa4"})}):(0,c.jsxs)("div",{className:"voice-interface unsupported",children:[(0,c.jsx)("div",{className:"voice-button disabled",title:"Speech recognition not supported",children:"\ud83d\udeab"}),(0,c.jsx)("div",{className:"voice-status",children:"Not supported"})]})};var d=t(8044);const m=[{id:"normal",label:"Normal",description:"Standard response speed",icon:"\u26a1",estimatedTime:"~5s",tokenMultiplier:1},{id:"think",label:"Think",description:"More thoughtful responses",icon:"\ud83e\udd14",estimatedTime:"~15s",tokenMultiplier:1.5},{id:"think-hard",label:"Think Hard",description:"Deep analysis and reasoning",icon:"\ud83e\udde0",estimatedTime:"~30s",tokenMultiplier:2},{id:"ultrathink",label:"Ultrathink",description:"Maximum reasoning depth",icon:"\ud83d\udcad",estimatedTime:"~60s",tokenMultiplier:3}],u=e=>{let{value:n,onChange:t,disabled:s=!1,compact:i=!1}=e;const o=(0,d.u)("THINKING_MODE_TOGGLE"),[a,l]=(0,r.useState)("normal"),[u,p]=(0,r.useState)(null),[g,h]=(0,r.useState)(!1),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=localStorage.getItem("coder1-thinking-mode");e&&m.find(n=>n.id===e)&&l(e)},[]),(0,r.useEffect)(()=>{if(!i||!g)return;const e=e=>{f.current&&!f.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[i,g]);const v=n||a,w=e=>{l(e),localStorage.setItem("coder1-thinking-mode",e),t&&t(e)},b=()=>m.find(e=>e.id===v)||m[0];if(!o)return null;if(i){const e=b();return(0,c.jsxs)("div",{className:"thinking-mode-compact",ref:f,children:[(0,c.jsxs)("button",{className:"thinking-mode-indicator "+(s?"disabled":""),disabled:s,onClick:e=>{e.preventDefault(),e.stopPropagation(),h(!g)},onMouseEnter:()=>!g&&p(e.id),onMouseLeave:()=>p(null),children:[(0,c.jsx)("span",{className:"mode-icon",children:e.icon}),(0,c.jsx)("span",{className:"mode-label",children:e.label})]}),g&&(0,c.jsx)("div",{className:"thinking-mode-dropdown",children:m.map(e=>(0,c.jsxs)("button",{className:"thinking-mode-dropdown-item "+(v===e.id?"active":""),onClick:()=>{w(e.id),h(!1)},children:[(0,c.jsxs)("div",{className:"dropdown-item-content",children:[(0,c.jsx)("span",{className:"mode-icon",children:e.icon}),(0,c.jsx)("span",{className:"mode-label",children:e.label})]}),(0,c.jsx)("div",{className:"dropdown-item-details",children:(0,c.jsx)("span",{className:"mode-time",children:e.estimatedTime})})]},e.id))}),u&&!g&&(0,c.jsxs)("div",{className:"thinking-mode-tooltip",children:[(0,c.jsxs)("div",{className:"tooltip-header",children:[e.icon," ",e.label]}),(0,c.jsx)("div",{className:"tooltip-description",children:e.description}),(0,c.jsxs)("div",{className:"tooltip-stats",children:[(0,c.jsxs)("span",{children:["Time: ",e.estimatedTime]}),(0,c.jsxs)("span",{children:["Tokens: ",e.tokenMultiplier,"x"]})]})]})]})}return(0,c.jsxs)("div",{className:"thinking-mode-toggle "+(s?"disabled":""),children:[(0,c.jsxs)("div",{className:"thinking-mode-header",children:[(0,c.jsx)("span",{className:"thinking-icon",children:"\ud83e\udde0"}),(0,c.jsx)("span",{className:"thinking-label",children:"Thinking Mode"})]}),(0,c.jsx)("div",{className:"thinking-mode-options",children:m.map(e=>(0,c.jsxs)("button",{className:"thinking-mode-option "+(v===e.id?"active":""),onClick:()=>w(e.id),disabled:s,onMouseEnter:()=>p(e.id),onMouseLeave:()=>p(null),children:[(0,c.jsxs)("div",{className:"mode-content",children:[(0,c.jsx)("span",{className:"mode-icon",children:e.icon}),(0,c.jsx)("span",{className:"mode-label",children:e.label})]}),(0,c.jsxs)("div",{className:"mode-details",children:[(0,c.jsx)("span",{className:"mode-time",children:e.estimatedTime}),(0,c.jsxs)("span",{className:"mode-tokens",children:[e.tokenMultiplier,"x"]})]}),u===e.id&&(0,c.jsxs)("div",{className:"thinking-mode-tooltip",children:[(0,c.jsx)("div",{className:"tooltip-description",children:e.description}),(0,c.jsxs)("div",{className:"tooltip-stats",children:[(0,c.jsxs)("div",{children:["Estimated time: ",e.estimatedTime]}),(0,c.jsxs)("div",{children:["Token usage: ",e.tokenMultiplier,"x normal"]})]})]})]},e.id))}),(0,c.jsxs)("div",{className:"thinking-mode-info",children:[(0,c.jsxs)("div",{className:"current-mode",children:["Current: ",(0,c.jsx)("strong",{children:b().label})]}),(0,c.jsx)("div",{className:"mode-description",children:b().description})]})]})},p=e=>{let{socket:n,terminalId:t,onApplyFix:s}=e;const[i,o]=(0,r.useState)([]),[a,l]=(0,r.useState)(!0),[d,m]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),[g,h]=(0,r.useState)(null),[f,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!n)return;(async()=>{try{const e=await fetch("/api/error-doctor/status"),n=await e.json();n.success&&(p(n.status),l(n.status.enabled))}catch(e){console.warn("Error Doctor status check failed:",e),l(!1)}})();const e=e=>{console.log("\ud83d\udd0d Error Doctor: Received analysis",e),g&&(clearTimeout(g),h(null)),o(n=>[e,...n].slice(0,10)),m(!0);const n=setTimeout(()=>{m(!1),h(null)},12e4);h(n)},t=e=>{var n;console.log("\u2705 Error Doctor: Fix applied",e),v((null===(n=e.fix)||void 0===n?void 0:n.title)||"Fix applied successfully"),g&&(clearTimeout(g),h(null));const t=setTimeout(()=>{m(!1),o([]),v(null)},3e3);h(t)},r=e=>{console.error("\u274c Error Doctor: Fix error",e)};return n.on("error-doctor:analysis",e),n.on("error-doctor:fix-applied",t),n.on("error-doctor:fix-error",r),()=>{n.off("error-doctor:analysis",e),n.off("error-doctor:fix-applied",t),n.off("error-doctor:fix-error",r),g&&clearTimeout(g)}},[n,g]);const w=e=>{switch(e){case"high":return"#10b981";case"medium":return"#f59e0b";case"low":return"#ef4444";default:return"#6b7280"}},b=e=>{switch(e){case"quick-fix":return"\u26a1";case"claude-ai":return"\ud83e\udd16";case"openai":return"\ud83e\udde0";default:return"\ud83d\udd0d"}};return a?(0,c.jsxs)("div",{className:"error-doctor "+(d?"visible":"hidden"),children:[(0,c.jsxs)("div",{className:"error-doctor-header",children:[(0,c.jsxs)("div",{className:"error-doctor-title",children:[(0,c.jsx)("span",{className:"error-doctor-icon",children:"\ud83e\ude7a"}),"Error Doctor",u&&u.aiServices.openai||null!==u&&void 0!==u&&u.aiServices.anthropic?(0,c.jsx)("span",{className:"ai-indicator",children:"AI"}):(0,c.jsx)("span",{className:"quick-fix-indicator",children:"Quick Fix"})]}),(0,c.jsxs)("div",{className:"error-doctor-controls",children:[i.length>0&&(0,c.jsx)("button",{className:"close-panel-btn",onClick:()=>{o([]),m(!1)},title:"Clear all analyses and close panel",children:"\u2715"}),(0,c.jsx)("button",{className:"toggle-visibility",onClick:()=>m(!d),title:d?"Hide Error Doctor":"Show Error Doctor",children:d?"\u2212":"+"})]})]}),d&&(0,c.jsxs)("div",{className:"error-doctor-content",children:[f&&(0,c.jsxs)("div",{className:"success-message",children:[(0,c.jsx)("span",{className:"success-icon",children:"\u2705"}),(0,c.jsxs)("span",{className:"success-text",children:["Applied: ",f]}),(0,c.jsx)("span",{className:"auto-close-notice",children:"(closing in 3s)"})]}),0===i.length?(0,c.jsxs)("div",{className:"no-analyses",children:[(0,c.jsx)("div",{className:"no-analyses-icon",children:"\ud83d\udd0d"}),(0,c.jsxs)("div",{className:"no-analyses-text",children:["Monitoring for errors...",(0,c.jsx)("br",{}),(0,c.jsx)("span",{className:"no-analyses-subtext",children:"I'll automatically analyze any errors that appear in your terminal"})]})]}):(0,c.jsx)("div",{className:"analyses-list",children:i.map((e,r)=>(0,c.jsxs)("div",{className:"analysis-item",children:[(0,c.jsxs)("div",{className:"analysis-header",children:[(0,c.jsxs)("span",{className:"analysis-source",children:[b(e.analysis.source)," ",e.analysis.source]}),(0,c.jsxs)("span",{className:"analysis-confidence",style:{color:w(e.analysis.confidence)},children:[e.analysis.confidence," confidence"]})]}),e.analysis.explanation&&(0,c.jsx)("div",{className:"analysis-explanation",children:e.analysis.explanation}),(0,c.jsx)("div",{className:"fixes-list",children:e.analysis.fixes.map((e,r)=>(0,c.jsxs)("div",{className:"fix-item",children:[(0,c.jsxs)("div",{className:"fix-header",children:[(0,c.jsx)("span",{className:"fix-title",children:e.title}),(0,c.jsx)("span",{className:"fix-confidence",style:{color:w(e.confidence)},children:e.confidence})]}),(0,c.jsx)("div",{className:"fix-description",children:e.description}),e.command&&(0,c.jsx)("div",{className:"fix-command",children:(0,c.jsx)("code",{children:e.command})}),(0,c.jsx)("div",{className:"fix-actions",children:e.command?(0,c.jsx)("button",{className:"apply-fix-btn",onClick:()=>(e=>{n&&t?(g&&(clearTimeout(g),h(null)),console.log("\ud83d\udd27 Error Doctor: Applying fix",e),n.emit("error-doctor:apply-fix",{sessionId:t,fix:e}),s&&s(e)):console.error("Error Doctor: Cannot apply fix - no socket or terminal ID")})(e),title:"Apply this fix automatically",children:"\ud83d\udd27 Apply Fix"}):(0,c.jsx)("span",{className:"manual-fix-note",children:"\u2139\ufe0f Manual intervention required"})})]},r))}),(0,c.jsx)("div",{className:"analysis-timestamp",children:new Date(e.timestamp).toLocaleTimeString()})]},`${e.timestamp}-${r}`))}),i.length>0&&(0,c.jsx)("div",{className:"error-doctor-footer",children:(0,c.jsx)("button",{className:"clear-analyses-btn",onClick:()=>{o([]),v(null),g&&(clearTimeout(g),h(null))},title:"Clear all analyses",children:"\ud83d\uddd1\ufe0f Clear"})})]})]}):null};class g{constructor(e,n){this.queue=[],this.batchTimeout=null,this.config=void 0,this.handler=void 0,this.messageCount=0,this.handler=e,this.config={maxBatchSize:10,batchTimeoutMs:50,highPriorityTimeoutMs:10,maxQueueSize:1e3,...n}}addMessage(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"medium";this.queue.length>=this.config.maxQueueSize&&(console.warn("WebSocket batch queue full, dropping oldest messages"),this.queue=this.queue.slice(1-this.config.maxQueueSize));const r={id:`msg_${this.messageCount++}_${Date.now()}`,event:e,data:n,timestamp:Date.now(),priority:t};this.queue.push(r),"high"===t?this.scheduleFlush(this.config.highPriorityTimeoutMs):this.scheduleFlush(this.config.batchTimeoutMs),this.queue.length>=this.config.maxBatchSize&&this.flush()}scheduleFlush(e){this.batchTimeout||(this.batchTimeout=setTimeout(()=>{this.flush()},e))}flush(){if(this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null),0===this.queue.length)return;const e=[...this.queue].sort((e,n)=>{const t={high:0,medium:1,low:2},r=t[e.priority]-t[n.priority];return 0!==r?r:e.timestamp-n.timestamp});this.queue=[];try{this.handler(e)}catch(n){console.error("Error handling batched messages:",n)}}forceFlush(){this.flush()}getQueueSize(){return this.queue.length}destroy(){this.flush(),this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null),this.queue=[]}}class h extends g{constructor(e){super(n=>{const t=new Map;n.forEach(e=>{t.has(e.event)||t.set(e.event,[]),t.get(e.event).push(e.data)}),t.forEach((n,t)=>{if("terminal:input"===t&&n.length>1){const r=n.join("");e(t,{data:r})}else n.forEach(n=>e(t,n))})},{maxBatchSize:5,batchTimeoutMs:16,highPriorityTimeoutMs:5,maxQueueSize:500})}}const f=e=>{let{socket:n,enabled:t=!0}=e;const s=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!n||!t)return;return s.current=new h((e,t)=>{n.emit(e,t)}),()=>{s.current&&(s.current.destroy(),s.current=null)}},[n,t]);return{emit:(0,r.useCallback)(function(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"medium";s.current&&t?s.current.addMessage(e,r,i):n&&n.emit(e,r)},[n,t]),forceFlush:(0,r.useCallback)(()=>{s.current&&s.current.forceFlush()},[]),getQueueSize:(0,r.useCallback)(()=>{var e;return(null===(e=s.current)||void 0===e?void 0:e.getQueueSize())||0},[])}};var v=t(4650);const w=e=>{let{thinkingMode:n="normal",onThinkingModeChange:d,onTerminalDataChange:m}=e;const[g,h]=(0,r.useState)(!1),[w,b]=(0,r.useState)(!1),[x,y]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),[E,C]=(0,r.useState)(!1),[T,I]=(0,r.useState)(!1),[j,N]=(0,r.useState)(null),[A,U]=(0,r.useState)(!1),D=(0,v.Fb)(()=>{Y.current&&(Y.current.dispose(),Y.current=null),K.current&&(K.current=null),X.current&&(X.current.disconnect(),X.current=null)},{componentName:"Terminal",priority:"high"}),[M,$]=(0,r.useState)(!1),[P,R]=(0,r.useState)(null),[G,L]=(0,r.useState)(null),[B,O]=(0,r.useState)({x:0,y:0}),[z,F]=(0,r.useState)(new Map),[W,q]=(0,r.useState)(""),[H,_]=(0,r.useState)([]),[V,Q]=(0,r.useState)(""),J=(0,r.useRef)(null),Y=(0,r.useRef)(null),X=(0,r.useRef)(null),K=(0,r.useRef)(null),Z=(0,r.useRef)(""),{emit:ee,forceFlush:ne,getQueueSize:te}=f({socket:X.current,enabled:!0}),re=(0,r.useCallback)((e,n)=>{console.log("\ud83c\udfaf Tooltip mouse enter for button:",e);const t=n.currentTarget.getBoundingClientRect();O({x:t.left+t.width/2,y:t.bottom+10}),L(e),console.log("\ud83c\udfaf Tooltip state set:",e,"Position:",{x:t.left+t.width/2,y:t.bottom+10})},[]),se=(0,r.useCallback)(()=>{console.log("\ud83c\udfaf Tooltip mouse leave"),L(null)},[]),ie=(0,r.useCallback)(e=>{switch(e){case"emergency-stop":return"Stop all AI agents immediately";case"supervision":return w?"Stop AI supervision":"AI monitors and guides your work";case"parallel-agents":return x?"Stop parallel agents":"Run 3 AI agents simultaneously";case"infinite-loop":return k?"Stop iterative improvements":"AI improves solution iteratively";case"hivemind":return E?"Disconnect AI team":"Connect AI agents for teamwork";default:return""}},[w,x,k,E]),oe=(0,r.useCallback)(()=>{console.log("\ud83d\udd0c Connecting to backend...");const e="localhost"===window.location.hostname?"http://localhost:3000":`http://${window.location.hostname}:3000`;console.log("\ud83d\udd0c Socket URL:",e);const n=(0,a.io)(e,{transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4});return X.current=n,n.on("connect",()=>{var e,n;console.log("\u2705 Connected to backend Socket.IO server"),h(!0),Z.current=`terminal-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ee("terminal:create",{id:Z.current,cols:(null===(e=Y.current)||void 0===e?void 0:e.cols)||80,rows:(null===(n=Y.current)||void 0===n?void 0:n.rows)||24},"high")}),n.on("terminal:created",e=>{if(console.log("\u2705 Terminal session created:",e),Y.current){Y.current.clear(),Y.current.writeln("\x1b[32m\u2705 Connected to terminal server\x1b[0m"),Y.current.writeln("");const e=sessionStorage.getItem("prd-initial-prompt");e&&(Y.current.writeln("\x1b[36m\ud83d\udccb PRD loaded successfully! Here's a suggested starting prompt:\x1b[0m"),Y.current.writeln(""),Y.current.writeln("\x1b[33m"+e+"\x1b[0m"),Y.current.writeln(""),Y.current.writeln("\x1b[90m(Copy and paste the above prompt to get started, or type your own command)\x1b[0m"),Y.current.writeln(""),sessionStorage.removeItem("prd-initial-prompt"))}}),n.on("terminal:data",e=>{Y.current&&e.id===Z.current&&(Y.current.write(e.data),Q(n=>(n+e.data).slice(-5e3)))}),n.on("terminal:error",e=>{console.error("\u274c Terminal error:",e),Y.current&&Y.current.writeln(`\r\n\x1b[31m\u274c Error: ${e.message}\x1b[0m\r\n`)}),n.on("terminal:exit",e=>{console.log("Terminal exited:",e),Y.current&&Y.current.writeln(`\r\n\x1b[33m\u26a0\ufe0f Terminal session ended (exit code: ${e.exitCode})\x1b[0m`)}),n.on("thinking-start",e=>{let{mode:n,config:t}=e;if(console.log("\ud83e\udde0 Thinking started:",n,t),$(!0),R(n),Y.current&&t){const e=Math.round(t.timeout/1e3),n=`\r\n\x1b[33m${t.icon} ${t.displayName} mode activated\x1b[0m\r\n`,r=`\x1b[36m${t.description} (~${e}s)\x1b[0m\r\n`,s=`\x1b[90m${"\u2501".repeat(50)}\x1b[0m\r\n`;Y.current.write(n),Y.current.write(r),Y.current.write(s)}}),n.on("thinking-complete",e=>{let{mode:n,error:t}=e;if(console.log("\u2705 Thinking complete:",n,t?"with error":"success"),$(!1),Y.current&&!t){const e=`\x1b[32m\u2713 ${n} analysis complete\x1b[0m\r\n`,t=`\x1b[90m${"\u2501".repeat(50)}\x1b[0m\r\n`;Y.current.write(e),Y.current.write(t)}else if(Y.current&&t){const e=`\x1b[31m\u2717 ${n} analysis failed\x1b[0m\r\n`;Y.current.write(e)}R(null)}),n.on("supervision:suggestion",e=>{console.log("\ud83d\udcdd Supervision suggestion received:",e),Y.current&&(Y.current.writeln("\r\n\x1b[36m\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\x1b[0m"),Y.current.writeln(`\x1b[33m\ud83d\udca1 ${e.message}\x1b[0m`),Y.current.writeln(`\x1b[32m${e.suggestion}\x1b[0m`),Y.current.writeln("\x1b[36m\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\x1b[0m\r\n"))}),n.on("claude:output",e=>{let{sessionId:n,data:t}=e;Y.current&&Y.current.write(t)}),n.on("claude:sessionComplete",e=>{let{sessionId:n,duration:t}=e;Y.current&&Y.current.writeln(`\r\n\x1b[32m\u2705 Session completed in ${(t/1e3).toFixed(2)}s\x1b[0m\r\n`),F(e=>{const t=new Map(e),r=e.get(n);return"parallel"===r?y(!1):"supervision"===r?b(!1):"infinite"===r&&(S(!1),N(null)),t.delete(n),t})}),n.on("claude:error",e=>{let{message:n}=e;Y.current&&Y.current.writeln(`\r\n\x1b[31m\u274c Claude Error: ${n}\x1b[0m\r\n`)}),n.on("disconnect",()=>{console.log("\u274c Disconnected from backend"),h(!1),Y.current&&Y.current.writeln("\r\n\x1b[31m\u274c Disconnected from server\x1b[0m")}),n.on("connect_error",e=>{console.error("Connection error:",e),Y.current&&Y.current.writeln("\r\n\x1b[31m\u274c Connection failed. Make sure backend is running on port 3000\x1b[0m")}),n},[]);(0,r.useEffect)(()=>{(async()=>{if(!J.current||Y.current)return;const e=new i.Terminal({theme:{background:"#1a1b26",foreground:"#c0caf5",cursor:"#c0caf5",black:"#15161e",red:"#f7768e",green:"#9ece6a",yellow:"#e0af68",blue:"#7aa2f7",magenta:"#bb9af7",cyan:"#7dcfff",white:"#a9b1d6",brightBlack:"#414868",brightRed:"#f7768e",brightGreen:"#9ece6a",brightYellow:"#e0af68",brightBlue:"#7aa2f7",brightMagenta:"#bb9af7",brightCyan:"#7dcfff",brightWhite:"#c0caf5"},fontFamily:'Monaco, Menlo, "Courier New", monospace',fontSize:14,lineHeight:1.5,cursorBlink:!0,allowTransparency:!1,convertEol:!0,screenReaderMode:!1,macOptionIsMeta:!0,rightClickSelectsWord:!0,rows:24,cols:80}),n=new o.FitAddon;e.loadAddon(n),e.open(J.current),Y.current=e,K.current=n,setTimeout(()=>{n.fit(),e.clear(),e.writeln("\x1b[1;36mCoder1 Terminal v2\x1b[0m"),e.writeln("\x1b[2m\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\x1b[0m"),e.writeln(""),e.writeln("\x1b[33m\u26a1 Connecting to terminal server...\x1b[0m"),e.writeln(""),e.focus()},100),oe();const t=()=>{n&&n.fit()};window.addEventListener("resize",t);const r=new ResizeObserver(()=>{n&&setTimeout(()=>{n.fit()},10)});J.current&&r.observe(J.current)})()},[oe]),(0,r.useEffect)(()=>{if(!Y.current||!X.current)return;const e=Y.current,r=X.current;let i="";window.currentCommandBuffer=i;const o=e.onData(o=>{if(Z.current&&r.connected)if("\x7f"===o){i=i.slice(0,-1),window.currentCommandBuffer=i;const t=i.trim(),r="/ui"===t||t.startsWith("/ui")||"/u"===t||"/"===t,s="/agent"===t||t.startsWith("/agent")||"/a"===t||"/ag"===t;t.startsWith("/")&&(t.startsWith("/help")||t.startsWith("/clear")||t.startsWith("/status")||t.startsWith("/config")||t.startsWith("/cost")||t.startsWith("/model")||t.startsWith("/init")||t.startsWith("/review")||t.startsWith("/doctor")||r||s)?e.write("\b \b"):ee("terminal:data",{id:Z.current,data:o,thinkingMode:n},"medium")}else if("\r"===o||"\n"===o){const a=i.trim();if("/agent"===a||a.startsWith("/agent ")){const n="/agent"===a?"":a.substring(7),t=n?n.split(" "):[],r=t[0]||"help",o=t.slice(1);switch(console.log("Agent command detected:",{agentName:r,agentArgs:o}),r){case"help":const n='\nAvailable /agent commands:\n\n/agent product-manager <task>    - Use Product Manager agent\n/agent ux-designer <task>        - Use UX/UI Designer agent  \n/agent devops-engineer <task>    - Use DevOps Engineer agent\n/agent architecture <task>       - Use Software Architect agent\n/agent frontend-engineer <task>  - Use Frontend Engineer agent\n/agent backend-engineer <task>   - Use Backend Engineer agent\n/agent qa-testing <task>         - Use QA Testing Engineer agent\n/agent security-analyst <task>   - Use Security Analyst agent\n/agent list                      - List all available agents\n/agent help                      - Show this help message\n\nExamples:\n  /agent product-manager "Analyze requirements for a task management app"\n  /agent security-analyst "Review authentication implementation"\n  /agent architecture "Design scalable microservices architecture"\n';e.write("\r\n"+n+"\r\n");break;case"list":const t="\n\ud83e\udd16 Available Specialized Agents:\n\n1. \ud83d\udccb Product Manager - Transforms ideas into concrete MVP requirements\n2. \ud83c\udfa8 UX/UI Designer - Creates design systems and user experience flows  \n3. \ud83d\ude80 DevOps Engineer - Automates deployment and manages infrastructure\n4. \ud83c\udfd7\ufe0f Software Architect - Designs system architecture and technology decisions\n5. \u269b\ufe0f Frontend Engineer - Builds user interfaces and client-side functionality\n6. \ud83d\udd27 Backend Engineer - Develops APIs, databases, and server-side logic\n7. \u2705 QA Testing Engineer - Creates testing strategies and quality assurance\n8. \ud83d\udee1\ufe0f Security Analyst - Identifies vulnerabilities and security best practices\n\nUsage: /agent <agent-name> <your-task-description>\n";e.write("\r\n"+t+"\r\n");break;case"product-manager":case"ux-designer":case"devops-engineer":case"architecture":case"frontend-engineer":case"backend-engineer":case"qa-testing":case"security-analyst":if(0===o.length){e.write("\r\n\x1b[31mError: Task description required\x1b[0m\r\n"),e.write(`\x1b[33mUsage: /agent ${r} <task-description>\x1b[0m\r\n`);break}const i=o.join(" ");if(!i.trim()){e.write("\r\n\x1b[31mError: Task description cannot be empty\x1b[0m\r\n");break}e.write(`\r\n\ud83e\udd16 Executing ${r.replace("-"," ")} agent...\r\n`),e.write(`\ud83d\udccb Task: "${i}"\r\n`),e.write("\x1b[33m\u23f3 Processing request...\x1b[0m\r\n"),(0,s.Ud)("/api/agent/execute",{method:"POST",body:JSON.stringify({agent:r,prompt:i,context:{sessionId:Z.current}})}).then(async n=>{if(n.ok){const t=await n.json();e.write(`\r\n\x1b[32m\u2705 ${t.agent} execution completed!\x1b[0m\r\n`),e.write(`\r\n\x1b[36m\ud83d\udccb Analysis:\x1b[0m\r\n${t.result.analysis}\r\n`),t.result.recommendations&&t.result.recommendations.length>0&&(e.write("\r\n\x1b[36m\ud83d\udca1 Recommendations:\x1b[0m\r\n"),t.result.recommendations.forEach((n,t)=>{e.write(`  ${t+1}. ${n}\r\n`)})),t.result.nextSteps&&t.result.nextSteps.length>0&&(e.write("\r\n\x1b[36m\ud83d\udccb Next Steps:\x1b[0m\r\n"),t.result.nextSteps.forEach((n,t)=>{e.write(`  ${t+1}. ${n}\r\n`)})),e.write(`\r\n\x1b[90m\u23f1\ufe0f ${t.result.metadata.processingTime}\x1b[0m\r\n`)}else{const t=await n.json();e.write(`\r\n\x1b[31m\u274c Agent execution failed: ${t.error}\x1b[0m\r\n`)}}).catch(n=>{e.write(`\r\n\x1b[31m\u274c Network error: ${n.message}\x1b[0m\r\n`)});break;default:e.write(`\r\nUnknown agent: ${r}\r\n`),e.write("\x1b[33mUse '/agent help' or '/agent list' for available agents\x1b[0m\r\n")}return i="",void e.write("\r\n")}if("/ui"===a||a.startsWith("/ui ")){const n="/ui"===a?"":a.substring(4),r=n?n.split(" "):[],s=r[0]||"help",o=r.slice(1);switch(console.log("UI command detected:",{subcommand:s,args:o}),s){case"create":if(0===o.length){e.write("\r\n\x1b[31mError: Component description required\x1b[0m\r\n"),e.write("\x1b[33mUsage: /ui create <description>\x1b[0m\r\n");break}const n=o.join(" ");if(!n.trim()){e.write("\r\n\x1b[31mError: Component description cannot be empty\x1b[0m\r\n");break}e.write(`\r\n\ud83c\udfa8 Generating component: "${n}"\r\n`),t.e(179).then(t.bind(t,4179)).then(t=>{let{generateBasicComponent:r}=t;r(n).then(n=>{e.write("\x1b[32m\u2705 Component generated successfully!\x1b[0m\r\n"),e.write(`\ud83d\udcc1 Component: ${n.name}\r\n`),e.write(`\ud83d\udd27 Props: ${Object.keys(n.props).join(", ")}\r\n`),console.log("Terminal: Sending UI_COMPONENT_GENERATED message with component:",n),window.postMessage({type:"UI_COMPONENT_GENERATED",component:n},"*"),console.log("Terminal: UI_COMPONENT_GENERATED message sent")}).catch(n=>{e.write(`\r\n\x1b[31mError: Component generation failed - ${n.message}\x1b[0m\r\n`)})}).catch(n=>{e.write(`\r\n\x1b[31mError: Failed to load ComponentGenerator - ${n.message}\x1b[0m\r\n`)});break;case"help":let r="";r="create"===o[0]?'\n/ui create <description> - Generate component from description\n\nExamples:\n  /ui create "button with hover effects"\n  /ui create "responsive card layout"\n  /ui create "modern pricing table"\n\nAvailable component types:\n  - button, card, input, alert\n  - Supports size variants: small, medium, large\n  - Supports style variants: primary, secondary, danger\n':'\nAvailable /ui commands:\n\n/ui create <description>  - Generate component from description\n/ui help [command]        - Show help information  \n/ui version              - Show version information\n\nExamples:\n  /ui create "button with hover effects"\n  /ui create "responsive card layout"\n',e.write("\r\n"+r+"\r\n");break;case"version":const i="\nCoder1 Preview Enhancement v1.0.0\nPhase: 1 (Basic Functionality)\nStatus: Active\nFeatures: Component Generation, Live Preview\n";e.write("\r\n"+i+"\r\n");break;default:e.write(`\r\nUnknown UI command: ${s}\r\n`),e.write("\x1b[33mUse '/ui help' for available commands\x1b[0m\r\n")}return i="",void e.write("\r\n")}if(a.startsWith("/")){const t=a.substring(1).split(" "),s=t[0];t.slice(1);switch(s){case"help":const t='\n\ud83d\ude80 Coder1 IDE Terminal - Available Commands\n\n\ud83d\udccb Claude Code Standard Commands:\n/help                    - Show this help message\n/clear                   - Clear the terminal screen  \n/status                  - Show system status\n/config                  - View configuration\n/cost                    - Show token usage (placeholder)\n/model                   - Show current AI model\n/init                    - Initialize project (placeholder)\n/review                  - Request code review (placeholder)\n/doctor                  - Check system health\n\n\ud83c\udfa8 UI Generation Commands:\n/ui create <description> - Generate UI components\n/ui help                 - Show UI command help\n/ui version             - Show UI generator version\n\n\ud83e\udd16 Specialized Agent Commands:\n/agent list             - List all available agents\n/agent help             - Show agent command help\n/agent <name> <task>    - Execute specialized agent\n\nExamples:\n  /help\n  /clear\n  /ui create "responsive button"\n  /agent product-manager "Analyze app requirements"\n  /agent security-analyst "Review authentication"\n\n\ud83d\udca1 Pro tip: Use regular bash/shell commands for system operations!\n';e.write(t+"\r\n");break;case"clear":e.clear(),e.write("\x1b[32mCoder1 IDE Terminal - Ready\x1b[0m\r\n"),e.write("\x1b[36mType /help for available commands\x1b[0m\r\n\r\n");break;case"status":const c="\n\ud83c\udfaf Coder1 IDE Status Report\n\nSystem Status: \x1b[32m\u2705 Online\x1b[0m\nTerminal: \x1b[32m\u2705 Connected\x1b[0m  \nAgents: \x1b[32m\u2705 8 Specialized Agents Available\x1b[0m\nUI Generator: \x1b[32m\u2705 Active\x1b[0m\n\nAvailable Commands:\n\u2022 21 Claude Code commands\n\u2022 3 UI generation commands  \n\u2022 10 Specialized agent commands\n\nType /help for full command list\n";e.write(c+"\r\n");break;case"config":const l="\n\u2699\ufe0f Coder1 IDE Configuration\n\nFramework: React + Express.js\nAI Models: Claude 3.5 Sonnet (Agents)\nTerminal: xterm.js with Socket.IO\nUI Generator: Custom component templates\nAgent Framework: 8 specialized roles\n\nEnvironment: Development\nVersion: 2.0.0 (Agent Framework)\n";e.write(l+"\r\n");break;case"cost":const d="\n\ud83d\udcb0 Token Usage Report\n\nTotal Requests: 12 (session)\nEstimated Cost: $0.03 (placeholder)\nAgent Executions: 3\nUI Generations: 1\n\nNote: Actual costs depend on AI service integration\n";e.write(d+"\r\n");break;case"model":const m="\n\ud83e\udde0 AI Model Configuration\n\nCurrent Model: Claude 3.5 Sonnet (20241022)\nAgent Templates: 8 specialized configurations\nUI Generator: Custom template system\nFallback: Placeholder responses (development)\n\nAll agents configured with:\n\u2022 Specific tools and capabilities\n\u2022 Structured output formats\n\u2022 Domain expertise instructions\n";e.write(m+"\r\n");break;case"init":const u="\n\ud83d\ude80 Project Initialization\n\nCreating CLAUDE.md file with project context...\nSetting up agent configurations...\nConfiguring UI generator templates...\n\n\u2705 Project initialized with Coder1 IDE framework\n\ud83d\udccb 8 specialized agents ready\n\ud83c\udfa8 UI component generator active\n\nType /agent list to see available agents\nType /ui help for UI generation commands\n";e.write(u+"\r\n");break;case"review":const p="\n\ud83d\udcdd Code Review Request\n\nAnalyzing current codebase...\nRunning specialized agents for review...\n\n\ud83d\udd0d Architecture Review: In Progress...\n\ud83d\udee1\ufe0f Security Analysis: In Progress...\n\u2705 QA Testing Review: In Progress...\n\nResults will be displayed as agents complete their analysis.\nUse /agent security-analyst or /agent qa-testing for specific reviews.\n";e.write(p+"\r\n");break;case"doctor":const g=`\n\ud83c\udfe5 System Health Check\n\nChecking Coder1 IDE installation...\n\n\u2705 Node.js Runtime: v${process.version||"Unknown"}\n\u2705 Terminal Connection: Active\n\u2705 Socket.IO: Connected\n\u2705 Agent Framework: 8/8 Agents Loaded\n\u2705 UI Generator: Active\n\u2705 API Endpoints: Responding\n\n\ud83d\udd27 Agent Configuration:\n\u2022 Product Manager: \u2705 Loaded\n\u2022 UX/UI Designer: \u2705 Loaded  \n\u2022 DevOps Engineer: \u2705 Loaded\n\u2022 Software Architect: \u2705 Loaded\n\u2022 Frontend Engineer: \u2705 Loaded\n\u2022 Backend Engineer: \u2705 Loaded\n\u2022 QA Testing: \u2705 Loaded\n\u2022 Security Analyst: \u2705 Loaded\n\nAll systems operational! \ud83c\udf89\n`;e.write(g+"\r\n");break;default:if(!["ui","agent"].includes(s))return r.emit("terminal:data",{id:Z.current,data:o,thinkingMode:n}),a&&q(a),void(i="")}return i="",void e.write("\r\n")}ee("terminal:data",{id:Z.current,data:o,thinkingMode:n},"high"),a&&(q(a),_(e=>[...e.slice(-19),a])),i="",window.currentCommandBuffer=i}else if(o.charCodeAt(0)>=32){i+=o,window.currentCommandBuffer=i;const t=i.trim(),r="/ui"===t||t.startsWith("/ui "),s="/agent"===t||t.startsWith("/agent ");t.startsWith("/")&&(t.startsWith("/help")||t.startsWith("/clear")||t.startsWith("/status")||t.startsWith("/config")||t.startsWith("/cost")||t.startsWith("/model")||t.startsWith("/init")||t.startsWith("/review")||t.startsWith("/doctor")||r||s)?e.write(o):ee("terminal:data",{id:Z.current,data:o,thinkingMode:n},"low")}else r.emit("terminal:data",{id:Z.current,data:o,thinkingMode:n})});return()=>{o.dispose()}},[g]),(0,r.useEffect)(()=>{if(!Y.current||!X.current||!K.current)return;const e=Y.current,n=X.current;K.current;let t;const r=e.onResize(e=>{let{cols:r,rows:s}=e;clearTimeout(t),t=setTimeout(()=>{Z.current&&n.connected&&ee("terminal:resize",{id:Z.current,cols:r,rows:s},"medium")},100)});return()=>{clearTimeout(t),r.dispose()}},[g]);const ae=()=>{const e=window.currentCommandBuffer||"";return e&&e.trim()?e.trim():W||"Help me build a modern web application with best practices"},ce=(0,r.useCallback)(()=>{if(Y.current)try{const e=Y.current.buffer.active;let n="";const t=Math.max(0,e.length-100),r=e.length;for(let s=t;s<r;s++){const t=e.getLine(s);t&&(n+=t.translateToString(!0)+"\n")}return n.trim()}catch(e){return console.warn("Failed to extract terminal history:",e),V}return V},[V]);(0,r.useEffect)(()=>{if(m){const e={terminalHistory:ce(),terminalCommands:H.slice(-20)};m(e)}},[H,V,m,ce]);const le=e=>{Y.current&&Y.current.write(e)},de=(0,r.useCallback)(e=>{if(X.current&&Z.current){if(X.current.connected){const n=e.endsWith("\r")?e:e+"\r";X.current.emit("terminal:data",{id:Z.current,data:n}),le(`\r\n\x1b[36m[Voice Command]\x1b[0m ${n.replace("\r","")}\r\n`)}}else console.warn("Cannot send voice command: no connection")},[]),me=((0,r.useCallback)(e=>{switch(le(`\r\n\x1b[35m\ud83c\udfa4 Voice: "${e}"\x1b[0m\r\n`),!0){case e.toLowerCase().includes("run claude"):le("\x1b[32m\ud83d\ude80 Executing: claude\x1b[0m\r\n"),de("claude\r");break;case e.toLowerCase().startsWith("type "):const n=e.substring(5);le(`\x1b[32m\u26a1 Executing: ${e}\x1b[0m\r\n`),de(n+"\r");break;case"clear"===e.toLowerCase():Y.current&&(Y.current.clear(),le("\x1b[32m\u2728 Terminal cleared via voice command\x1b[0m\r\n\r\n"));break;case"help"===e.toLowerCase():le("\x1b[36m\ud83d\udccb Voice Commands Help:\x1b[0m\r\n"),le('\u2022 "run claude" - Launch Claude Code CLI\r\n'),le('\u2022 "type [command]" - Execute any terminal command\r\n'),le('\u2022 "clear" - Clear terminal screen\r\n'),le('\u2022 "sleep mode" - Toggle sleep mode\r\n'),le('\u2022 "supervision" - Toggle supervision mode\r\n'),le('\u2022 "parallel agents" - Toggle parallel agents\r\n'),le('\u2022 "infinite loop" - Toggle infinite loop mode\r\n'),le('\u2022 "hivemind" - Activate hivemind collaboration\r\n\r\n');break;case e.toLowerCase().includes("emergency stop"):he();break;case e.toLowerCase().includes("supervision"):le("\x1b[33m\ud83d\udc41\ufe0f Toggling supervision mode...\x1b[0m\r\n");break;case e.toLowerCase().includes("parallel agents"):le("\x1b[36m\ud83e\udd16 Toggling parallel agents...\x1b[0m\r\n");break;case e.toLowerCase().includes("infinite loop"):le("\x1b[33m\u267e\ufe0f Toggling infinite loop...\x1b[0m\r\n");break;case e.toLowerCase().includes("hivemind"):le("\x1b[36m\ud83e\udde0 Activating hivemind...\x1b[0m\r\n");break;default:le(`\x1b[31m\u2753 Unknown voice command: ${e}\x1b[0m\r\n`),le('\x1b[33m\ud83d\udca1 Say "help" for available commands\x1b[0m\r\n\r\n')}},[g]),async()=>{console.log("\ud83d\udd35 [DEBUG] handleSupervisionToggle called"),console.log("\ud83d\udd35 [DEBUG] Current isSupervisionOn state:",w);try{if(w){console.log("\ud83d\udd35 [DEBUG] Stopping supervision mode..."),b(!1),le("\r\n\x1b[32m\u23f9\ufe0f Supervision mode deactivated\x1b[0m\r\n\r\n");const e=Array.from(z.entries());for(const[n,r]of e)if("supervision"===r)try{await(0,s.Ud)("/api/claude/session/stop",{method:"POST",body:JSON.stringify({sessionId:n})})}catch(t){console.error("Error stopping session:",t)}}else{var e;console.log("\ud83d\udd35 [DEBUG] Starting supervision mode...");const t=ae(),i=`supervision-${Date.now()}`;console.log("\ud83d\udd35 [DEBUG] Generated prompt:",t),console.log("\ud83d\udd35 [DEBUG] Generated sessionId:",i),le("\r\n\x1b[33m\ud83d\udc41\ufe0f Starting Supervision mode...\x1b[0m\r\n"),console.log("\ud83d\udd35 [DEBUG] Socket ref exists?",!!X.current),console.log("\ud83d\udd35 [DEBUG] Socket connected?",null===(e=X.current)||void 0===e?void 0:e.connected),X.current&&X.current.connected&&(console.log("\ud83d\udd35 [DEBUG] Emitting claude:button event"),X.current.emit("claude:button",{action:"supervision",prompt:t,sessionId:i})),console.log("\ud83d\udd35 [DEBUG] About to call authenticatedFetch..."),console.log("\ud83d\udd35 [DEBUG] authenticatedFetch function exists?",typeof s.Ud);const o=await(0,s.Ud)("/api/claude/supervision/start",{method:"POST",body:JSON.stringify({prompt:t,sessionId:i,explicit:!0})});if(console.log("\ud83d\udd35 [DEBUG] Response received:",o),console.log("\ud83d\udd35 [DEBUG] Response status:",o.status),console.log("\ud83d\udd35 [DEBUG] Response ok?",o.ok),o.ok){var n;const e=await o.json();console.log("\ud83d\udd35 [DEBUG] Supervision API response data:",e);const t=(null===(n=e.sessionId)||void 0===n?void 0:n.sessionId)||i;console.log("\ud83d\udd35 [DEBUG] Extracted actualSessionId:",t),console.log("\ud83d\udd35 [DEBUG] Updating claudeSessions state..."),F(e=>new Map(e).set(t,"supervision")),console.log("\ud83d\udd35 [DEBUG] Setting isSupervisionOn to true..."),b(!0),X.current&&X.current.connected&&(console.log("\ud83d\udd35 [DEBUG] Emitting claude:register event"),X.current.emit("claude:register",{sessionId:t}),console.log("\ud83d\udd35 [DEBUG] Emitting supervision:start for PTY integration"),console.log("\ud83d\udd35 [DEBUG] Using sessionId:",t),console.log("\ud83d\udd35 [DEBUG] Terminal session ID:",Z.current),X.current.emit("supervision:start",{sessionId:t,terminalId:Z.current,mode:"auto"}),X.current.once("supervision:started",e=>{console.log("\u2705 [DEBUG] PTY Supervision confirmed started:",e),le("\x1b[32m\u2713 PTY Supervision active\x1b[0m\r\n")}),X.current.once("supervision:error",e=>{console.log("\ud83d\udd34 [DEBUG] PTY Supervision error:",e),le(`\x1b[33m\u26a0 PTY Supervision warning: ${e.message}\x1b[0m\r\n`)})),le(`\x1b[36mSession ID: ${t}\x1b[0m\r\n`),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n"),le("\x1b[35m\ud83d\udc41 Supervision Mode Active\x1b[0m\r\n"),le("\x1b[33m\u2022 All Claude tool calls will be displayed\x1b[0m\r\n"),le("\x1b[33m\u2022 Verbose output shows reasoning process\x1b[0m\r\n"),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n\r\n")}else{console.log("\ud83d\udd34 [DEBUG] Response not OK!"),console.log("\ud83d\udd34 [DEBUG] Response status:",o.status);let e="Unknown error";try{const n=await o.json();console.log("\ud83d\udd34 [DEBUG] Error response:",n),e=n.error||n.message||"Failed to start supervision"}catch(r){console.log("\ud83d\udd34 [DEBUG] Failed to parse error response:",r)}le(`\x1b[31m\u274c Failed to start supervision: ${e}\x1b[0m\r\n\r\n`)}}}catch(i){console.error("\ud83d\udd34 [DEBUG] CAUGHT ERROR in handleSupervisionToggle:",i),console.error("\ud83d\udd34 [DEBUG] Error type:",typeof i),console.error("\ud83d\udd34 [DEBUG] Error stack:",null===i||void 0===i?void 0:i.stack),console.error("\ud83d\udd34 [DEBUG] Error message:",null===i||void 0===i?void 0:i.message),le(`\r\n\x1b[31m\u274c Error: ${i}\x1b[0m\r\n\r\n`)}}),ue=async()=>{try{if(x){y(!1),le("\r\n\x1b[32m\u23f9\ufe0f Parallel Agents mode deactivated\x1b[0m\r\n\r\n");const e=Array.from(z.entries());for(const[t,r]of e)if("parallel"===r)try{await(0,s.Ud)("/api/claude/session/stop",{method:"POST",body:JSON.stringify({sessionId:t})})}catch(n){console.error("Error stopping session:",n)}}else{var e;const n=ae();if("Help me build a modern web application with best practices"===n)return le('\r\n\x1b[33m\u26a0\ufe0f  Workflow Tip: Type "claude" first, then click Parallel Agents\x1b[0m\r\n'),void le("\x1b[36m\ud83d\udca1 This ensures proper sub-agent delegation within your Claude session\x1b[0m\r\n\r\n");const t=`parallel-${Date.now()}`;console.log("\ud83d\udcdd Prompt:",n),console.log("\ud83c\udd94 Session ID:",t),console.log("\ud83d\udd0c Socket connected:",null===(e=X.current)||void 0===e?void 0:e.connected),le("\r\n\x1b[36m\ud83e\udd16 Starting Parallel Agents...\x1b[0m\r\n"),X.current&&X.current.connected&&X.current.emit("claude:button",{action:"parallel",prompt:n,sessionId:t}),X.current&&X.current.connected&&(console.log("\ud83d\udce1 Registering socket for session:",t),X.current.emit("claude:register",{sessionId:t})),await new Promise(e=>setTimeout(e,100)),console.log("\ud83d\ude80 Calling API: /api/claude/parallel/start");const r=await(0,s.Ud)("/api/claude/parallel/start",{method:"POST",body:JSON.stringify({prompt:n,sessionId:t})});if(console.log("\ud83d\udce8 API Response:",r.status,r.ok),r.ok){const e=await r.json();F(n=>new Map(n).set(e.sessionId,"parallel")),y(!0),le(`\x1b[36mSession ID: ${e.sessionId}\x1b[0m\r\n`),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n"),le("\x1b[35m\ud83e\udd16 Parallel Agents Active (3 agents)\x1b[0m\r\n"),le("\x1b[36m  \u2022 Agent 1 - Architect: System design and structure\x1b[0m\r\n"),le("\x1b[36m  \u2022 Agent 2 - Implementer: Core implementation\x1b[0m\r\n"),le("\x1b[36m  \u2022 Agent 3 - Optimizer: Performance and best practices\x1b[0m\r\n"),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n\r\n"),le("\x1b[33mAgents are working on your task...\x1b[0m\r\n\r\n")}else{const e=await r.json();le(`\x1b[31m\u274c Failed to start parallel agents: ${e.error}\x1b[0m\r\n\r\n`)}}}catch(t){console.error("Parallel agents toggle error:",t),le(`\r\n\x1b[31m\u274c Error: ${t}\x1b[0m\r\n\r\n`)}},pe=async()=>{try{if(k){if(j){U(!0),le("\r\n\x1b[33m\u23f3 Stopping infinite loop...\x1b[0m\r\n");try{(await(0,s.Ud)("/api/claude/session/stop",{method:"POST",body:JSON.stringify({sessionId:j})})).ok?le("\r\n\x1b[32m\u2705 Infinite Loop stopped successfully\x1b[0m\r\n\r\n"):le("\r\n\x1b[33m\u26a0\ufe0f Infinite Loop stop request sent\x1b[0m\r\n\r\n")}catch(e){console.error("Error stopping infinite loop:",e),le("\r\n\x1b[33m\u26a0\ufe0f Could not confirm stop status\x1b[0m\r\n\r\n")}finally{U(!1),N(null),F(e=>{const n=new Map(e);return j&&n.delete(j),n})}}S(!1),le("\r\n\x1b[32m\u23f9\ufe0f Infinite Loop mode deactivated\x1b[0m\r\n\r\n")}else{const e=ae(),n=`infinite-${Date.now()}`;le("\r\n\x1b[33m\u267e\ufe0f Starting Infinite Loop mode...\x1b[0m\r\n"),X.current&&X.current.connected&&X.current.emit("claude:button",{action:"infinite",prompt:e,sessionId:n});const t=await(0,s.Ud)("/api/claude/infinite/start",{method:"POST",body:JSON.stringify({prompt:e,sessionId:n})});if(t.ok){const e=await t.json();N(e.sessionId),F(n=>new Map(n).set(e.sessionId,"infinite")),S(!0),X.current&&X.current.connected&&X.current.emit("claude:register",{sessionId:e.sessionId}),le(`\x1b[36mSession ID: ${e.sessionId}\x1b[0m\r\n`),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n"),le("\x1b[35m\u267e\ufe0f Infinite Loop Mode Active\x1b[0m\r\n"),le("\x1b[33m\u2022 Claude will iteratively improve the solution\x1b[0m\r\n"),le("\x1b[33m\u2022 Each iteration builds on the previous one\x1b[0m\r\n"),le('\x1b[33m\u2022 Click "Stop Loop" to end the process\x1b[0m\r\n'),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n\r\n")}else{const e=await t.json();le(`\x1b[31m\u274c Failed to start infinite loop: ${e.error}\x1b[0m\r\n\r\n`)}}}catch(n){console.error("Infinite loop toggle error:",n),le(`\r\n\x1b[31m\u274c Error: ${n}\x1b[0m\r\n\r\n`)}},ge=async()=>{console.log("\ud83e\udde0 HIVEMIND BUTTON CLICKED!");try{if(E){le("\r\n\x1b[33m\ud83d\uded1 Stopping Hivemind collaboration...\x1b[0m\r\n");const e=Array.from(z.entries()).find(e=>{let[n,t]=e;return"hivemind"===t});if(e){const[n]=e,t=await(0,s.Ud)("/api/claude/hivemind/stop",{method:"POST",body:JSON.stringify({sessionId:n})});if(t.ok)F(e=>{const t=new Map(e);return t.delete(n),t}),C(!1),le("\x1b[32m\u2705 Hivemind collaboration stopped\x1b[0m\r\n\r\n");else{const e=await t.json();le(`\x1b[31m\u274c Failed to stop hivemind: ${e.error}\x1b[0m\r\n\r\n`)}}else C(!1),le("\x1b[33m\u26a0\ufe0f No active hivemind session found\x1b[0m\r\n\r\n")}else{const e=ae(),n=`hivemind-${Date.now()}`;le("\r\n\x1b[36m\ud83e\udde0 Starting Hivemind collaboration...\x1b[0m\r\n"),X.current&&X.current.connected&&X.current.emit("claude:button",{action:"hivemind",prompt:e,sessionId:n});const t=await(0,s.Ud)("/api/claude/hivemind/start",{method:"POST",body:JSON.stringify({prompt:e,sessionId:n})});if(t.ok){const e=await t.json();F(n=>new Map(n).set(e.sessionId,"hivemind")),C(!0),X.current&&X.current.connected&&X.current.emit("claude:register",{sessionId:e.sessionId}),le(`\x1b[36mSession ID: ${e.sessionId}\x1b[0m\r\n`),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n"),le("\x1b[35m\ud83e\udde0 Hivemind Mode Active\x1b[0m\r\n"),le("\x1b[36m\u2022 Phase 1: Architect designs the solution\x1b[0m\r\n"),le("\x1b[36m\u2022 Phase 2: Implementer builds the code\x1b[0m\r\n"),le("\x1b[36m\u2022 Phase 3: Reviewer validates and improves\x1b[0m\r\n"),le("\x1b[35m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\x1b[0m\r\n\r\n")}else{const e=await t.json();le(`\x1b[31m\u274c Failed to start hivemind: ${e.error}\x1b[0m\r\n\r\n`)}}}catch(e){console.error("Hivemind error:",e),le(`\r\n\x1b[31m\u274c Error: ${e}\x1b[0m\r\n\r\n`)}},he=async()=>{try{I(!0),le("\r\n\x1b[31m\ud83d\uded1 EMERGENCY STOP - Terminating all AI operations...\x1b[0m\r\n"),w&&await me(),x&&await ue(),k&&await pe(),E&&await ge(),F(new Map),le("\x1b[32m\u2713 All AI operations have been terminated\x1b[0m\r\n"),le("\x1b[33m\ud83d\udca1 You can restart any AI mode using the buttons above\x1b[0m\r\n\r\n")}catch(e){console.error("Emergency stop error:",e),le(`\r\n\x1b[31m\u274c Error during emergency stop: ${e}\x1b[0m\r\n\r\n`)}finally{I(!1)}};return(0,r.useEffect)(()=>{const e=setInterval(()=>{const e=te();e>5&&(console.warn(`\ud83d\udea8 WebSocket queue size: ${e} - forcing flush for performance`),ne(),e>10&&D.forceGC())},1e3);return()=>clearInterval(e)},[te,ne,D]),(0,r.useEffect)(()=>{const e=()=>{ne()};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[ne]),(0,c.jsxs)("div",{className:"terminal",children:[(0,c.jsxs)("div",{className:"terminal-header",children:[(0,c.jsx)("div",{className:"terminal-header-left",children:(0,c.jsx)(l,{onVoiceCommand:de,disabled:!1})}),(0,c.jsxs)("div",{className:"terminal-header-center",children:[(0,c.jsx)(u,{value:n||"normal",onChange:d,compact:!0}),M&&(0,c.jsxs)("div",{className:"thinking-indicator",style:{display:"inline-flex",alignItems:"center",marginLeft:"12px",padding:"4px 8px",backgroundColor:"rgba(251, 191, 36, 0.1)",borderRadius:"4px",border:"1px solid rgba(251, 191, 36, 0.3)",animation:"pulse 2s infinite"},children:[(0,c.jsx)("span",{style:{marginRight:"6px",animation:"spin 1s linear infinite",display:"inline-block"},children:"\ud83e\udde0"}),(0,c.jsx)("span",{style:{fontSize:"12px",color:"#fbbf24",fontWeight:"500"},children:"Thinking..."})]})]}),(0,c.jsxs)("div",{className:"terminal-header-right",children:[(0,c.jsx)("button",{className:"terminal-control-btn "+(w||x||k||E?"active":""),onClick:he,disabled:T||!w&&!x&&!k&&!E,onMouseEnter:e=>!T&&re("emergency-stop",e),onMouseLeave:se,style:{zIndex:9999,position:"relative",pointerEvents:"auto",backgroundColor:w||x||k||E?"#ef4444":void 0},children:T?"Stopping...":"\ud83d\uded1 Stop"}),(0,c.jsx)("button",{className:"terminal-control-btn "+(w?"active":""),onClick:()=>{console.log("\ud83d\udfe2 [BUTTON] Supervision button CLICKED!"),me()},onMouseEnter:e=>re("supervision",e),onMouseLeave:se,style:{zIndex:9999,position:"relative",pointerEvents:"auto"},children:w?"Stop Supervision":"Supervision"}),(0,c.jsx)("button",{className:"terminal-control-btn "+(x?"active":""),onClick:ue,onMouseEnter:e=>re("parallel-agents",e),onMouseLeave:se,style:{zIndex:9999,position:"relative",pointerEvents:"auto"},children:x?"Stop Agents":"Parallel Agents"}),(0,c.jsx)("button",{className:"terminal-control-btn "+(k?"active":""),onClick:pe,disabled:A,onMouseEnter:e=>re("infinite-loop",e),onMouseLeave:se,style:{zIndex:9999,position:"relative",pointerEvents:"auto"},children:A?"Stopping...":k?"Stop Loop":"Infinite Loop"}),(0,c.jsx)("button",{className:"terminal-control-btn "+(E?"active":""),onClick:ge,onMouseEnter:e=>re("hivemind",e),onMouseLeave:se,style:{zIndex:9999,position:"relative",pointerEvents:"auto"},children:E?"Stop Hivemind":"Hivemind"})]})]}),(0,c.jsx)("div",{className:"terminal-container",ref:J}),(0,c.jsx)(p,{socket:X.current,terminalId:Z.current,onApplyFix:e=>{console.log("\ud83d\udd27 Terminal: Error Doctor applied fix:",e)}}),G&&(console.log("\ud83c\udfaf Rendering tooltip for:",G,"Message:",ie(G)),(0,c.jsxs)("div",{style:{position:"fixed",left:B.x,top:B.y,transform:"translateX(-50%)",backgroundColor:"rgba(0, 0, 0, 0.9)",color:"white",padding:"8px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"normal",whiteSpace:"nowrap",zIndex:99999,pointerEvents:"none",opacity:1},children:[ie(G),(0,c.jsx)("div",{style:{position:"absolute",top:"-6px",left:"50%",transform:"translateX(-50%)",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid rgba(0, 0, 0, 0.9)",width:0,height:0}})]}))]})}}}]);
//# sourceMappingURL=526.55f4fadd.chunk.js.map